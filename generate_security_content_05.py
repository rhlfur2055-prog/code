#!/usr/bin/env python3
"""
Generate security content for 05_ë³´ì•ˆì„¤ì • topics in security.json
Topics: cors-security, header-security, secure-cookie
"""

import json
import os

def get_cors_security_content():
    """CORS ì •ì±… ì´í•´ content"""
    return {
        "id": "05_ë³´ì•ˆì„¤ì •/cors-security",
        "title": "CORS ì •ì±… ì™„ë²½ ê°€ì´ë“œ",
        "category": "security",
        "subCategory": "05_ë³´ì•ˆì„¤ì •",
        "language": "Java",
        "description": "CORS(Cross-Origin Resource Sharing) ì •ì±…ì˜ ì›ë¦¬ì™€ Spring Boot, Nginx ì„¤ì • ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "ğŸŒ CORS ì •ì±… ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **CORS** = ë‹¤ë¥¸ ì¶œì²˜(Origin)ì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì•ˆì „í•˜ê²Œ í—ˆìš©í•˜ëŠ” ë¸Œë¼ìš°ì € ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ¢ ì•„íŒŒíŠ¸ ë³´ì•ˆì— ë¹„ìœ í•˜ë©´:\n\në¸Œë¼ìš°ì € = ì•„íŒŒíŠ¸ ê²½ë¹„ì‹¤\nì„œë²„ = ê° ì„¸ëŒ€\nCORS = ë°©ë¬¸ì í—ˆìš© ëª…ë‹¨\n\n[ì‹œë‚˜ë¦¬ì˜¤]\n1. íƒë°°ê¸°ì‚¬(ë‹¤ë¥¸ Origin)ê°€ 101í˜¸(ì„œë²„) ë°©ë¬¸ ìš”ì²­\n2. ê²½ë¹„ì‹¤(ë¸Œë¼ìš°ì €)ì´ 101í˜¸ì— í™•ì¸ ì „í™”\n3. 101í˜¸: \"ê·¸ íƒë°°íšŒì‚¬ëŠ” í—ˆìš© ëª…ë‹¨ì— ìˆì–´ìš”\" (CORS í—¤ë”)\n4. ê²½ë¹„ì‹¤: ì¶œì… í—ˆê°€!\n\ní—ˆìš© ëª…ë‹¨ ì—†ìœ¼ë©´? â†’ \"ì¶œì… ê±°ë¶€\" (CORS ì—ëŸ¬)\n```\n\n---\n\n## ğŸš¨ ì™œ í•„ìš”í•œê°€? - CSRF ê³µê²© ë°©ì§€\n\n```\n[CORS ì—†ëŠ” ì„¸ìƒ]\n1. ì‚¬ìš©ìê°€ ì€í–‰ ì‚¬ì´íŠ¸ ë¡œê·¸ì¸ (ì¿ í‚¤ ì €ì¥)\n2. í•´ì»¤ ì‚¬ì´íŠ¸ ë°©ë¬¸\n3. í•´ì»¤ ì‚¬ì´íŠ¸ JSê°€ ì€í–‰ API í˜¸ì¶œ\n4. ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ ìë™ ì²¨ë¶€\n5. í•´ì»¤ê°€ ì†¡ê¸ˆ ìš”ì²­ ì„±ê³µ! ğŸ’€\n\n[CORS ìˆëŠ” ì„¸ìƒ]\n1~3 ë™ì¼\n4. ë¸Œë¼ìš°ì €: \"ì€í–‰ ì„œë²„ì•¼, í•´ì»¤ì‚¬ì´íŠ¸ í—ˆìš©í•´?\"\n5. ì€í–‰: \"ì•„ë‹ˆ\" (CORS í—¤ë” ì—†ìŒ)\n6. ë¸Œë¼ìš°ì €: ìš”ì²­ ì°¨ë‹¨! âœ…\n```\n\n---\n\n## ğŸ“Œ ì‹¤ì œ ì‚¬ê³  ì‚¬ë¡€\n\n```\nğŸ“Œ 2019ë…„ ëŒ€í˜• í•€í…Œí¬ CORS ì„¤ì • ì˜¤ë¥˜\nì›ì¸: Access-Control-Allow-Origin: * ì„¤ì •\ní”¼í•´: ëª¨ë“  ì‚¬ì´íŠ¸ì—ì„œ API í˜¸ì¶œ ê°€ëŠ¥\nê²°ê³¼: ì‚¬ìš©ì ê¸ˆìœµì •ë³´ ë…¸ì¶œ ìœ„í—˜\n\nğŸ“Œ 2021ë…„ SaaS ì„œë¹„ìŠ¤ ì·¨ì•½ì \nì›ì¸: ì™€ì¼ë“œì¹´ë“œ + credentials: true ë™ì‹œ ì„¤ì •\ní”¼í•´: ì„¸ì…˜ íƒˆì·¨ ê°€ëŠ¥í•œ ì·¨ì•½ì  ë°œìƒ\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ì„¤ì • ì½”ë“œ",
                "content": "### Spring Boot 3.x CORS ì„¤ì •\n\n```java\n@Configuration\npublic class CorsConfig {\n\n    @Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n        CorsConfiguration config = new CorsConfiguration();\n        \n        // í—ˆìš©í•  Origin (í”„ë¡ íŠ¸ì—”ë“œ ì£¼ì†Œ)\n        config.setAllowedOrigins(Arrays.asList(\n            \"https://myapp.com\",\n            \"https://admin.myapp.com\"\n        ));\n        \n        // í—ˆìš©í•  HTTP ë©”ì„œë“œ\n        config.setAllowedMethods(Arrays.asList(\n            \"GET\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\"\n        ));\n        \n        // í—ˆìš©í•  í—¤ë”\n        config.setAllowedHeaders(Arrays.asList(\n            \"Authorization\", \"Content-Type\", \"X-Requested-With\"\n        ));\n        \n        // ì¿ í‚¤/ì¸ì¦ì •ë³´ í—ˆìš© (credentials)\n        config.setAllowCredentials(true);\n        \n        // Preflight ìºì‹œ ì‹œê°„ (1ì‹œê°„)\n        config.setMaxAge(3600L);\n        \n        UrlBasedCorsConfigurationSource source = \n            new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", config);\n        \n        return source;\n    }\n}\n```\n\n### SecurityFilterChainì— CORS ì ìš©\n\n```java\n@Bean\npublic SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n    http\n        .cors(cors -> cors.configurationSource(corsConfigurationSource()))\n        .csrf(csrf -> csrf.disable())  // JWT ì‚¬ìš© ì‹œ\n        // ... ê¸°íƒ€ ì„¤ì •\n    return http.build();\n}\n```\n\n### Nginx CORS ì„¤ì •\n\n```nginx\nserver {\n    location /api/ {\n        # Preflight ìš”ì²­ ì²˜ë¦¬\n        if ($request_method = 'OPTIONS') {\n            add_header 'Access-Control-Allow-Origin' 'https://myapp.com';\n            add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE';\n            add_header 'Access-Control-Allow-Headers' 'Authorization, Content-Type';\n            add_header 'Access-Control-Max-Age' 3600;\n            return 204;\n        }\n        \n        # ì‹¤ì œ ìš”ì²­\n        add_header 'Access-Control-Allow-Origin' 'https://myapp.com' always;\n        add_header 'Access-Control-Allow-Credentials' 'true' always;\n        \n        proxy_pass http://backend;\n    }\n}\n```\n\n### ì£¼ìš” CORS í—¤ë” ì„¤ëª…\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ í—¤ë”                            â”‚ ì„¤ëª…                     â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Access-Control-Allow-Origin     â”‚ í—ˆìš©í•  Origin            â”‚\nâ”‚ Access-Control-Allow-Methods    â”‚ í—ˆìš©í•  HTTP ë©”ì„œë“œ       â”‚\nâ”‚ Access-Control-Allow-Headers    â”‚ í—ˆìš©í•  ìš”ì²­ í—¤ë”         â”‚\nâ”‚ Access-Control-Allow-Credentialsâ”‚ ì¿ í‚¤/ì¸ì¦ í—ˆìš© ì—¬ë¶€      â”‚\nâ”‚ Access-Control-Max-Age          â”‚ Preflight ìºì‹œ ì‹œê°„      â”‚\nâ”‚ Access-Control-Expose-Headers   â”‚ JSì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í—¤ë” â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ì‹¤ì „ ì ìš©",
                "content": "### í”„ë¡ íŠ¸ì—”ë“œ ëŒ€ì‘ (React/Axios)\n\n```javascript\n// axios ì„¤ì • - credentials í¬í•¨\nconst api = axios.create({\n    baseURL: 'https://api.myapp.com',\n    withCredentials: true,  // ì¿ í‚¤ ì „ì†¡ í—ˆìš©\n    headers: {\n        'Content-Type': 'application/json'\n    }\n});\n\n// Preflight ë°œìƒí•˜ëŠ” ìš”ì²­\napi.post('/data', payload, {\n    headers: {\n        'Authorization': `Bearer ${token}`,\n        'X-Custom-Header': 'value'  // Custom í—¤ë” â†’ Preflight ë°œìƒ\n    }\n});\n```\n\n### ê°œë°œ/ìš´ì˜ í™˜ê²½ ë¶„ë¦¬ ì„¤ì •\n\n```java\n@Configuration\npublic class CorsConfig {\n\n    @Value(\"${app.cors.allowed-origins}\")\n    private String[] allowedOrigins;\n\n    @Bean\n    @Profile(\"local\")\n    public CorsConfigurationSource localCorsConfig() {\n        CorsConfiguration config = new CorsConfiguration();\n        config.setAllowedOrigins(Arrays.asList(\n            \"http://localhost:3000\",\n            \"http://localhost:5173\"  // Vite\n        ));\n        config.setAllowedMethods(Arrays.asList(\"*\"));\n        config.setAllowedHeaders(Arrays.asList(\"*\"));\n        config.setAllowCredentials(true);\n        \n        UrlBasedCorsConfigurationSource source = \n            new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", config);\n        return source;\n    }\n\n    @Bean\n    @Profile(\"prod\")\n    public CorsConfigurationSource prodCorsConfig() {\n        CorsConfiguration config = new CorsConfiguration();\n        // ìš´ì˜: íŠ¹ì • ë„ë©”ì¸ë§Œ í—ˆìš©\n        config.setAllowedOrigins(Arrays.asList(allowedOrigins));\n        config.setAllowedMethods(Arrays.asList(\n            \"GET\", \"POST\", \"PUT\", \"DELETE\"\n        ));\n        config.setAllowedHeaders(Arrays.asList(\n            \"Authorization\", \"Content-Type\"\n        ));\n        config.setAllowCredentials(true);\n        config.setMaxAge(3600L);\n        \n        UrlBasedCorsConfigurationSource source = \n            new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", config);\n        return source;\n    }\n}\n```\n\n### application.yml í™˜ê²½ë³„ ì„¤ì •\n\n```yaml\n# application-local.yml\napp:\n  cors:\n    allowed-origins: http://localhost:3000,http://localhost:5173\n\n# application-prod.yml\napp:\n  cors:\n    allowed-origins: https://myapp.com,https://admin.myapp.com\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ CORS ì„¤ì • ]\nâ–¡ ìš´ì˜ í™˜ê²½ì—ì„œ ì™€ì¼ë“œì¹´ë“œ(*) ì‚¬ìš© ê¸ˆì§€\nâ–¡ allowCredentials=trueë©´ Origin ëª…ì‹œ í•„ìˆ˜\nâ–¡ ë¶ˆí•„ìš”í•œ HTTP ë©”ì„œë“œ í—ˆìš© ì œê±°\nâ–¡ Preflight ìºì‹œ(Max-Age) ì„¤ì •\nâ–¡ í™˜ê²½ë³„(dev/prod) ì„¤ì • ë¶„ë¦¬\nâ–¡ ë¯¼ê°í•œ APIëŠ” ì¶”ê°€ ì¸ì¦ ì ìš©\n\n[ í”í•œ ì‹¤ìˆ˜ ]\nâœ— Access-Control-Allow-Origin: * + credentials\n  â†’ ë¸Œë¼ìš°ì €ê°€ ê±°ë¶€í•¨\nâœ— OPTIONS ë©”ì„œë“œ ëˆ„ë½\n  â†’ Preflight ì‹¤íŒ¨\nâœ— Content-Type í—¤ë” ëˆ„ë½\n  â†’ POST ìš”ì²­ ì‹¤íŒ¨\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´:\nQ: CORSê°€ ë¬´ì—‡ì¸ê°€ìš”?\nA: ë¸Œë¼ìš°ì €ì˜ Same-Origin Policyë¥¼ ìš°íšŒí•˜ì—¬ ë‹¤ë¥¸ ì¶œì²˜ì˜\n   ë¦¬ì†ŒìŠ¤ì— ì•ˆì „í•˜ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.\n\nQ: Preflight ìš”ì²­ì´ë€?\nA: ì‹¤ì œ ìš”ì²­ ì „ OPTIONS ë©”ì„œë“œë¡œ ì„œë²„ê°€ í•´ë‹¹ ìš”ì²­ì„\n   í—ˆìš©í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ì‚¬ì „ ìš”ì²­ì…ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´:\nQ: CORSì™€ CSRFì˜ ê´€ê³„ëŠ”?\nA: CORSëŠ” CSRFë¥¼ ì™„ì „íˆ ë°©ì§€í•˜ì§€ ëª»í•©ë‹ˆë‹¤.\n   Simple RequestëŠ” Preflight ì—†ì´ ì „ì†¡ë˜ë¯€ë¡œ,\n   CSRF í† í°ì´ë‚˜ SameSite ì¿ í‚¤ê°€ ì¶”ê°€ë¡œ í•„ìš”í•©ë‹ˆë‹¤.\n\nQ: credentials ëª¨ë“œì—ì„œ ì™€ì¼ë“œì¹´ë“œê°€ ì•ˆ ë˜ëŠ” ì´ìœ ?\nA: ë³´ì•ˆìƒ ë¯¼ê°í•œ ìš”ì²­(ì¿ í‚¤ í¬í•¨)ì„ ëª¨ë“  Originì—\n   í—ˆìš©í•˜ë©´ CSRF ê³µê²©ì— ì·¨ì•½í•´ì§€ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.\n```"
            }
        ]
    }


def get_header_security_content():
    """Security Headers ì„¤ì • content"""
    return {
        "id": "05_ë³´ì•ˆì„¤ì •/header-security",
        "title": "Security Headers ì™„ë²½ ê°€ì´ë“œ",
        "category": "security",
        "subCategory": "05_ë³´ì•ˆì„¤ì •",
        "language": "Java",
        "description": "ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ í—¤ë”(CSP, X-Frame-Options, HSTS ë“±)ì˜ ì›ë¦¬ì™€ ì„¤ì • ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "ğŸŒ Security Headers ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **Security Headers** = HTTP ì‘ë‹µì— í¬í•¨ë˜ì–´ ë¸Œë¼ìš°ì €ì˜ ë³´ì•ˆ ë™ì‘ì„ ì œì–´í•˜ëŠ” í—¤ë”ë“¤!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ  ì§‘ ë³´ì•ˆ ì‹œìŠ¤í…œì— ë¹„ìœ í•˜ë©´:\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚        Security Headers = ë³´ì•ˆ ê·œì¹™      â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ CSP          = \"í—ˆê°€ëœ ì‚¬ëŒë§Œ ë“¤ì–´ì™€\"     â”‚\nâ”‚ X-Frame      = \"ì°½ë¬¸ìœ¼ë¡œ ì—¿ë³´ê¸° ê¸ˆì§€\"     â”‚\nâ”‚ HSTS         = \"ë¬´ì¡°ê±´ ë³´ì•ˆë¬¸(HTTPS)ë§Œ\"  â”‚\nâ”‚ X-Content    = \"ë°°ë‹¬ë¬¼ ê²€ì‚¬ í•„ìˆ˜\"        â”‚\nâ”‚ Referrer     = \"ë°©ë¬¸ ê¸°ë¡ ë¹„ê³µê°œ\"        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\në¸Œë¼ìš°ì €ì—ê²Œ \"ì´ ê·œì¹™ëŒ€ë¡œ í–‰ë™í•´!\" ë¼ê³  ì§€ì‹œ\n```\n\n---\n\n## ğŸš¨ ì™œ í•„ìš”í•œê°€? - ê³µê²© ì°¨ë‹¨\n\n```\n[Security Headers ì—†ìœ¼ë©´]\n\n1. XSS ê³µê²©: ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰\n2. Clickjacking: iframeìœ¼ë¡œ ì‚¬ì´íŠ¸ ë®ì–´ì”Œìš°ê¸°\n3. MITM: HTTPë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œ í›„ ë„ì²­\n4. MIME Sniffing: íŒŒì¼ íƒ€ì… ì†ì—¬ì„œ ì‹¤í–‰\n\n[Security Headers ìˆìœ¼ë©´]\n\n1. CSP: \"í—ˆìš©ëœ ì†ŒìŠ¤ ì™¸ ìŠ¤í¬ë¦½íŠ¸ ì°¨ë‹¨!\"\n2. X-Frame-Options: \"iframe ì‚½ì… ë¶ˆê°€!\"\n3. HSTS: \"ë¬´ì¡°ê±´ HTTPSë§Œ ì‚¬ìš©!\"\n4. X-Content-Type-Options: \"íƒ€ì… ë³€ê²½ ê¸ˆì§€!\"\n```\n\n---\n\n## ğŸ“Œ ì‹¤ì œ ì‚¬ê³  ì‚¬ë¡€\n\n```\nğŸ“Œ 2018ë…„ British Airways í•´í‚¹\nì›ì¸: CSP ë¯¸ì„¤ì • â†’ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…\ní”¼í•´: 38ë§Œ ëª… ì¹´ë“œì •ë³´ ìœ ì¶œ, $230M ë²Œê¸ˆ\n\nğŸ“Œ 2020ë…„ Twitter Clickjacking\nì›ì¸: X-Frame-Options ë¯¸ì„¤ì •\ní”¼í•´: ì‚¬ìš©ì ëª¨ë¥´ê²Œ íŠ¸ìœ—/íŒ”ë¡œìš° ìœ ë„\n\nğŸ“Œ 2021ë…„ ê¸ˆìœµì•± MITM ê³µê²©\nì›ì¸: HSTS ë¯¸ì„¤ì • â†’ HTTP ë‹¤ìš´ê·¸ë ˆì´ë“œ\ní”¼í•´: ë¡œê·¸ì¸ ì •ë³´ íƒˆì·¨\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ì„¤ì • ì½”ë“œ",
                "content": "### Spring Boot 3.x Security Headers ì„¤ì •\n\n```java\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .headers(headers -> headers\n                // Content-Security-Policy\n                .contentSecurityPolicy(csp -> csp\n                    .policyDirectives(\n                        \"default-src 'self'; \" +\n                        \"script-src 'self' https://cdn.trusted.com; \" +\n                        \"style-src 'self' 'unsafe-inline'; \" +\n                        \"img-src 'self' data: https:; \" +\n                        \"font-src 'self' https://fonts.googleapis.com; \" +\n                        \"connect-src 'self' https://api.myapp.com; \" +\n                        \"frame-ancestors 'none'; \" +\n                        \"form-action 'self'\"\n                    )\n                )\n                // X-Frame-Options\n                .frameOptions(frame -> frame.deny())\n                // X-Content-Type-Options\n                .contentTypeOptions(content -> {})\n                // Referrer-Policy\n                .referrerPolicy(referrer -> referrer\n                    .policy(ReferrerPolicyHeaderWriter.ReferrerPolicy.STRICT_ORIGIN_WHEN_CROSS_ORIGIN)\n                )\n                // Permissions-Policy\n                .permissionsPolicy(permissions -> permissions\n                    .policy(\"geolocation=(), camera=(), microphone=()\")\n                )\n            )\n            // HSTS (HTTPS ê°•ì œ)\n            .requiresChannel(channel -> channel\n                .anyRequest().requiresSecure()\n            );\n\n        return http.build();\n    }\n}\n```\n\n### Nginx Security Headers ì„¤ì •\n\n```nginx\nserver {\n    listen 443 ssl http2;\n    \n    # HSTS (1ë…„, ì„œë¸Œë„ë©”ì¸ í¬í•¨)\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;\n    \n    # X-Frame-Options\n    add_header X-Frame-Options \"DENY\" always;\n    \n    # X-Content-Type-Options\n    add_header X-Content-Type-Options \"nosniff\" always;\n    \n    # X-XSS-Protection (ë ˆê±°ì‹œ, CSPë¡œ ëŒ€ì²´ ê¶Œì¥)\n    add_header X-XSS-Protection \"1; mode=block\" always;\n    \n    # Content-Security-Policy\n    add_header Content-Security-Policy \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; frame-ancestors 'none';\" always;\n    \n    # Referrer-Policy\n    add_header Referrer-Policy \"strict-origin-when-cross-origin\" always;\n    \n    # Permissions-Policy\n    add_header Permissions-Policy \"geolocation=(), camera=(), microphone=()\" always;\n}\n```\n\n### ì£¼ìš” Security Headers ì„¤ëª…\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ í—¤ë”                  â”‚ ì—­í•                             â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ CSP                  â”‚ ë¦¬ì†ŒìŠ¤ ë¡œë“œ ì¶œì²˜ ì œí•œ (XSS ë°©ì§€)â”‚\nâ”‚ X-Frame-Options      â”‚ iframe ì‚½ì… ë°©ì§€ (Clickjacking)â”‚\nâ”‚ HSTS                 â”‚ HTTPS ê°•ì œ (MITM ë°©ì§€)          â”‚\nâ”‚ X-Content-Type       â”‚ MIME ìŠ¤ë‹ˆí•‘ ë°©ì§€                â”‚\nâ”‚ Referrer-Policy      â”‚ Referer í—¤ë” ì •ë³´ ì œí•œ          â”‚\nâ”‚ Permissions-Policy   â”‚ ë¸Œë¼ìš°ì € ê¸°ëŠ¥(ì¹´ë©”ë¼ ë“±) ì œí•œ   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ì‹¤ì „ ì ìš©",
                "content": "### í”„ë¡ íŠ¸ì—”ë“œ CSP ëŒ€ì‘ (React)\n\n```javascript\n// CSP nonce ì‚¬ìš© ì‹œ (ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ í—ˆìš©)\n// ì„œë²„ì—ì„œ nonce ê°’ì„ ìƒì„±í•˜ì—¬ ì „ë‹¬\n\n// Next.js _document.js ì˜ˆì‹œ\nimport { Html, Head, Main, NextScript } from 'next/document';\n\nexport default function Document({ nonce }) {\n    return (\n        <Html>\n            <Head nonce={nonce}>\n                <meta\n                    httpEquiv=\"Content-Security-Policy\"\n                    content={`script-src 'self' 'nonce-${nonce}'`}\n                />\n            </Head>\n            <body>\n                <Main />\n                <NextScript nonce={nonce} />\n            </body>\n        </Html>\n    );\n}\n```\n\n### ê°œë°œ/ìš´ì˜ í™˜ê²½ ë¶„ë¦¬\n\n```java\n@Configuration\npublic class SecurityHeadersConfig {\n\n    @Bean\n    @Profile(\"local\")\n    public SecurityFilterChain localFilterChain(HttpSecurity http) throws Exception {\n        http.headers(headers -> headers\n            // ê°œë°œ í™˜ê²½: ëŠìŠ¨í•œ CSP (í•« ë¦¬ë¡œë“œ í—ˆìš©)\n            .contentSecurityPolicy(csp -> csp\n                .policyDirectives(\n                    \"default-src 'self' 'unsafe-inline' 'unsafe-eval'; \" +\n                    \"connect-src 'self' ws://localhost:*\"\n                )\n            )\n            .frameOptions(frame -> frame.sameOrigin())  // ê°œë°œë„êµ¬ í—ˆìš©\n        );\n        return http.build();\n    }\n\n    @Bean\n    @Profile(\"prod\")\n    public SecurityFilterChain prodFilterChain(HttpSecurity http) throws Exception {\n        http.headers(headers -> headers\n            // ìš´ì˜ í™˜ê²½: ì—„ê²©í•œ CSP\n            .contentSecurityPolicy(csp -> csp\n                .policyDirectives(\n                    \"default-src 'self'; \" +\n                    \"script-src 'self'; \" +\n                    \"style-src 'self'; \" +\n                    \"frame-ancestors 'none'; \" +\n                    \"upgrade-insecure-requests\"\n                )\n            )\n            .frameOptions(frame -> frame.deny())\n        );\n        return http.build();\n    }\n}\n```\n\n### CSP Report ìˆ˜ì§‘ ì„¤ì •\n\n```java\n// CSP ìœ„ë°˜ ë¦¬í¬íŠ¸ ì—”ë“œí¬ì¸íŠ¸\n@RestController\npublic class CspReportController {\n\n    @PostMapping(\"/csp-report\")\n    public ResponseEntity<Void> handleCspReport(\n            @RequestBody String report) {\n        log.warn(\"[CSP Violation] {}\", report);\n        // ì•Œë¦¼ ì „ì†¡ ë˜ëŠ” DB ì €ì¥\n        return ResponseEntity.ok().build();\n    }\n}\n\n// CSPì— report-uri ì¶”ê°€\n// \"report-uri /csp-report; report-to csp-endpoint\"\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ í•„ìˆ˜ í—¤ë” ]\nâ–¡ Content-Security-Policy ì„¤ì •\nâ–¡ X-Frame-Options: DENY\nâ–¡ X-Content-Type-Options: nosniff\nâ–¡ Strict-Transport-Security (HTTPS)\nâ–¡ Referrer-Policy ì„¤ì •\n\n[ CSP ì„¸ë¶€ ì ê²€ ]\nâ–¡ 'unsafe-inline' ì œê±° (nonce ì‚¬ìš©)\nâ–¡ 'unsafe-eval' ì œê±°\nâ–¡ ì™€ì¼ë“œì¹´ë“œ(*) ìµœì†Œí™”\nâ–¡ frame-ancestors ì„¤ì •\nâ–¡ report-urië¡œ ìœ„ë°˜ ëª¨ë‹ˆí„°ë§\n\n[ í…ŒìŠ¤íŠ¸ ]\nâ–¡ securityheaders.com ì—ì„œ ë“±ê¸‰ í™•ì¸\nâ–¡ Mozilla Observatory ì ê²€\nâ–¡ ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ Console í™•ì¸\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´:\nQ: CSPê°€ ë¬´ì—‡ì¸ê°€ìš”?\nA: Content-Security-Policyì˜ ì•½ìë¡œ, ì›¹í˜ì´ì§€ì—ì„œ\n   ë¡œë“œí•  ìˆ˜ ìˆëŠ” ë¦¬ì†ŒìŠ¤ì˜ ì¶œì²˜ë¥¼ ì œí•œí•˜ì—¬\n   XSS ê³µê²©ì„ ë°©ì§€í•˜ëŠ” ë³´ì•ˆ í—¤ë”ì…ë‹ˆë‹¤.\n\nQ: X-Frame-Optionsì˜ ì—­í• ì€?\nA: ì›¹í˜ì´ì§€ê°€ iframeì— ì‚½ì…ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ì—¬\n   Clickjacking ê³µê²©ì„ ì°¨ë‹¨í•©ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´:\nQ: CSPì—ì„œ 'unsafe-inline'ì„ í”¼í•˜ëŠ” ë°©ë²•ì€?\nA: nonce ë˜ëŠ” hash ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\n   ì„œë²„ì—ì„œ ë§¤ ìš”ì²­ë§ˆë‹¤ ëœë¤ nonceë¥¼ ìƒì„±í•˜ê³ ,\n   CSP í—¤ë”ì™€ script íƒœê·¸ì— ë™ì¼í•œ ê°’ì„ ì ìš©í•©ë‹ˆë‹¤.\n\nQ: HSTS preloadì˜ ì¥ë‹¨ì ì€?\nA: ì¥ì : ì²« ìš”ì²­ë¶€í„° HTTPS ê°•ì œë¡œ MITM ë°©ì§€\n   ë‹¨ì : ë“±ë¡ í›„ ì œê±° ì–´ë ¤ì›€, ì„œë¸Œë„ë©”ì¸ ì „ì²´ ì ìš©\n   ì‹ ì¤‘í•˜ê²Œ ì ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n```"
            }
        ]
    }


def get_secure_cookie_content():
    """ì¿ í‚¤ ë³´ì•ˆ content"""
    return {
        "id": "05_ë³´ì•ˆì„¤ì •/secure-cookie",
        "title": "ì¿ í‚¤ ë³´ì•ˆ ì™„ë²½ ê°€ì´ë“œ (HttpOnly, Secure, SameSite)",
        "category": "security",
        "subCategory": "05_ë³´ì•ˆì„¤ì •",
        "language": "Java",
        "description": "ì¿ í‚¤ ë³´ì•ˆ ì†ì„±(HttpOnly, Secure, SameSite)ì˜ ì›ë¦¬ì™€ Spring Boot ì„¤ì • ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "ğŸŒ ì¿ í‚¤ ë³´ì•ˆ ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **ì¿ í‚¤ ë³´ì•ˆ ì†ì„±** = HttpOnly(JSì ‘ê·¼ ì°¨ë‹¨), Secure(HTTPSë§Œ), SameSite(CSRF ë°©ì§€)!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ« ì…ì¥ê¶Œì— ë¹„ìœ í•˜ë©´:\n\nì¿ í‚¤ = ë†€ì´ê³µì› ì…ì¥ê¶Œ\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚         ì¿ í‚¤ ë³´ì•ˆ = ì…ì¥ê¶Œ ë³´ì•ˆ          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ HttpOnly = \"ì‚¬ì§„ ë³µì‚¬ ê¸ˆì§€\"             â”‚\nâ”‚   â†’ ë‹¤ë¥¸ ì‚¬ëŒ(JS)ì´ ì…ì¥ê¶Œ ë³µì‚¬ ë¶ˆê°€    â”‚\nâ”‚                                         â”‚\nâ”‚ Secure = \"ì •ë¬¸(HTTPS)ìœ¼ë¡œë§Œ ì…ì¥\"       â”‚\nâ”‚   â†’ ë’·ë¬¸(HTTP)ìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´ ì…ì¥ê¶Œ ë¬´íš¨ â”‚\nâ”‚                                         â”‚\nâ”‚ SameSite = \"ë³¸ì¸ í™•ì¸ í•„ìˆ˜\"             â”‚\nâ”‚   â†’ ë‹¤ë¥¸ ê³³ì—ì„œ ì˜¨ ìš”ì²­ì€ ì…ì¥ê¶Œ ë¶ˆì¸ì • â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ğŸš¨ ì™œ í•„ìš”í•œê°€? - ê³µê²© ì‹œë‚˜ë¦¬ì˜¤\n\n```\n[HttpOnly ì—†ìœ¼ë©´ - XSSë¡œ ì„¸ì…˜ íƒˆì·¨]\n1. í•´ì»¤ê°€ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…\n2. document.cookieë¡œ ì„¸ì…˜ID íšë“\n3. í•´ì»¤ ì„œë²„ë¡œ ì „ì†¡\n4. í•´ì»¤ê°€ í”¼í•´ìë¡œ ë¡œê·¸ì¸!\n\n[Secure ì—†ìœ¼ë©´ - ë„¤íŠ¸ì›Œí¬ ë„ì²­]\n1. ê³µê³µ ì™€ì´íŒŒì´ì—ì„œ HTTP ì ‘ì†\n2. ì¿ í‚¤ê°€ í‰ë¬¸ìœ¼ë¡œ ì „ì†¡\n3. í•´ì»¤ê°€ íŒ¨í‚· ìº¡ì²˜\n4. ì„¸ì…˜ íƒˆì·¨!\n\n[SameSite ì—†ìœ¼ë©´ - CSRF ê³µê²©]\n1. í”¼í•´ìê°€ ì€í–‰ ë¡œê·¸ì¸ ìƒíƒœ\n2. í•´ì»¤ ì‚¬ì´íŠ¸ ë°©ë¬¸\n3. í•´ì»¤ ì‚¬ì´íŠ¸ê°€ ì€í–‰ ì†¡ê¸ˆ API í˜¸ì¶œ\n4. ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ ìë™ ì²¨ë¶€ â†’ ì†¡ê¸ˆ ì„±ê³µ!\n```\n\n---\n\n## ğŸ“Œ ì‹¤ì œ ì‚¬ê³  ì‚¬ë¡€\n\n```\nğŸ“Œ 2019ë…„ ëŒ€í˜• ì»¤ë¨¸ìŠ¤ XSS ê³µê²©\nì›ì¸: HttpOnly ë¯¸ì„¤ì • â†’ ì„¸ì…˜ì¿ í‚¤ íƒˆì·¨\ní”¼í•´: 10ë§Œ+ ê³„ì • ë„ìš©, ë¶€ì • ê²°ì œ\n\nğŸ“Œ 2020ë…„ ê¸ˆìœµì•± CSRF ê³µê²©\nì›ì¸: SameSite ë¯¸ì„¤ì •\ní”¼í•´: ì‚¬ìš©ì ëª¨ë¥´ê²Œ ì´ì²´ ë°œìƒ\n\nğŸ“Œ 2021ë…„ SaaS ì„œë¹„ìŠ¤ ì¿ í‚¤ ë„ì²­\nì›ì¸: Secure ë¯¸ì„¤ì • + HTTP í—ˆìš©\ní”¼í•´: ê¸°ì—… ê´€ë¦¬ì ê³„ì • íƒˆì·¨\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ì„¤ì • ì½”ë“œ",
                "content": "### Spring Boot 3.x ì¿ í‚¤ ë³´ì•ˆ ì„¤ì •\n\n```java\n@Configuration\npublic class CookieConfig {\n\n    @Bean\n    public CookieSerializer cookieSerializer() {\n        DefaultCookieSerializer serializer = new DefaultCookieSerializer();\n        \n        serializer.setCookieName(\"SESSIONID\");\n        serializer.setUseHttpOnlyCookie(true);   // HttpOnly\n        serializer.setUseSecureCookie(true);     // Secure\n        serializer.setSameSite(\"Strict\");        // SameSite\n        serializer.setCookiePath(\"/\");\n        serializer.setDomainName(\"myapp.com\");\n        serializer.setCookieMaxAge(3600);        // 1ì‹œê°„\n        \n        return serializer;\n    }\n}\n```\n\n### Spring Security ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •\n\n```java\n@Bean\npublic SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n    http\n        .sessionManagement(session -> session\n            .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)\n        )\n        .rememberMe(remember -> remember\n            .rememberMeCookieName(\"remember-me\")\n            .tokenValiditySeconds(86400)  // 1ì¼\n            .useSecureCookie(true)\n        );\n    return http.build();\n}\n```\n\n### ìˆ˜ë™ ì¿ í‚¤ ìƒì„± ì‹œ ë³´ì•ˆ ì„¤ì •\n\n```java\n@RestController\npublic class AuthController {\n\n    @PostMapping(\"/login\")\n    public ResponseEntity<?> login(HttpServletResponse response) {\n        // JWT í† í°ì„ ì¿ í‚¤ì— ì €ì¥\n        ResponseCookie cookie = ResponseCookie.from(\"accessToken\", jwtToken)\n            .httpOnly(true)      // JS ì ‘ê·¼ ì°¨ë‹¨\n            .secure(true)        // HTTPSë§Œ\n            .sameSite(\"Strict\")  // ë™ì¼ ì‚¬ì´íŠ¸ë§Œ\n            .path(\"/\")\n            .maxAge(Duration.ofHours(1))\n            .domain(\"myapp.com\")\n            .build();\n        \n        response.addHeader(HttpHeaders.SET_COOKIE, cookie.toString());\n        return ResponseEntity.ok(\"Login success\");\n    }\n}\n```\n\n### Nginx ì¿ í‚¤ ë³´ì•ˆ í—¤ë” ì¶”ê°€\n\n```nginx\nserver {\n    # í”„ë¡ì‹œ ì‘ë‹µì˜ Set-Cookie í—¤ë” ìˆ˜ì •\n    proxy_cookie_path / \"/; Secure; HttpOnly; SameSite=Strict\";\n    \n    # ë˜ëŠ” ì§ì ‘ í—¤ë” ì¶”ê°€\n    add_header Set-Cookie \"Path=/; Secure; HttpOnly; SameSite=Strict\";\n}\n```\n\n### ì¿ í‚¤ ì†ì„± ë¹„êµ\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ ì†ì„±          â”‚ íš¨ê³¼                                â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ HttpOnly     â”‚ JavaScriptì—ì„œ ì¿ í‚¤ ì ‘ê·¼ ë¶ˆê°€       â”‚\nâ”‚ Secure       â”‚ HTTPS ì—°ê²°ì—ì„œë§Œ ì¿ í‚¤ ì „ì†¡          â”‚\nâ”‚ SameSite=Lax â”‚ ì¼ë¶€ Cross-site ìš”ì²­ ì‹œ ì¿ í‚¤ ì œì™¸   â”‚\nâ”‚ SameSite=Strictâ”‚ ëª¨ë“  Cross-site ìš”ì²­ ì‹œ ì¿ í‚¤ ì œì™¸ â”‚\nâ”‚ SameSite=Noneâ”‚ Cross-site í—ˆìš© (Secure í•„ìˆ˜)       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ì‹¤ì „ ì ìš©",
                "content": "### í”„ë¡ íŠ¸ì—”ë“œ ì¿ í‚¤ ì²˜ë¦¬ (React)\n\n```javascript\n// HttpOnly ì¿ í‚¤ëŠ” JSì—ì„œ ì ‘ê·¼ ë¶ˆê°€\n// â†’ API í˜¸ì¶œ ì‹œ ìë™ìœ¼ë¡œ í¬í•¨ë¨\n\nconst api = axios.create({\n    baseURL: 'https://api.myapp.com',\n    withCredentials: true  // ì¿ í‚¤ í¬í•¨ í•„ìˆ˜!\n});\n\n// ë¡œê·¸ì¸ ìš”ì²­\nconst login = async (email, password) => {\n    const response = await api.post('/auth/login', { email, password });\n    // ì„œë²„ì—ì„œ Set-Cookie í—¤ë”ë¡œ ì¿ í‚¤ ì„¤ì •\n    // HttpOnlyë¼ì„œ JSì—ì„œ ì½ì„ ìˆ˜ ì—†ìŒ (ë³´ì•ˆìƒ ì •ìƒ)\n    return response.data;\n};\n\n// ì¸ì¦ í•„ìš”í•œ ìš”ì²­ - ì¿ í‚¤ ìë™ í¬í•¨\nconst getProfile = async () => {\n    const response = await api.get('/user/profile');\n    return response.data;\n};\n```\n\n### ê°œë°œ/ìš´ì˜ í™˜ê²½ ë¶„ë¦¬\n\n```java\n@Configuration\npublic class CookieConfig {\n\n    @Value(\"${app.cookie.secure}\")\n    private boolean secureCookie;\n\n    @Value(\"${app.cookie.same-site}\")\n    private String sameSite;\n\n    @Bean\n    public CookieSerializer cookieSerializer() {\n        DefaultCookieSerializer serializer = new DefaultCookieSerializer();\n        serializer.setUseHttpOnlyCookie(true);  // í•­ìƒ true\n        serializer.setUseSecureCookie(secureCookie);\n        serializer.setSameSite(sameSite);\n        return serializer;\n    }\n}\n```\n\n```yaml\n# application-local.yml\napp:\n  cookie:\n    secure: false       # localhostëŠ” HTTP í—ˆìš©\n    same-site: \"Lax\"    # ê°œë°œ í¸ì˜ì„±\n\n# application-prod.yml\napp:\n  cookie:\n    secure: true        # HTTPS í•„ìˆ˜\n    same-site: \"Strict\" # ì—„ê²©í•œ CSRF ë°©ì§€\n```\n\n### SameSite ìƒí™©ë³„ ì„ íƒ ê°€ì´ë“œ\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ SameSite ì„ íƒ ê°€ì´ë“œ                                â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Strict (ê¶Œì¥)                                       â”‚\nâ”‚ â””â”€ ê²°ì œ, ì†¡ê¸ˆ ë“± ë¯¼ê°í•œ ê¸°ëŠ¥                        â”‚\nâ”‚ â””â”€ ì™¸ë¶€ ë§í¬ í´ë¦­ ì‹œ ë¡œê·¸ì¸ í’€ë¦¼ (ë‹¨ì )             â”‚\nâ”‚                                                     â”‚\nâ”‚ Lax (ê¸°ë³¸ê°’)                                        â”‚\nâ”‚ â””â”€ ì¼ë°˜ì ì¸ ì›¹ì‚¬ì´íŠ¸                                â”‚\nâ”‚ â””â”€ GET ìš”ì²­ì€ Cross-site í—ˆìš©                       â”‚\nâ”‚ â””â”€ POST/PUT/DELETEëŠ” ì°¨ë‹¨                           â”‚\nâ”‚                                                     â”‚\nâ”‚ None + Secure (íŠ¹ìˆ˜ ëª©ì )                           â”‚\nâ”‚ â””â”€ ì œ3ì ì¿ í‚¤ (ê´‘ê³ , ì„ë² ë“œ)                        â”‚\nâ”‚ â””â”€ OAuth ì½œë°±                                       â”‚\nâ”‚ â””â”€ ë°˜ë“œì‹œ Secure ì†ì„± í•„ìˆ˜                          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ í•„ìˆ˜ ì„¤ì • ]\nâ–¡ ì„¸ì…˜ ì¿ í‚¤: HttpOnly=true\nâ–¡ ë¯¼ê°í•œ ì¿ í‚¤: Secure=true\nâ–¡ CSRF ë°©ì§€: SameSite=Strict ë˜ëŠ” Lax\nâ–¡ ì ì ˆí•œ ë§Œë£Œ ì‹œê°„ ì„¤ì •\nâ–¡ ë„ë©”ì¸/ê²½ë¡œ ìµœì†Œ ë²”ìœ„ë¡œ ì œí•œ\n\n[ ì ê²€ ì‚¬í•­ ]\nâ–¡ HTTPS ê°•ì œ ì ìš© í™•ì¸\nâ–¡ ê°œë°œì ë„êµ¬ Application > Cookies í™•ì¸\nâ–¡ Cross-site ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸\nâ–¡ ì¿ í‚¤ í¬ê¸° 4KB ì œí•œ í™•ì¸\n\n[ ì£¼ì˜ì‚¬í•­ ]\nâœ— ë¹„ë°€ë²ˆí˜¸, ì¹´ë“œë²ˆí˜¸ë¥¼ ì¿ í‚¤ì— ì €ì¥ ê¸ˆì§€\nâœ— ë¯¼ê° ì •ë³´ëŠ” ì•”í˜¸í™” í›„ ì €ì¥\nâœ— ì„¸ì…˜IDëŠ” ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ê°’ ì‚¬ìš©\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´:\nQ: HttpOnly ì¿ í‚¤ë€?\nA: JavaScriptì˜ document.cookieë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ”\n   ì¿ í‚¤ì…ë‹ˆë‹¤. XSS ê³µê²©ìœ¼ë¡œë¶€í„° ì„¸ì…˜IDë¥¼ ë³´í˜¸í•©ë‹ˆë‹¤.\n\nQ: SameSite ì†ì„±ì˜ ì—­í• ì€?\nA: ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì—ì„œ ë°œìƒí•œ ìš”ì²­ì— ì¿ í‚¤ë¥¼ í¬í•¨í• ì§€\n   ê²°ì •í•©ë‹ˆë‹¤. CSRF ê³µê²©ì„ ë°©ì§€í•˜ëŠ” ë° íš¨ê³¼ì ì…ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´:\nQ: SameSite=Laxì™€ Strictì˜ ì°¨ì´ì ì€?\nA: LaxëŠ” top-level navigationì˜ GET ìš”ì²­ ì‹œ\n   ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ì§€ë§Œ, StrictëŠ” ëª¨ë“  cross-site\n   ìš”ì²­ì—ì„œ ì¿ í‚¤ë¥¼ ì œì™¸í•©ë‹ˆë‹¤.\n   ë§í¬ í´ë¦­ ì‹œ ë¡œê·¸ì¸ ìœ ì§€ í•„ìš”í•˜ë©´ Lax ì„ íƒ.\n\nQ: JWTë¥¼ ì¿ í‚¤ vs localStorage ì–´ë””ì— ì €ì¥?\nA: ì¿ í‚¤(HttpOnly) ê¶Œì¥. localStorageëŠ” XSSì—\n   ì·¨ì•½í•˜ê³ , ì¿ í‚¤ëŠ” HttpOnlyë¡œ JS ì ‘ê·¼ì„ ì›ì²œ\n   ì°¨ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨, CSRF ë°©ì§€ë¥¼ ìœ„í•´\n   SameSite ì„¤ì •ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.\n```"
            }
        ]
    }


def main():
    """Main function to update security.json"""
    json_path = r"c:\tools\codemaster-next-main\codemaster-next-main\codemaster-next-main\src\data\contents\security.json"

    # Read existing JSON
    print(f"Reading {json_path}...")
    with open(json_path, 'r', encoding='utf-8') as f:
        data = json.load(f)

    # Update topics
    topics_to_update = {
        "05_ë³´ì•ˆì„¤ì •/cors-security": get_cors_security_content(),
        "05_ë³´ì•ˆì„¤ì •/header-security": get_header_security_content(),
        "05_ë³´ì•ˆì„¤ì •/secure-cookie": get_secure_cookie_content()
    }

    for topic_id, content in topics_to_update.items():
        if topic_id in data:
            print(f"Updating: {topic_id}")
            data[topic_id] = content
        else:
            print(f"Adding: {topic_id}")
            data[topic_id] = content

    # Write updated JSON
    print(f"Writing updated content to {json_path}...")
    with open(json_path, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print("\nUpdate complete!")
    print("Updated topics:")
    for topic_id in topics_to_update:
        print(f"  - {topic_id}")
        topic = data[topic_id]
        print(f"    Title: {topic['title']}")
        print(f"    Sections: {len(topic['sections'])}")


if __name__ == "__main__":
    main()
