#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Security Content Generator for Encryption Topics
Updates security.json with detailed content for 03_μ•”νΈν™” and 04_μ•”νΈν™” sections
"""

import json

def get_symmetric_content():
    """λ€μΉ­ν‚¤ μ•”νΈν™” (AES, DES) content"""
    return {
        "id": "03_μ•”νΈν™”/symmetric",
        "title": "λ€μΉ­ν‚¤ μ•”νΈν™” (AES, DES)",
        "category": "security",
        "subCategory": "03_μ•”νΈν™”",
        "language": "Java",
        "description": "λ€μΉ­ν‚¤ μ•”νΈν™”μ μ›λ¦¬μ™€ AES, DES μ•κ³ λ¦¬μ¦μ„ ν•™μµν•κ³  Spring Bootμ—μ„ μ•μ „ν•κ² κµ¬ν„ν•λ” λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "π” λ€μΉ­ν‚¤ μ•”νΈν™” - κ°™μ€ μ—΄μ‡ λ΅ μ κ·Έκ³  μ—¬λ” κΈκ³ ",
                "content": "**ν• μ¤„ μ”μ•½:** μ•”νΈν™”μ™€ λ³µνΈν™”μ— λ™μΌν• ν‚¤λ¥Ό μ‚¬μ©ν•λ” κ°€μ¥ λΉ λ¥Έ μ•”νΈν™” λ°©μ‹\n\n---\n\n**λΉ„μ : κ°™μ€ μ—΄μ‡ λ¥Ό κ³µμ ν•λ” κΈκ³ **\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚                    π” λ€μΉ­ν‚¤ μ•”νΈν™”                       β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚   [Alice]                              [Bob]            β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚  π”‘ κ°™μ€ μ—΄μ‡  (Secret Key)          β”‚             β”‚\nβ”‚      β”‚β—„β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚             β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚   π“„ ν‰λ¬Έ β”€β”€π”’β”€β”€β–Ί π” μ•”νΈλ¬Έ β”€β”€π”“β”€β”€β–Ί π“„ ν‰λ¬Έ   β”‚             β”‚\nβ”‚   \"μ•λ…•\"         \"x7Ks9...\"          \"μ•λ…•\"  β”‚             β”‚\nβ”‚                                                         β”‚\nβ”‚   λ¬Έμ : μ—΄μ‡ λ¥Ό μ–΄λ–»κ² μ•μ „ν•κ² μ „λ‹¬ν• κΉ? π¤”              β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**μ‹¤μ  μ‚¬μ© μ‚¬λ΅€:**\n\n| μ‚¬μ©μ² | μ•κ³ λ¦¬μ¦ | μ΄μ  |\n|--------|----------|------|\n| νμΌ μ•”νΈν™” | AES-256 | λΉ λ¥Έ μ†λ„, λ€μ©λ‰ μ²λ¦¬ |\n| DB μ»¬λΌ μ•”νΈν™” | AES-256-GCM | λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ¦ ν¬ν•¨ |\n| VPN ν†µμ‹  | AES-128/256 | μ‹¤μ‹κ°„ μ•”νΈν™” μ„±λ¥ |\n| λ””μ¤ν¬ μ•”νΈν™” | AES-XTS | λΈ”λ΅ λ‹¨μ„ λΉ λ¥Έ μ²λ¦¬ |\n| Wi-Fi (WPA2/3) | AES-CCMP | λ¬΄μ„  ν†µμ‹  λ³΄μ• |\n\n---\n\n**μ™ μ•μ•„μ•Ό ν•λ”κ°€?**\n\n1. **κ°μΈμ •λ³΄λ³΄νΈλ²• μ¤€μ** - μ£Όλ―Όλ²νΈ, μΉ΄λ“λ²νΈ λ“± μ•”νΈν™” μλ¬΄\n2. **HTTPS λ‚΄λ¶€ λ™μ‘** - TLSμ—μ„ μ‹¤μ  λ°μ΄ν„°λ” λ€μΉ­ν‚¤λ΅ μ•”νΈν™”\n3. **μ„±λ¥ μµμ ν™”** - λΉ„λ€μΉ­ν‚¤λ³΄λ‹¤ 1000λ°° λΉ λ¦„\n4. **λ©΄μ ‘ λ‹¨κ³¨ μ§λ¬Έ** - \"AESμ™€ RSAμ μ°¨μ΄μ μ€?\""
            },
            {
                "type": "code",
                "language": "java",
                "title": "π”„ λ€μΉ­ν‚¤ μ•”νΈν™” μ›λ¦¬μ™€ Java μ½”λ“",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// λ€μΉ­ν‚¤ μ•”νΈν™” λ™μ‘ μ›λ¦¬ λ‹¤μ΄μ–΄κ·Έλ¨\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n//\n// [ν‰λ¬Έ] β”€β”€β–Ί [μ•”νΈν™” μ•κ³ λ¦¬μ¦] β”€β”€β–Ί [μ•”νΈλ¬Έ]\n//                  β–²\n//                  β”‚\n//            [λΉ„λ°€ν‚¤ (Secret Key)]\n//                  β”‚\n//                  β–Ό\n// [μ•”νΈλ¬Έ] β”€β”€β–Ί [λ³µνΈν™” μ•κ³ λ¦¬μ¦] β”€β”€β–Ί [ν‰λ¬Έ]\n//\n// AES λΈ”λ΅ μ•”νΈν™”:\n// β”β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β”‚Block 1 β”‚Block 2 β”‚Block 3 β”‚Block 4 β”‚  β† 128λΉ„νΈ(16λ°”μ΄νΈ) λΈ”λ΅\n// β””β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”\n//      β†“        β†“        β†“        β†“\n//   [AES]    [AES]    [AES]    [AES]   β† κ° λΈ”λ΅ μ•”νΈν™”\n//      β†“        β†“        β†“        β†“\n// β”β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β”‚Cipher 1β”‚Cipher 2β”‚Cipher 3β”‚Cipher 4β”‚  β† μ•”νΈλ¬Έ λΈ”λ΅\n// β””β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport javax.crypto.Cipher;\nimport javax.crypto.KeyGenerator;\nimport javax.crypto.SecretKey;\nimport javax.crypto.spec.GCMParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.security.SecureRandom;\nimport java.util.Base64;\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… μ¬λ°”λ¥Έ μ‚¬μ©λ²•: AES-256-GCM (κ¶μ¥)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class AESEncryptionService {\n    \n    private static final String ALGORITHM = \"AES/GCM/NoPadding\";\n    private static final int GCM_IV_LENGTH = 12;  // 96 bits\n    private static final int GCM_TAG_LENGTH = 128; // bits\n    \n    // μ•”νΈν™”\n    public String encrypt(String plainText, SecretKey key) throws Exception {\n        // 1. IV(μ΄κΈ°ν™” λ²΅ν„°) μƒμ„± - λ§¤λ² μƒλ΅μ΄ λλ¤ κ°’\n        byte[] iv = new byte[GCM_IV_LENGTH];\n        SecureRandom random = new SecureRandom();\n        random.nextBytes(iv);\n        \n        // 2. Cipher μ΄κΈ°ν™”\n        Cipher cipher = Cipher.getInstance(ALGORITHM);\n        GCMParameterSpec parameterSpec = new GCMParameterSpec(GCM_TAG_LENGTH, iv);\n        cipher.init(Cipher.ENCRYPT_MODE, key, parameterSpec);\n        \n        // 3. μ•”νΈν™” μν–‰\n        byte[] cipherText = cipher.doFinal(plainText.getBytes(\"UTF-8\"));\n        \n        // 4. IV + μ•”νΈλ¬Έ κ²°ν•© (λ³µνΈν™” μ‹ IV ν•„μ”)\n        byte[] combined = new byte[iv.length + cipherText.length];\n        System.arraycopy(iv, 0, combined, 0, iv.length);\n        System.arraycopy(cipherText, 0, combined, iv.length, cipherText.length);\n        \n        return Base64.getEncoder().encodeToString(combined);\n    }\n    \n    // λ³µνΈν™”\n    public String decrypt(String encryptedText, SecretKey key) throws Exception {\n        byte[] combined = Base64.getDecoder().decode(encryptedText);\n        \n        // 1. IV μ¶”μ¶\n        byte[] iv = new byte[GCM_IV_LENGTH];\n        System.arraycopy(combined, 0, iv, 0, iv.length);\n        \n        // 2. μ•”νΈλ¬Έ μ¶”μ¶\n        byte[] cipherText = new byte[combined.length - iv.length];\n        System.arraycopy(combined, iv.length, cipherText, 0, cipherText.length);\n        \n        // 3. λ³µνΈν™”\n        Cipher cipher = Cipher.getInstance(ALGORITHM);\n        GCMParameterSpec parameterSpec = new GCMParameterSpec(GCM_TAG_LENGTH, iv);\n        cipher.init(Cipher.DECRYPT_MODE, key, parameterSpec);\n        \n        return new String(cipher.doFinal(cipherText), \"UTF-8\");\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β μλ»λ μ‚¬μ©λ²• - μ λ€ μ΄λ ‡κ² ν•μ§€ λ§μ„Έμ”!\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class InsecureAES {\n    \n    // β ECB λ¨λ“ μ‚¬μ© - ν¨ν„΄μ΄ κ·Έλ€λ΅ λ…Έμ¶λ¨\n    public byte[] encryptECB(String plainText, SecretKey key) throws Exception {\n        Cipher cipher = Cipher.getInstance(\"AES/ECB/PKCS5Padding\"); // μ„ν—!\n        cipher.init(Cipher.ENCRYPT_MODE, key);\n        return cipher.doFinal(plainText.getBytes());\n    }\n    \n    // β κ³ μ • IV μ‚¬μ© - κ°™μ€ ν‰λ¬Έμ€ κ°™μ€ μ•”νΈλ¬Έ\n    private static final byte[] FIXED_IV = \"1234567890123456\".getBytes(); // μ„ν—!\n    \n    // β ν•λ“μ½”λ”©λ ν‚¤\n    private static final String HARDCODED_KEY = \"MySecretKey12345\"; // μ„ν—!\n}"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π­ Spring Boot μ‹¤λ¬΄ κµ¬ν„",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Spring Boot 3.x μ•”νΈν™” μ„λΉ„μ¤ κµ¬ν„\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Service;\nimport javax.crypto.SecretKey;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.util.Base64;\n\n@Service\npublic class EncryptionService {\n    \n    private final SecretKey secretKey;\n    private final AESEncryptionService aesService;\n    \n    // application.ymlμ—μ„ ν‚¤ μ£Όμ…\n    public EncryptionService(\n            @Value(\"${encryption.secret-key}\") String base64Key) {\n        byte[] keyBytes = Base64.getDecoder().decode(base64Key);\n        this.secretKey = new SecretKeySpec(keyBytes, \"AES\");\n        this.aesService = new AESEncryptionService();\n    }\n    \n    public String encryptSensitiveData(String data) {\n        try {\n            return aesService.encrypt(data, secretKey);\n        } catch (Exception e) {\n            throw new EncryptionException(\"μ•”νΈν™” μ‹¤ν¨\", e);\n        }\n    }\n    \n    public String decryptSensitiveData(String encryptedData) {\n        try {\n            return aesService.decrypt(encryptedData, secretKey);\n        } catch (Exception e) {\n            throw new EncryptionException(\"λ³µνΈν™” μ‹¤ν¨\", e);\n        }\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// application.yml - ν‚¤ κ΄€λ¦¬ (ν™κ²½λ³€μ μ‚¬μ©)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// encryption:\n//   secret-key: ${AES_SECRET_KEY}  # ν™κ²½λ³€μμ—μ„ μ£Όμ…\n//\n// ν‚¤ μƒμ„± λ…λ Ήμ–΄:\n// openssl rand -base64 32  # 256λΉ„νΈ ν‚¤ μƒμ„±\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// JPA Entityμ—μ„ μλ™ μ•”νΈν™”/λ³µνΈν™”\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport jakarta.persistence.*;\n\n@Entity\n@Table(name = \"users\")\npublic class User {\n    \n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    private String name;\n    \n    @Convert(converter = EncryptedStringConverter.class)\n    @Column(name = \"resident_number\")\n    private String residentNumber;  // μ£Όλ―Όλ²νΈ - μλ™ μ•”νΈν™”\n    \n    @Convert(converter = EncryptedStringConverter.class)\n    @Column(name = \"card_number\")\n    private String cardNumber;  // μΉ΄λ“λ²νΈ - μλ™ μ•”νΈν™”\n}\n\n// AttributeConverterλ΅ μλ™ μ•”νΈν™”\n@Converter\n@Component\npublic class EncryptedStringConverter implements AttributeConverter<String, String> {\n    \n    private static EncryptionService encryptionService;\n    \n    @Autowired\n    public void setEncryptionService(EncryptionService service) {\n        EncryptedStringConverter.encryptionService = service;\n    }\n    \n    @Override\n    public String convertToDatabaseColumn(String attribute) {\n        if (attribute == null) return null;\n        return encryptionService.encryptSensitiveData(attribute);\n    }\n    \n    @Override\n    public String convertToEntityAttribute(String dbData) {\n        if (dbData == null) return null;\n        return encryptionService.decryptSensitiveData(dbData);\n    }\n}"
            },
            {
                "type": "tip",
                "title": "π’΅ λ€μΉ­ν‚¤ μ•”νΈν™” ν•µμ‹¬ μ •λ¦¬",
                "content": "**μ•κ³ λ¦¬μ¦ λΉ„κµν‘:**\n\n| μ•κ³ λ¦¬μ¦ | ν‚¤ κΈΈμ΄ | λΈ”λ΅ ν¬κΈ° | μƒνƒ | μ©λ„ |\n|----------|---------|-----------|------|------|\n| DES | 56λΉ„νΈ | 64λΉ„νΈ | β νκΈ° | μ‚¬μ© κΈμ§€ |\n| 3DES | 168λΉ„νΈ | 64λΉ„νΈ | β οΈ λΉ„κ¶μ¥ | λ κ±°μ‹ νΈν™ |\n| AES-128 | 128λΉ„νΈ | 128λΉ„νΈ | β… μ•μ „ | μΌλ° μ©λ„ |\n| AES-256 | 256λΉ„νΈ | 128λΉ„νΈ | β… κ°€μ¥ μ•μ „ | λ―Όκ° λ°μ΄ν„° |\n\n**μ΄μ λ¨λ“ λΉ„κµ:**\n\n| λ¨λ“ | νΉμ§• | κ¶μ¥ |\n|------|------|------|\n| ECB | ν¨ν„΄ λ…Έμ¶, λ³‘λ ¬ μ²λ¦¬ | β μ‚¬μ© κΈμ§€ |\n| CBC | IV ν•„μ”, μ§λ ¬ μ²λ¦¬ | β οΈ κ°€λ¥ν•λ‚ GCM κ¶μ¥ |\n| GCM | μΈμ¦ νƒκ·Έ ν¬ν•¨, λ³‘λ ¬ μ²λ¦¬ | β… κ°•λ ¥ κ¶μ¥ |\n\n---\n\n**μ‹¤λ¬΄ μ²΄ν¬λ¦¬μ¤νΈ:**\n\n- [ ] AES-256-GCM μ‚¬μ©\n- [ ] IVλ” λ§¤λ² μƒλ΅μ΄ λλ¤ κ°’ μ‚¬μ©\n- [ ] ν‚¤λ” ν™κ²½λ³€μ λλ” Vaultμ—μ„ κ΄€λ¦¬\n- [ ] ν‚¤ ν•λ“μ½”λ”© μ λ€ κΈμ§€\n- [ ] ν‚¤ λ΅ν…μ΄μ… μ •μ±… μλ¦½\n\n---\n\n**λ©΄μ ‘ μ§λ¬Έ:**\n\n1. **Q: AESμ™€ DESμ μ°¨μ΄μ μ€?**\n   A: DESλ” 56λΉ„νΈ ν‚¤λ΅ ν„μ¬ μ·¨μ•½, AESλ” 128/192/256λΉ„νΈ ν‚¤ μ§€μ›μΌλ΅ μ•μ „\n\n2. **Q: ECB λ¨λ“κ°€ μ„ν—ν• μ΄μ λ”?**\n   A: κ°™μ€ ν‰λ¬Έ λΈ”λ΅μ΄ κ°™μ€ μ•”νΈλ¬Έ λΈ”λ΅μ„ μƒμ„±ν•μ—¬ ν¨ν„΄ λ…Έμ¶\n\n3. **Q: IV(μ΄κΈ°ν™” λ²΅ν„°)μ μ—­ν• μ€?**\n   A: κ°™μ€ ν‚¤λ΅ κ°™μ€ ν‰λ¬Έμ„ μ•”νΈν™”ν•΄λ„ λ‹¤λ¥Έ μ•”νΈλ¬Έ μƒμ„±\n\n---\n\n**λ” κ³µλ¶€ν•  μλ£:**\n\n- NIST SP 800-38D (GCM λ…μ„Έ)\n- Java Cryptography Architecture (JCA)\n- AWS KMS / HashiCorp Vault λ¬Έμ„"
            }
        ]
    }


def get_asymmetric_content():
    """λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” (RSA, ECC) content"""
    return {
        "id": "03_μ•”νΈν™”/asymmetric",
        "title": "λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” (RSA, ECC)",
        "category": "security",
        "subCategory": "03_μ•”νΈν™”",
        "language": "Java",
        "description": "λΉ„λ€μΉ­ν‚¤ μ•”νΈν™”μ μ›λ¦¬μ™€ RSA, ECC μ•κ³ λ¦¬μ¦μ„ ν•™μµν•κ³  ν‚¤ κµν™ λ° μ „μμ„λ…μ— ν™μ©ν•λ” λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "π”‘ λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” - λ‘ κ°μ μ—΄μ‡ κ°€ ν• μ",
                "content": "**ν• μ¤„ μ”μ•½:** κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν•κ³  κ°μΈν‚¤λ΅ λ³µνΈν™”ν•λ” λ°©μ‹ (λλ” κ·Έ λ°λ€)\n\n---\n\n**λΉ„μ : μ°μ²΄ν†µκ³Ό μ—΄μ‡ **\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚                    π” λΉ„λ€μΉ­ν‚¤ μ•”νΈν™”                     β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚   [Alice]                              [Bob]            β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚  π“­ Bobμ μ°μ²΄ν†µ (κ³µκ°ν‚¤)            β”‚             β”‚\nβ”‚      β”‚  λ„κµ¬λ‚ νΈμ§€λ¥Ό λ„£μ„ μ μμ           β”‚             β”‚\nβ”‚      β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚             β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚                           π”‘ Bobλ§ κ°€μ§„ μ—΄μ‡      β”‚\nβ”‚      β”‚                              (κ°μΈν‚¤)            β”‚\nβ”‚      β”‚                              Bobλ§ μ—΄ μ μμ    β”‚\nβ”‚                                                         β”‚\nβ”‚   π“„ ν‰λ¬Έ β”€β”€[Bob κ³µκ°ν‚¤]β”€β”€β–Ί π” β”€β”€[Bob κ°μΈν‚¤]β”€β”€β–Ί π“„ ν‰λ¬Έ β”‚\nβ”‚                                                         β”‚\nβ”‚   β… μ¥μ : ν‚¤ κµν™ λ¬Έμ  ν•΄κ²°!                            β”‚\nβ”‚   β οΈ λ‹¨μ : λ€μΉ­ν‚¤λ³΄λ‹¤ 1000λ°° λλ¦Ό                        β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**κ³µκ°ν‚¤ vs κ°μΈν‚¤ μ‚¬μ© λ©μ :**\n\n| μ©λ„ | μ•”νΈν™” ν‚¤ | λ³µνΈν™” ν‚¤ | μμ‹ |\n|------|-----------|-----------|------|\n| κΈ°λ°€μ„± (μ•”νΈν™”) | κ³µκ°ν‚¤ | κ°μΈν‚¤ | HTTPS ν‚¤ κµν™ |\n| μΈμ¦ (μ„λ…) | κ°μΈν‚¤ | κ³µκ°ν‚¤ | JWT μ„λ…, μ „μμ„λ… |\n\n---\n\n**μ‹¤μ  μ‚¬μ© μ‚¬λ΅€:**\n\n| μ‚¬μ©μ² | μ•κ³ λ¦¬μ¦ | μ©λ„ |\n|--------|----------|------|\n| HTTPS/TLS | RSA, ECDHE | ν‚¤ κµν™ |\n| JWT ν† ν° | RS256, ES256 | μ„λ… κ²€μ¦ |\n| SSH μ ‘μ† | RSA, Ed25519 | μΈμ¦ |\n| μ „μμ„λ… | RSA-PSS, ECDSA | λ¬Έμ„ μ„λ… |\n| λΈ”λ΅μ²΄μΈ | ECDSA (secp256k1) | νΈλμ­μ… μ„λ… |\n\n---\n\n**μ™ μ•μ•„μ•Ό ν•λ”κ°€?**\n\n1. **HTTPS λ™μ‘ μ›λ¦¬** - λΈλΌμ°μ €-μ„λ²„ κ°„ μ•μ „ν• ν†µμ‹ \n2. **JWT ν† ν° κ²€μ¦** - RS256μΌλ΅ μ„λ…λ ν† ν° κ²€μ¦\n3. **API μΈμ¦** - κ³µκ°ν‚¤ κΈ°λ° μΈμ¦ μ‹μ¤ν…\n4. **μ „μμ„λ…** - κ³„μ•½μ„, μΈμ¦μ„ λ“± λ²•μ  ν¨λ ¥"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π”„ RSA/ECC λ™μ‘ μ›λ¦¬μ™€ Java μ½”λ“",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” λ™μ‘ μ›λ¦¬\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n//\n// RSA μν•™μ  μ›λ¦¬ (κ°„λµν™”):\n// 1. λ‘ ν° μ†μ p, q μ„ νƒ\n// 2. n = p Γ— q (κ³µκ°)\n// 3. Ο†(n) = (p-1)(q-1) (λΉ„λ°€)\n// 4. e μ„ νƒ (κ³µκ°ν‚¤μ μΌλ¶€)\n// 5. d κ³„μ‚°: e Γ— d β‰΅ 1 (mod Ο†(n)) (κ°μΈν‚¤)\n//\n// μ•”νΈν™”: C = M^e mod n\n// λ³µνΈν™”: M = C^d mod n\n//\n// β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β”‚  HTTPS ν‚¤ κµν™ κ³Όμ • (RSA)                            β”‚\n// β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\n// β”‚  [λΈλΌμ°μ €]                      [μ„λ²„]               β”‚\n// β”‚      β”‚                              β”‚                β”‚\n// β”‚      β”‚β—„β”€β”€β”€ μ„λ²„ μΈμ¦μ„ (κ³µκ°ν‚¤) β”€β”€β”€β”€β”‚                β”‚\n// β”‚      β”‚                              β”‚                β”‚\n// β”‚      β”‚  μ„μ‹ λ€μΉ­ν‚¤ μƒμ„±             β”‚                β”‚\n// β”‚      β”‚  (Pre-Master Secret)         β”‚                β”‚\n// β”‚      β”‚                              β”‚                β”‚\n// β”‚      β”‚β”€β”€ κ³µκ°ν‚¤λ΅ μ•”νΈν™” β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚                β”‚\n// β”‚      β”‚                              β”‚  κ°μΈν‚¤λ΅ λ³µνΈν™”β”‚\n// β”‚      β”‚                              β”‚                β”‚\n// β”‚      β”‚β—„β”€β”€β”€β”€ λ€μΉ­ν‚¤λ΅ ν†µμ‹  β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚                β”‚\n// β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport java.security.*;\nimport java.security.spec.*;\nimport javax.crypto.Cipher;\nimport java.util.Base64;\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… RSA μ•”νΈν™” μ„λΉ„μ¤ (κ¶μ¥: 2048λΉ„νΈ μ΄μƒ)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class RSAEncryptionService {\n    \n    private static final String ALGORITHM = \"RSA\";\n    private static final String TRANSFORMATION = \"RSA/ECB/OAEPWithSHA-256AndMGF1Padding\";\n    private static final int KEY_SIZE = 2048;\n    \n    // ν‚¤ μ μƒμ„±\n    public KeyPair generateKeyPair() throws Exception {\n        KeyPairGenerator generator = KeyPairGenerator.getInstance(ALGORITHM);\n        generator.initialize(KEY_SIZE, new SecureRandom());\n        return generator.generateKeyPair();\n    }\n    \n    // κ³µκ°ν‚¤λ΅ μ•”νΈν™”\n    public String encrypt(String plainText, PublicKey publicKey) throws Exception {\n        Cipher cipher = Cipher.getInstance(TRANSFORMATION);\n        cipher.init(Cipher.ENCRYPT_MODE, publicKey);\n        byte[] encrypted = cipher.doFinal(plainText.getBytes(\"UTF-8\"));\n        return Base64.getEncoder().encodeToString(encrypted);\n    }\n    \n    // κ°μΈν‚¤λ΅ λ³µνΈν™”\n    public String decrypt(String encryptedText, PrivateKey privateKey) throws Exception {\n        Cipher cipher = Cipher.getInstance(TRANSFORMATION);\n        cipher.init(Cipher.DECRYPT_MODE, privateKey);\n        byte[] decrypted = cipher.doFinal(Base64.getDecoder().decode(encryptedText));\n        return new String(decrypted, \"UTF-8\");\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… ECC (νƒ€μ›κ³΅μ„ ) - λ” μ§§μ€ ν‚¤λ΅ λ™μΌν• λ³΄μ• μμ¤€\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class ECCService {\n    \n    // 256λΉ„νΈ ECC β‰ 3072λΉ„νΈ RSA λ³΄μ• μμ¤€\n    public KeyPair generateECKeyPair() throws Exception {\n        KeyPairGenerator generator = KeyPairGenerator.getInstance(\"EC\");\n        ECGenParameterSpec ecSpec = new ECGenParameterSpec(\"secp256r1\");\n        generator.initialize(ecSpec, new SecureRandom());\n        return generator.generateKeyPair();\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β μλ»λ μ‚¬μ©λ²•\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class InsecureRSA {\n    \n    // β 1024λΉ„νΈ ν‚¤ - μ·¨μ•½ν•¨\n    public KeyPair weakKeyPair() throws Exception {\n        KeyPairGenerator generator = KeyPairGenerator.getInstance(\"RSA\");\n        generator.initialize(1024);  // μ„ν—! μµμ† 2048λΉ„νΈ ν•„μ”\n        return generator.generateKeyPair();\n    }\n    \n    // β PKCS1 ν¨λ”© - Padding Oracle κ³µκ²©μ— μ·¨μ•½\n    public byte[] insecureEncrypt(String text, PublicKey key) throws Exception {\n        Cipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\"); // μ„ν—!\n        cipher.init(Cipher.ENCRYPT_MODE, key);\n        return cipher.doFinal(text.getBytes());\n    }\n}"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π­ Spring Boot JWT μ„λ… λ° ν‚¤ κ΄€λ¦¬",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Spring Boot 3.x - RSA κΈ°λ° JWT μ„λ…\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport io.jsonwebtoken.Jwts;\nimport io.jsonwebtoken.SignatureAlgorithm;\nimport org.springframework.stereotype.Service;\nimport java.security.*;\nimport java.security.spec.*;\nimport java.util.Base64;\nimport java.util.Date;\n\n@Service\npublic class JwtService {\n    \n    private final PrivateKey privateKey;\n    private final PublicKey publicKey;\n    \n    public JwtService(\n            @Value(\"${jwt.private-key}\") String privateKeyPem,\n            @Value(\"${jwt.public-key}\") String publicKeyPem) throws Exception {\n        this.privateKey = loadPrivateKey(privateKeyPem);\n        this.publicKey = loadPublicKey(publicKeyPem);\n    }\n    \n    // JWT ν† ν° μƒμ„± (κ°μΈν‚¤λ΅ μ„λ…)\n    public String generateToken(String userId, String role) {\n        return Jwts.builder()\n                .setSubject(userId)\n                .claim(\"role\", role)\n                .setIssuedAt(new Date())\n                .setExpiration(new Date(System.currentTimeMillis() + 3600000))\n                .signWith(privateKey, SignatureAlgorithm.RS256)\n                .compact();\n    }\n    \n    // JWT ν† ν° κ²€μ¦ (κ³µκ°ν‚¤λ΅ κ²€μ¦)\n    public Claims validateToken(String token) {\n        return Jwts.parserBuilder()\n                .setSigningKey(publicKey)\n                .build()\n                .parseClaimsJws(token)\n                .getBody();\n    }\n    \n    private PrivateKey loadPrivateKey(String pem) throws Exception {\n        String privateKeyPEM = pem\n                .replace(\"-----BEGIN PRIVATE KEY-----\", \"\")\n                .replace(\"-----END PRIVATE KEY-----\", \"\")\n                .replaceAll(\"\\\\s\", \"\");\n        byte[] encoded = Base64.getDecoder().decode(privateKeyPEM);\n        KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\n        return keyFactory.generatePrivate(new PKCS8EncodedKeySpec(encoded));\n    }\n    \n    private PublicKey loadPublicKey(String pem) throws Exception {\n        String publicKeyPEM = pem\n                .replace(\"-----BEGIN PUBLIC KEY-----\", \"\")\n                .replace(\"-----END PUBLIC KEY-----\", \"\")\n                .replaceAll(\"\\\\s\", \"\");\n        byte[] encoded = Base64.getDecoder().decode(publicKeyPEM);\n        KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\n        return keyFactory.generatePublic(new X509EncodedKeySpec(encoded));\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// ν‚¤ μ μƒμ„± λ…λ Ήμ–΄ (ν„°λ―Έλ„)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// # RSA 2048λΉ„νΈ κ°μΈν‚¤ μƒμ„±\n// openssl genrsa -out private.pem 2048\n//\n// # κ³µκ°ν‚¤ μ¶”μ¶\n// openssl rsa -in private.pem -pubout -out public.pem\n//\n// # PKCS8 ν•μ‹μΌλ΅ λ³€ν™ (Javaμ©)\n// openssl pkcs8 -topk8 -inform PEM -outform PEM -in private.pem -out private_pkcs8.pem -nocrypt\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// ν•μ΄λΈλ¦¬λ“ μ•”νΈν™” (μ‹¤λ¬΄ κ¶μ¥ ν¨ν„΄)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n@Service\npublic class HybridEncryptionService {\n    \n    private final RSAEncryptionService rsaService;\n    private final AESEncryptionService aesService;\n    \n    // RSAλ΅ λ€μΉ­ν‚¤ μ•”νΈν™”, AESλ΅ λ°μ΄ν„° μ•”νΈν™”\n    public EncryptedData encrypt(String data, PublicKey publicKey) throws Exception {\n        // 1. μ„μ‹ AES ν‚¤ μƒμ„±\n        KeyGenerator keyGen = KeyGenerator.getInstance(\"AES\");\n        keyGen.init(256);\n        SecretKey aesKey = keyGen.generateKey();\n        \n        // 2. AESλ΅ λ°μ΄ν„° μ•”νΈν™” (λΉ λ¦„)\n        String encryptedData = aesService.encrypt(data, aesKey);\n        \n        // 3. RSAλ΅ AES ν‚¤ μ•”νΈν™” (μ•μ „ν• ν‚¤ μ „λ‹¬)\n        String encryptedKey = rsaService.encrypt(\n            Base64.getEncoder().encodeToString(aesKey.getEncoded()), \n            publicKey\n        );\n        \n        return new EncryptedData(encryptedData, encryptedKey);\n    }\n}"
            },
            {
                "type": "tip",
                "title": "π’΅ λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” ν•µμ‹¬ μ •λ¦¬",
                "content": "**RSA vs ECC λΉ„κµ:**\n\n| ν•­λ© | RSA | ECC |\n|------|-----|-----|\n| λ³΄μ• μμ¤€ λ™μΌ | 2048λΉ„νΈ | 256λΉ„νΈ |\n| ν‚¤ ν¬κΈ° | ν¬λ‹¤ | μ‘λ‹¤ |\n| μ—°μ‚° μ†λ„ | λλ¦¬λ‹¤ | λΉ λ¥΄λ‹¤ |\n| λ¨λ°”μΌ μ ν•©μ„± | λ‚®μ | λ†’μ |\n| μ—­μ‚¬ | 1977λ…„ | 1985λ…„ |\n| μ‚¬μ©μ² | JWT, SSL | λΈ”λ΅μ²΄μΈ, μµμ‹  TLS |\n\n**JWT μ„λ… μ•κ³ λ¦¬μ¦:**\n\n| μ•κ³ λ¦¬μ¦ | ν‚¤ νƒ€μ… | κ¶μ¥ |\n|----------|---------|------|\n| HS256 | λ€μΉ­ν‚¤ | λ‚΄λ¶€ μ„λΉ„μ¤ |\n| RS256 | RSA 2048+ | κ³µκ° API |\n| ES256 | ECC P-256 | λ¨λ°”μΌ, μµμ‹  |\n\n---\n\n**μ‹¤λ¬΄ μ²΄ν¬λ¦¬μ¤νΈ:**\n\n- [ ] RSA μµμ† 2048λΉ„νΈ ν‚¤ μ‚¬μ©\n- [ ] OAEP ν¨λ”© μ‚¬μ© (PKCS1 μ‚¬μ© κΈμ§€)\n- [ ] κ°μΈν‚¤λ” μ λ€ λ…Έμ¶ κΈμ§€\n- [ ] κ°μΈν‚¤ νμΌ κ¶ν•: 600 (μ†μ μλ§ μ½κΈ°)\n- [ ] μ •κΈ°μ μΈ ν‚¤ λ΅ν…μ΄μ…\n\n---\n\n**λ©΄μ ‘ μ§λ¬Έ:**\n\n1. **Q: λ€μΉ­ν‚¤μ™€ λΉ„λ€μΉ­ν‚¤μ μ°¨μ΄μ μ€?**\n   A: λ€μΉ­ν‚¤λ” κ°™μ€ ν‚¤λ΅ μ•”/λ³µνΈν™”, λΉ„λ€μΉ­ν‚¤λ” κ³µκ°ν‚¤/κ°μΈν‚¤ μ μ‚¬μ©\n\n2. **Q: HTTPSμ—μ„ λ‘ λ‹¤ μ‚¬μ©ν•λ” μ΄μ λ”?**\n   A: λΉ„λ€μΉ­ν‚¤λ΅ μ•μ „ν•κ² λ€μΉ­ν‚¤ κµν™, λ€μΉ­ν‚¤λ΅ λΉ λ¥Έ λ°μ΄ν„° ν†µμ‹ \n\n3. **Q: RSA ν‚¤ κΈΈμ΄κ°€ μ¤‘μ”ν• μ΄μ λ”?**\n   A: ν‚¤κ°€ μ§§μΌλ©΄ μ†μΈμλ¶„ν•΄λ΅ κ°μΈν‚¤ λ„μ¶ κ°€λ¥\n\n---\n\n**λ” κ³µλ¶€ν•  μλ£:**\n\n- RFC 8017 (PKCS #1 v2.2)\n- SEC 2: Recommended Elliptic Curve Parameters\n- Let's Encrypt μΈμ¦μ„ λ°κΈ‰ κ³Όμ •"
            }
        ]
    }


def get_hash_content():
    """ν•΄μ‹ ν•¨μ (SHA, bcrypt, λΉ„λ°€λ²νΈ μ €μ¥) content"""
    return {
        "id": "03_μ•”νΈν™”/hash",
        "title": "ν•΄μ‹ ν•¨μ (SHA, bcrypt, λΉ„λ°€λ²νΈ μ €μ¥)",
        "category": "security",
        "subCategory": "03_μ•”νΈν™”",
        "language": "Java",
        "description": "ν•΄μ‹ ν•¨μμ μ›λ¦¬μ™€ SHA, bcrypt, Argon2 μ•κ³ λ¦¬μ¦μ„ ν•™μµν•κ³  μ•μ „ν• λΉ„λ°€λ²νΈ μ €μ¥ λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "π”’ ν•΄μ‹ ν•¨μ - λλλ¦΄ μ μ—†λ” μ§€λ¬Έ",
                "content": "**ν• μ¤„ μ”μ•½:** μ…λ ¥ λ°μ΄ν„°λ¥Ό κ³ μ • κΈΈμ΄μ κ³ μ ν• κ°’μΌλ΅ λ³€ν™ν•λ” λ‹¨λ°©ν–¥ ν•¨μ\n\n---\n\n**λΉ„μ : κ³ κΈ° λ¶„μ‡„κΈ°**\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚                    π”’ ν•΄μ‹ ν•¨μ                          β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚   π¥© μ†κ³ κΈ° β”€β”€β–Ί π”„ λ¶„μ‡„κΈ° β”€β”€β–Ί π” λ‹¤μ§„ κ³ κΈ°               β”‚\nβ”‚                                                         β”‚\nβ”‚   νΉμ§•:                                                  β”‚\nβ”‚   β€Ά λ‹¤μ§„ κ³ κΈ°λ΅ μ›λ μ†κ³ κΈ° λ¨μ–‘ λ³µμ› λ¶κ°€ (λ‹¨λ°©ν–¥)       β”‚\nβ”‚   β€Ά κ°™μ€ κ³ κΈ° β†’ ν•­μƒ κ°™μ€ κ²°κ³Ό (κ²°μ •μ )                  β”‚\nβ”‚   β€Ά μ΅°κΈλ§ λ‹¬λΌλ„ κ²°κ³Όκ°€ μ™„μ „ν λ‹¤λ¦„ (λμ‚¬νƒ ν¨κ³Ό)       β”‚\nβ”‚                                                         β”‚\nβ”‚   \"password\"    β”€β”€β–Ί \"5f4dcc3b5aa765d61d8327deb882cf99\"  β”‚\nβ”‚   \"password1\"   β”€β”€β–Ί \"7c6a180b36896a65c3a5f6d6b8f12d44\"  β”‚\nβ”‚   \"Password\"    β”€β”€β–Ί \"dc647eb65e6711e155375218212b3964\"  β”‚\nβ”‚                                                         β”‚\nβ”‚   ν• κΈ€μλ§ λ°”λ€μ–΄λ„ μ™„μ „ν λ‹¤λ¥Έ ν•΄μ‹!                   β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**ν•΄μ‹ vs μ•”νΈν™” μ°¨μ΄:**\n\n| κµ¬λ¶„ | ν•΄μ‹ | μ•”νΈν™” |\n|------|------|--------|\n| λ°©ν–¥ | λ‹¨λ°©ν–¥ (λ³µμ› λ¶κ°€) | μ–‘λ°©ν–¥ (λ³µμ› κ°€λ¥) |\n| ν‚¤ ν•„μ” | μ—†μ | μμ |\n| μ¶λ ¥ κΈΈμ΄ | κ³ μ • | κ°€λ³€ |\n| μ©λ„ | λ¬΄κ²°μ„± κ²€μ¦, λΉ„λ°€λ²νΈ | λ°μ΄ν„° κΈ°λ°€μ„± |\n\n---\n\n**μ‹¤μ  μ‚¬μ© μ‚¬λ΅€:**\n\n| μ‚¬μ©μ² | μ•κ³ λ¦¬μ¦ | μ©λ„ |\n|--------|----------|------|\n| λΉ„λ°€λ²νΈ μ €μ¥ | bcrypt, Argon2 | μ•μ „ν• λΉ„λ°€λ²νΈ ν•΄μ‹ |\n| νμΌ λ¬΄κ²°μ„± | SHA-256 | λ‹¤μ΄λ΅λ“ νμΌ κ²€μ¦ |\n| Git μ»¤λ°‹ | SHA-1 β†’ SHA-256 | μ»¤λ°‹ μ‹λ³„μ |\n| λΈ”λ΅μ²΄μΈ | SHA-256, Keccak | λΈ”λ΅ ν•΄μ‹ |\n| JWT μ„λ… | HMAC-SHA256 | ν† ν° λ¬΄κ²°μ„± |\n\n---\n\n**μ™ μ•μ•„μ•Ό ν•λ”κ°€?**\n\n1. **λΉ„λ°€λ²νΈ μ €μ¥ ν•„μ** - ν‰λ¬Έ μ €μ¥μ€ λ²”μ£„ μμ¤€\n2. **κ°μΈμ •λ³΄λ³΄νΈλ²•** - λΉ„λ°€λ²νΈ μΌλ°©ν–¥ μ•”νΈν™” μλ¬΄\n3. **λ°μ΄ν„° λ¬΄κ²°μ„±** - νμΌ/λ°μ΄ν„° λ³€μ΅° κ°μ§€\n4. **λ©΄μ ‘ ν•„μ μ§λ¬Έ** - \"λΉ„λ°€λ²νΈλ” μ–΄λ–»κ² μ €μ¥ν•λ‚μ”?\""
            },
            {
                "type": "code",
                "language": "java",
                "title": "π”„ ν•΄μ‹ ν•¨μ μ›λ¦¬μ™€ Java μ½”λ“",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// ν•΄μ‹ ν•¨μ νΉμ„± λ‹¤μ΄μ–΄κ·Έλ¨\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n//\n// 1. λ‹¨λ°©ν–¥μ„± (One-way)\n//    μ…λ ¥ β”€β”€β–Ί ν•΄μ‹ β”€β”€β–Ί μ¶λ ¥\n//           β— μ—­λ°©ν–¥ λ¶κ°€λ¥\n//\n// 2. κ²°μ •μ  (Deterministic)\n//    \"hello\" β”€β”€β–Ί ν•­μƒ \"2cf24dba...\"\n//\n// 3. λμ‚¬νƒ ν¨κ³Ό (Avalanche Effect)\n//    \"hello\"  β”€β”€β–Ί \"2cf24dba5fb0a30e26e83b2ac5b9e29e...\"\n//    \"hello1\" β”€β”€β–Ί \"91e9240f415223982edc345532630710...\"\n//                  μ™„μ „ν λ‹¤λ¥Έ κ°’!\n//\n// 4. μ¶©λ μ €ν•­μ„± (Collision Resistance)\n//    λ‹¤λ¥Έ μ…λ ¥ β†’ κ°™μ€ ν•΄μ‹ μ°ΎκΈ° μ–΄λ ¤μ›€\n//\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport java.security.MessageDigest;\nimport java.security.SecureRandom;\nimport java.util.Base64;\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β μ„ν—ν• λ°©λ²•: λ‹¨μ SHA-256 (λΉ„λ°€λ²νΈμ— μ‚¬μ© κΈμ§€!)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class InsecureHash {\n    \n    // β λ μΈλ³΄μ° ν…μ΄λΈ” κ³µκ²©μ— μ·¨μ•½\n    public String hashPassword(String password) throws Exception {\n        MessageDigest md = MessageDigest.getInstance(\"SHA-256\");\n        byte[] hash = md.digest(password.getBytes(\"UTF-8\"));\n        return Base64.getEncoder().encodeToString(hash);\n    }\n    \n    // β MD5 μ‚¬μ© - μ¶©λ λ°κ²¬λ¨, μ‚¬μ© κΈμ§€!\n    public String md5Hash(String input) throws Exception {\n        MessageDigest md = MessageDigest.getInstance(\"MD5\"); // μ„ν—!\n        byte[] hash = md.digest(input.getBytes(\"UTF-8\"));\n        return Base64.getEncoder().encodeToString(hash);\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… μ¬λ°”λ¥Έ λ°©λ²• 1: bcrypt (Spring Security κΈ°λ³Έ)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\n\npublic class SecurePasswordService {\n    \n    // strength: 4~31 (κΈ°λ³Έκ°’ 10, κ°’μ΄ ν΄μλ΅ λλ¦Ό)\n    private final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12);\n    \n    // λΉ„λ°€λ²νΈ ν•΄μ‹ (Salt μλ™ μƒμ„±)\n    public String hashPassword(String rawPassword) {\n        return encoder.encode(rawPassword);\n        // κ²°κ³Ό μ: $2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/X4.S6GbF...\n        //          ^^^^^ ^^ ^^^^^^^^^^^^^^^^^^^^^^ ^^^^^^^^^^^^^^^^^^^\n        //          μ•κ³ λ¦¬μ¦ κ°•λ„  Salt (22μ)        ν•΄μ‹κ°’ (31μ)\n    }\n    \n    // λΉ„λ°€λ²νΈ κ²€μ¦\n    public boolean verifyPassword(String rawPassword, String hashedPassword) {\n        return encoder.matches(rawPassword, hashedPassword);\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… μ¬λ°”λ¥Έ λ°©λ²• 2: Argon2 (μµμ‹  κ¶μ¥)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\nimport org.springframework.security.crypto.argon2.Argon2PasswordEncoder;\n\npublic class Argon2PasswordService {\n    \n    // Argon2id: λ©”λ¨λ¦¬-ν•λ“ ν•΄μ‹ (GPU κ³µκ²© λ°©μ–΄)\n    private final Argon2PasswordEncoder encoder = new Argon2PasswordEncoder(\n        16,     // saltLength\n        32,     // hashLength  \n        1,      // parallelism\n        65536,  // memory (64MB)\n        3       // iterations\n    );\n    \n    public String hashPassword(String rawPassword) {\n        return encoder.encode(rawPassword);\n    }\n    \n    public boolean verifyPassword(String rawPassword, String hashedPassword) {\n        return encoder.matches(rawPassword, hashedPassword);\n    }\n}"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π­ Spring Boot λΉ„λ°€λ²νΈ λ³΄μ• κµ¬ν„",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Spring Boot 3.x λΉ„λ°€λ²νΈ λ³΄μ• μ„¤μ •\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\n@Configuration\npublic class SecurityConfig {\n    \n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        // μ΄μ ν™κ²½: strength 12 κ¶μ¥ (μ•½ 300ms μ†μ”)\n        return new BCryptPasswordEncoder(12);\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// νμ›κ°€μ… μ„λΉ„μ¤\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n@Service\n@RequiredArgsConstructor\npublic class UserService {\n    \n    private final UserRepository userRepository;\n    private final PasswordEncoder passwordEncoder;\n    \n    @Transactional\n    public User register(RegisterRequest request) {\n        // 1. μ΄λ©”μΌ μ¤‘λ³µ μ²΄ν¬\n        if (userRepository.existsByEmail(request.getEmail())) {\n            throw new DuplicateEmailException(\"μ΄λ―Έ μ‚¬μ© μ¤‘μΈ μ΄λ©”μΌμ…λ‹λ‹¤\");\n        }\n        \n        // 2. λΉ„λ°€λ²νΈ κ°•λ„ κ²€μ¦\n        validatePasswordStrength(request.getPassword());\n        \n        // 3. λΉ„λ°€λ²νΈ ν•΄μ‹ ν›„ μ €μ¥\n        User user = User.builder()\n                .email(request.getEmail())\n                .password(passwordEncoder.encode(request.getPassword())) // ν•΄μ‹!\n                .name(request.getName())\n                .build();\n        \n        return userRepository.save(user);\n    }\n    \n    public User login(LoginRequest request) {\n        User user = userRepository.findByEmail(request.getEmail())\n                .orElseThrow(() -> new AuthException(\"μ΄λ©”μΌ λλ” λΉ„λ°€λ²νΈκ°€ μλ»λμ—μµλ‹λ‹¤\"));\n        \n        // ν•΄μ‹λ λΉ„λ°€λ²νΈμ™€ λΉ„κµ\n        if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {\n            throw new AuthException(\"μ΄λ©”μΌ λλ” λΉ„λ°€λ²νΈκ°€ μλ»λμ—μµλ‹λ‹¤\");\n        }\n        \n        return user;\n    }\n    \n    private void validatePasswordStrength(String password) {\n        if (password.length() < 8) {\n            throw new WeakPasswordException(\"λΉ„λ°€λ²νΈλ” 8μ μ΄μƒμ΄μ–΄μ•Ό ν•©λ‹λ‹¤\");\n        }\n        if (!password.matches(\".*[A-Z].*\")) {\n            throw new WeakPasswordException(\"λ€λ¬Έμλ¥Ό ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤\");\n        }\n        if (!password.matches(\".*[0-9].*\")) {\n            throw new WeakPasswordException(\"μ«μλ¥Ό ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤\");\n        }\n        if (!password.matches(\".*[!@#$%^&*].*\")) {\n            throw new WeakPasswordException(\"νΉμλ¬Έμλ¥Ό ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤\");\n        }\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// SHA-256 ν™μ©: νμΌ λ¬΄κ²°μ„± κ²€μ¦\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport java.io.*;\nimport java.security.MessageDigest;\n\n@Service\npublic class FileIntegrityService {\n    \n    public String calculateFileHash(InputStream inputStream) throws Exception {\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        byte[] buffer = new byte[8192];\n        int bytesRead;\n        \n        while ((bytesRead = inputStream.read(buffer)) != -1) {\n            digest.update(buffer, 0, bytesRead);\n        }\n        \n        byte[] hashBytes = digest.digest();\n        StringBuilder hexString = new StringBuilder();\n        for (byte b : hashBytes) {\n            hexString.append(String.format(\"%02x\", b));\n        }\n        return hexString.toString();\n    }\n    \n    public boolean verifyFileIntegrity(InputStream file, String expectedHash) throws Exception {\n        String actualHash = calculateFileHash(file);\n        return actualHash.equalsIgnoreCase(expectedHash);\n    }\n}"
            },
            {
                "type": "tip",
                "title": "π’΅ ν•΄μ‹ ν•¨μ ν•µμ‹¬ μ •λ¦¬",
                "content": "**ν•΄μ‹ μ•κ³ λ¦¬μ¦ λΉ„κµ:**\n\n| μ•κ³ λ¦¬μ¦ | μ¶λ ¥ κΈΈμ΄ | μƒνƒ | μ©λ„ |\n|----------|-----------|------|------|\n| MD5 | 128λΉ„νΈ | β μ¶©λ λ°κ²¬ | μ‚¬μ© κΈμ§€ |\n| SHA-1 | 160λΉ„νΈ | β μ¶©λ λ°κ²¬ | λ κ±°μ‹ νΈν™λ§ |\n| SHA-256 | 256λΉ„νΈ | β… μ•μ „ | νμΌ λ¬΄κ²°μ„±, μΌλ° ν•΄μ‹ |\n| SHA-3 | 256λΉ„νΈ+ | β… μµμ‹  | λ†’μ€ λ³΄μ• μ”κµ¬ |\n\n**λΉ„λ°€λ²νΈ ν•΄μ‹ μ•κ³ λ¦¬μ¦:**\n\n| μ•κ³ λ¦¬μ¦ | νΉμ§• | κ¶μ¥λ„ |\n|----------|------|--------|\n| bcrypt | λλ¦° ν•΄μ‹, Salt λ‚΄μ¥ | β… κ¶μ¥ |\n| Argon2id | λ©”λ¨λ¦¬-ν•λ“, μµμ‹  ν‘μ¤€ | β… κ°•λ ¥ κ¶μ¥ |\n| PBKDF2 | λ°λ³µ ν•΄μ‹, NIST κ¶μ¥ | β… κ°€λ¥ |\n| scrypt | λ©”λ¨λ¦¬-ν•λ“ | β… κ°€λ¥ |\n| SHA-256 λ‹¨λ… | λΉ λ¦„ β†’ λ¬΄μ°¨λ³„ λ€μ…μ— μ·¨μ•½ | β κΈμ§€ |\n\n---\n\n**μ‹¤λ¬΄ μ²΄ν¬λ¦¬μ¤νΈ:**\n\n- [ ] λΉ„λ°€λ²νΈλ” λ°λ“μ‹ bcrypt λλ” Argon2 μ‚¬μ©\n- [ ] bcrypt strength μµμ† 10 μ΄μƒ (κ¶μ¥ 12)\n- [ ] ν‰λ¬Έ λΉ„λ°€λ²νΈ λ΅κ·Έ μ¶λ ¥ κΈμ§€\n- [ ] λΉ„λ°€λ²νΈ λ³µμ΅λ„ μ •μ±… μ μ©\n- [ ] λΉ„λ°€λ²νΈ μ¬μ„¤μ • μ‹ κΈ°μ΅΄ ν•΄μ‹ λΉ„κµ κΈμ§€\n\n---\n\n**λ©΄μ ‘ μ§λ¬Έ:**\n\n1. **Q: μ™ SHA-256 λ€μ‹  bcryptλ¥Ό μ“°λ‚μ”?**\n   A: SHA-256μ€ λΉ λ¥Έ ν•΄μ‹λΌ λ¬΄μ°¨λ³„ λ€μ… κ³µκ²©μ— μ·¨μ•½. bcryptλ” μλ„μ μΌλ΅ λλ¦¬κ² μ„¤κ³„λ¨\n\n2. **Q: Saltμ μ—­ν• μ€ λ¬΄μ—‡μΈκ°€μ”?**\n   A: κ°™μ€ λΉ„λ°€λ²νΈλ„ λ‹¤λ¥Έ ν•΄μ‹κ°’ μƒμ„± β†’ λ μΈλ³΄μ° ν…μ΄λΈ” κ³µκ²© λ°©μ§€\n\n3. **Q: ν•΄μ‹μ™€ μ•”νΈν™”μ μ°¨μ΄μ μ€?**\n   A: ν•΄μ‹λ” λ‹¨λ°©ν–¥(λ³µμ› λ¶κ°€), μ•”νΈν™”λ” μ–‘λ°©ν–¥(ν‚¤λ΅ λ³µμ› κ°€λ¥)\n\n4. **Q: bcryptμ $2a$12$...μ—μ„ 12λ” λ¬΄μ—‡μΈκ°€μ”?**\n   A: work factor(cost). 2^12 = 4096λ² λ°λ³µ. μ«μκ°€ ν΄μλ΅ λλ¦Ό\n\n---\n\n**λ” κ³µλ¶€ν•  μλ£:**\n\n- OWASP Password Storage Cheat Sheet\n- Password Hashing Competition (Argon2 μ„ μ •)\n- RFC 2898 (PBKDF2 λ…μ„Έ)"
            }
        ]
    }


def get_https_tls_content():
    """HTTPS/TLS λ™μ‘ μ›λ¦¬ content"""
    return {
        "id": "03_μ•”νΈν™”/https-tls",
        "title": "HTTPS/TLS λ™μ‘ μ›λ¦¬",
        "category": "security",
        "subCategory": "03_μ•”νΈν™”",
        "language": "Java",
        "description": "HTTPSμ™€ TLS ν”„λ΅ν† μ½μ λ™μ‘ μ›λ¦¬λ¥Ό ν•™μµν•κ³  Spring Bootμ—μ„ μ•μ „ν• ν†µμ‹ μ„ κµ¬ν„ν•λ” λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "π”’ HTTPS/TLS - μΈν„°λ„·μ λ³΄μ• ν„°λ„",
                "content": "**ν• μ¤„ μ”μ•½:** λΈλΌμ°μ €μ™€ μ„λ²„ κ°„μ λ¨λ“  ν†µμ‹ μ„ μ•”νΈν™”ν•λ” λ³΄μ• ν”„λ΅ν† μ½\n\n---\n\n**λΉ„μ : ν¬λ…ν• λ΄‰ν¬ vs λ°€λ΄‰λ κΈκ³ **\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚                HTTP vs HTTPS                             β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚   HTTP (ν¬λ…ν• λ΄‰ν¬):                                    β”‚\nβ”‚   [λΈλΌμ°μ €] β”€β”€π“¨β”€β”€β–Ί [ν•΄μ»¤ π‘€] β”€β”€π“¨β”€β”€β–Ί [μ„λ²„]             β”‚\nβ”‚             \"password=1234\"                             β”‚\nβ”‚              λ„κµ¬λ‚ λ³Ό μ μμ!                          β”‚\nβ”‚                                                         β”‚\nβ”‚   HTTPS (λ°€λ΄‰λ κΈκ³ ):                                   β”‚\nβ”‚   [λΈλΌμ°μ €] β”€β”€π”’β”€β”€β–Ί [ν•΄μ»¤ π¤·] β”€β”€π”’β”€β”€β–Ί [μ„λ²„]             β”‚\nβ”‚             \"x7Ks9Lm2...\"                               β”‚\nβ”‚              ν•΄λ… λ¶κ°€λ¥!                                β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**TLS Handshake κ³Όμ •:**\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚              TLS 1.3 Handshake (κ°„λµν™”)                  β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚  [λΈλΌμ°μ €]                            [μ„λ²„]            β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚β”€β”€ 1. ClientHello β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚             β”‚\nβ”‚      β”‚   (μ§€μ› μ•”νΈν™” λ©λ΅, λλ¤κ°’)        β”‚             β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚β—„β”€β”€ 2. ServerHello β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚             β”‚\nβ”‚      β”‚   (μ„ νƒλ μ•”νΈν™”, μΈμ¦μ„, λλ¤κ°’)   β”‚             β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚   3. μΈμ¦μ„ κ²€μ¦ (CA ν™•μΈ)          β”‚             β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚β”€β”€ 4. Key Exchange β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚             β”‚\nβ”‚      β”‚   (Pre-Master Secret)              β”‚             β”‚\nβ”‚      β”‚                                    β”‚             β”‚\nβ”‚      β”‚β—„β”€β”€β”€β”€β”€β”€β”€ 5. μ•”νΈν™” ν†µμ‹  β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚             β”‚\nβ”‚      β”‚   (λ€μΉ­ν‚¤λ΅ λ°μ΄ν„° μ•”νΈν™”)          β”‚             β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**HTTPSκ°€ μ κ³µν•λ” 3κ°€μ§€ λ³΄μ•:**\n\n| λ³΄μ• μ”μ† | μ„¤λ… | λ°©μ–΄ λ€μƒ |\n|-----------|------|-----------||\n| κΈ°λ°€μ„± | λ°μ΄ν„° μ•”νΈν™” | λ„μ²­ (Eavesdropping) |\n| λ¬΄κ²°μ„± | λ°μ΄ν„° λ³€μ΅° κ°μ§€ | μ¤‘κ°„μ λ³€μ΅° (MITM) |\n| μΈμ¦ | μ„λ²„ μ‹ μ› ν™•μΈ | ν”Όμ‹± μ‚¬μ΄νΈ |\n\n---\n\n**μ™ μ•μ•„μ•Ό ν•λ”κ°€?**\n\n1. **ν•„μ λ³΄μ•** - κµ¬κΈ€ SEO, λΈλΌμ°μ € κ²½κ³ \n2. **κ°μΈμ •λ³΄λ³΄νΈλ²•** - μ•”νΈν™” ν†µμ‹  μλ¬΄\n3. **μΈμ¦μ„ κ΄€λ¦¬** - Let's Encrypt κ°±μ‹ , μ¤λ¥ λ€μ‘\n4. **μ„±λ¥ μµμ ν™”** - TLS 1.3, HTTP/2 μ—°κ³„"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π”„ TLS Handshake μƒμ„Έ κ³Όμ •",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// TLS 1.3 Handshake μƒμ„Έ λ‹¤μ΄μ–΄κ·Έλ¨\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n//\n// [Client]                                    [Server]\n//    β”‚                                           β”‚\n//    β”‚β”€β”€β”€β”€β”€β”€β”€ ClientHello β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚\n//    β”‚  - TLS λ²„μ „: 1.3                          β”‚\n//    β”‚  - μ§€μ› Cipher Suites:                    β”‚\n//    β”‚    TLS_AES_256_GCM_SHA384                 β”‚\n//    β”‚    TLS_CHACHA20_POLY1305_SHA256           β”‚\n//    β”‚  - μ§€μ› ν‚¤ κµν™: X25519, P-256            β”‚\n//    β”‚  - Client Random (32 bytes)              β”‚\n//    β”‚  - Key Share (μ„μ‹ κ³µκ°ν‚¤)                β”‚\n//    β”‚                                           β”‚\n//    β”‚β—„β”€β”€β”€β”€β”€β”€ ServerHello β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚\n//    β”‚  - μ„ νƒλ Cipher: TLS_AES_256_GCM_SHA384  β”‚\n//    β”‚  - Server Random (32 bytes)              β”‚\n//    β”‚  - Key Share (μ„λ²„ μ„μ‹ κ³µκ°ν‚¤)           β”‚\n//    β”‚                                           β”‚\n//    β”‚β—„β”€β”€β”€β”€β”€β”€ Certificate β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚\n//    β”‚  - μ„λ²„ μΈμ¦μ„ μ²΄μΈ                        β”‚\n//    β”‚                                           β”‚\n//    β”‚β—„β”€β”€β”€β”€β”€β”€ CertificateVerify β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚\n//    β”‚  - μ„λ… (κ°μΈν‚¤λ΅ Handshake λ©”μ‹μ§€ μ„λ…)   β”‚\n//    β”‚                                           β”‚\n//    β”‚β—„β”€β”€β”€β”€β”€β”€ Finished β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚\n//    β”‚                                           β”‚\n//    β”‚β”€β”€β”€β”€β”€β”€β”€ Finished β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ίβ”‚\n//    β”‚                                           β”‚\n//    β”‚β—„β•β•β•β•β•β•β• Application Data (μ•”νΈν™”) β•β•β•β•β•β•β•β–Ίβ”‚\n//    β”‚                                           β”‚\n//\n// ν‚¤ μ λ„ κ³Όμ •:\n// Pre-Master Secret = ECDH(Client Key Share, Server Key Share)\n// Master Secret = HKDF(Pre-Master Secret, Handshake Hash)\n// Traffic Keys = HKDF(Master Secret, \"traffic key\")\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Javaμ—μ„ HTTPS ν΄λΌμ΄μ–ΈνΈ κµ¬ν„\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport javax.net.ssl.*;\nimport java.security.cert.X509Certificate;\n\n// β… μ¬λ°”λ¥Έ HTTPS ν΄λΌμ΄μ–ΈνΈ μ„¤μ •\npublic class SecureHttpClient {\n    \n    public HttpClient createSecureClient() {\n        return HttpClient.newBuilder()\n                .version(HttpClient.Version.HTTP_2)  // HTTP/2 over TLS\n                .connectTimeout(Duration.ofSeconds(10))\n                .sslContext(SSLContext.getDefault()) // μ‹μ¤ν… κΈ°λ³Έ CA μ‚¬μ©\n                .build();\n    }\n    \n    public String fetchSecure(String url) throws Exception {\n        HttpClient client = createSecureClient();\n        HttpRequest request = HttpRequest.newBuilder()\n                .uri(URI.create(url))\n                .GET()\n                .build();\n        \n        HttpResponse<String> response = client.send(\n                request, HttpResponse.BodyHandlers.ofString());\n        \n        return response.body();\n    }\n}\n\n// β μ„ν—ν• μ„¤μ • - μΈμ¦μ„ κ²€μ¦ λΉ„ν™μ„±ν™” (μ λ€ κΈμ§€!)\npublic class InsecureHttpClient {\n    \n    // β λ¨λ“  μΈμ¦μ„λ¥Ό μ‹ λΆ° - MITM κ³µκ²©μ— μ·¨μ•½!\n    public SSLContext createInsecureContext() throws Exception {\n        TrustManager[] trustAll = new TrustManager[] {\n            new X509TrustManager() {\n                public X509Certificate[] getAcceptedIssuers() { return null; }\n                public void checkClientTrusted(X509Certificate[] c, String a) {}\n                public void checkServerTrusted(X509Certificate[] c, String a) {}\n            }\n        };\n        \n        SSLContext sslContext = SSLContext.getInstance(\"TLS\");\n        sslContext.init(null, trustAll, new SecureRandom());\n        return sslContext;  // μ„ν—!\n    }\n}"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π­ Spring Boot HTTPS μ„¤μ •",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Spring Boot 3.x HTTPS μ„¤μ •\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n// application.yml\n// server:\n//   port: 443\n//   ssl:\n//     enabled: true\n//     key-store: classpath:keystore.p12\n//     key-store-password: ${SSL_KEYSTORE_PASSWORD}\n//     key-store-type: PKCS12\n//     key-alias: myapp\n//     protocol: TLS\n//     enabled-protocols: TLSv1.3,TLSv1.2  # TLS 1.2 μ΄μƒλ§\n//     ciphers:\n//       - TLS_AES_256_GCM_SHA384\n//       - TLS_AES_128_GCM_SHA256\n//       - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// HTTP β†’ HTTPS λ¦¬λ‹¤μ΄λ ‰νΈ μ„¤μ •\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.web.SecurityFilterChain;\n\n@Configuration\npublic class HttpsSecurityConfig {\n    \n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            // HTTPS κ°•μ \n            .requiresChannel(channel -> channel\n                .anyRequest().requiresSecure()\n            )\n            // HSTS ν—¤λ” μ„¤μ •\n            .headers(headers -> headers\n                .httpStrictTransportSecurity(hsts -> hsts\n                    .maxAgeInSeconds(31536000)  // 1λ…„\n                    .includeSubDomains(true)\n                    .preload(true)\n                )\n            );\n        \n        return http.build();\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Let's Encrypt μΈμ¦μ„ μλ™ κ°±μ‹  (Certbot μ‚¬μ©)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// # μΈμ¦μ„ λ°κΈ‰\n// certbot certonly --standalone -d example.com\n//\n// # PEM β†’ PKCS12 λ³€ν™\n// openssl pkcs12 -export \\\n//   -in /etc/letsencrypt/live/example.com/fullchain.pem \\\n//   -inkey /etc/letsencrypt/live/example.com/privkey.pem \\\n//   -out keystore.p12 \\\n//   -name myapp \\\n//   -password pass:${SSL_KEYSTORE_PASSWORD}\n//\n// # μλ™ κ°±μ‹  crontab\n// 0 0 1 * * certbot renew --quiet && ./convert-to-p12.sh && systemctl restart myapp\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// RestTemplate HTTPS μ„¤μ • (μ™Έλ¶€ API νΈμ¶)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport org.springframework.boot.web.client.RestTemplateBuilder;\nimport org.springframework.web.client.RestTemplate;\n\n@Configuration\npublic class RestTemplateConfig {\n    \n    @Bean\n    public RestTemplate restTemplate(RestTemplateBuilder builder) {\n        return builder\n                .setConnectTimeout(Duration.ofSeconds(10))\n                .setReadTimeout(Duration.ofSeconds(30))\n                .build();\n        // κΈ°λ³Έμ μΌλ΅ μ‹μ¤ν… CA μ‹ λΆ° (μ¶”κ°€ μ„¤μ • λ¶ν•„μ”)\n    }\n    \n    // νΉμ • μΈμ¦μ„λ§ μ‹ λΆ° (Certificate Pinning)\n    @Bean\n    public RestTemplate pinnedRestTemplate() throws Exception {\n        SSLContext sslContext = SSLContextBuilder.create()\n                .loadTrustMaterial(\n                    new ClassPathResource(\"trusted-cert.pem\").getInputStream(),\n                    \"password\".toCharArray()\n                )\n                .build();\n        \n        HttpClient httpClient = HttpClients.custom()\n                .setSSLContext(sslContext)\n                .build();\n        \n        return new RestTemplateBuilder()\n                .requestFactory(() -> new HttpComponentsClientHttpRequestFactory(httpClient))\n                .build();\n    }\n}"
            },
            {
                "type": "tip",
                "title": "π’΅ HTTPS/TLS ν•µμ‹¬ μ •λ¦¬",
                "content": "**TLS λ²„μ „ λΉ„κµ:**\n\n| λ²„μ „ | μƒνƒ | Handshake RTT | μ£Όμ” νΉμ§• |\n|------|------|---------------|-----------||\n| SSL 3.0 | β νκΈ° | - | λ³΄μ• μ·¨μ•½ |\n| TLS 1.0 | β νκΈ° | 2 RTT | POODLE μ·¨μ•½ |\n| TLS 1.1 | β νκΈ° | 2 RTT | λΉ„κ¶μ¥ |\n| TLS 1.2 | β… ν—μ© | 2 RTT | ν„μ¬ ν‘μ¤€ |\n| TLS 1.3 | β… κ¶μ¥ | 1 RTT | λΉ λ¥΄κ³  μ•μ „ |\n\n**μ£Όμ” Cipher Suites (TLS 1.3):**\n\n| Cipher Suite | λ³΄μ• μμ¤€ |\n|--------------|-----------||\n| TLS_AES_256_GCM_SHA384 | β… κ°•λ ¥ |\n| TLS_AES_128_GCM_SHA256 | β… κ¶μ¥ |\n| TLS_CHACHA20_POLY1305_SHA256 | β… λ¨λ°”μΌ μµμ  |\n\n---\n\n**μ‹¤λ¬΄ μ²΄ν¬λ¦¬μ¤νΈ:**\n\n- [ ] TLS 1.2 μ΄μƒλ§ ν—μ© (1.0, 1.1 λΉ„ν™μ„±ν™”)\n- [ ] HSTS ν—¤λ” μ„¤μ • (1λ…„ μ΄μƒ)\n- [ ] HTTP β†’ HTTPS 301 λ¦¬λ‹¤μ΄λ ‰νΈ\n- [ ] μΈμ¦μ„ λ§λ£ 90μΌ μ „ κ°±μ‹ \n- [ ] μΈμ¦μ„ μ²΄μΈ μ™„μ „μ„± ν™•μΈ\n- [ ] SSL Labs A+ λ“±κΈ‰ λ©ν‘\n\n---\n\n**λ©΄μ ‘ μ§λ¬Έ:**\n\n1. **Q: HTTPSμ™€ HTTPμ μ°¨μ΄μ μ€?**\n   A: HTTPSλ” TLSλ΅ μ•”νΈν™”λ HTTP. κΈ°λ°€μ„±, λ¬΄κ²°μ„±, μΈμ¦ μ κ³µ\n\n2. **Q: TLS Handshake κ³Όμ •μ„ μ„¤λ…ν•μ„Έμ”.**\n   A: ClientHello β†’ ServerHello+μΈμ¦μ„ β†’ ν‚¤ κµν™ β†’ μ•”νΈν™” ν†µμ‹  μ‹μ‘\n\n3. **Q: λ€μΉ­ν‚¤μ™€ λΉ„λ€μΉ­ν‚¤κ°€ HTTPSμ—μ„ μ–΄λ–»κ² μ‚¬μ©λλ‚μ”?**\n   A: λΉ„λ€μΉ­ν‚¤λ΅ μ•μ „ν•κ² λ€μΉ­ν‚¤ κµν™, μ΄ν›„ λ€μΉ­ν‚¤λ΅ λΉ λ¥Έ ν†µμ‹ \n\n4. **Q: Certificate Pinningμ΄λ€?**\n   A: νΉμ • μΈμ¦μ„λ§ μ‹ λΆ°ν•μ—¬ CA ν•΄ν‚Ήμ΄λ‚ μ„μ΅° μΈμ¦μ„ λ°©μ–΄\n\n---\n\n**λ” κ³µλ¶€ν•  μλ£:**\n\n- SSL Labs SSL Test (https://ssllabs.com/ssltest)\n- Mozilla SSL Configuration Generator\n- RFC 8446 (TLS 1.3 λ…μ„Έ)\n- Let's Encrypt λ¬Έμ„"
            }
        ]
    }


def get_encryption_intro_content():
    """μ•”νΈν™” κ°μ” content"""
    return {
        "id": "04_μ•”νΈν™”/encryption-intro",
        "title": "μ•”νΈν™” κ°μ”",
        "category": "security",
        "subCategory": "04_μ•”νΈν™”",
        "language": "Java",
        "description": "μ•”νΈν™”μ κΈ°λ³Έ κ°λ…κ³Ό μΆ…λ¥, μ‹¤λ¬΄μ—μ„μ ν™μ© λ°©λ²•μ„ μΆ…ν•©μ μΌλ΅ ν•™μµν•©λ‹λ‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "π” μ•”νΈν™” κ°μ” - λ””μ§€ν„Έ μ„Έκ³„μ μλ¬Όμ‡ ",
                "content": "**ν• μ¤„ μ”μ•½:** λ°μ΄ν„°λ¥Ό μ½μ„ μ μ—†λ” ν•νƒλ΅ λ³€ν™ν•μ—¬ κΈ°λ°€μ„±μ„ λ³΄μ¥ν•λ” κΈ°μ \n\n---\n\n**λΉ„μ : λΉ„λ°€ μ–Έμ–΄μ™€ κΈκ³ **\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚                    π” μ•”νΈν™”μ μ„Έκ³„                       β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚   ν‰λ¬Έ (Plaintext)     β†’      μ•”νΈλ¬Έ (Ciphertext)        β”‚\nβ”‚   \"λΉ„λ°€λ²νΈ: 1234\"     β†’      \"x7Ks9Lm2Np3Q...\"         β”‚\nβ”‚                                                         β”‚\nβ”‚   π”‘ μ—΄μ‡  (Key) = λ³€ν™ κ·μΉ™                              β”‚\nβ”‚                                                         β”‚\nβ”‚   β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚\nβ”‚   β”‚  μ•”νΈν™” μ ν• λΉ„κµ                                β”‚   β”‚\nβ”‚   β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤   β”‚\nβ”‚   β”‚                                                 β”‚   β”‚\nβ”‚   β”‚  1. λ€μΉ­ν‚¤ π”‘ = π”‘                               β”‚   β”‚\nβ”‚   β”‚     κ°™μ€ μ—΄μ‡ λ΅ μ κ·Έκ³  μ—΄κΈ°                      β”‚   β”‚\nβ”‚   β”‚     μ: AES, DES                                β”‚   β”‚\nβ”‚   β”‚                                                 β”‚   β”‚\nβ”‚   β”‚  2. λΉ„λ€μΉ­ν‚¤ π”‘ β‰  π—οΈ                            β”‚   β”‚\nβ”‚   β”‚     λ‹¤λ¥Έ μ—΄μ‡ λ΅ μ κ·Έκ³  μ—΄κΈ°                      β”‚   β”‚\nβ”‚   β”‚     μ: RSA, ECC                                β”‚   β”‚\nβ”‚   β”‚                                                 β”‚   β”‚\nβ”‚   β”‚  3. ν•΄μ‹ π”’ (λ‹¨λ°©ν–¥)                             β”‚   β”‚\nβ”‚   β”‚     μ κ·ΈκΈ°λ§ κ°€λ¥, μ—΄ μ μ—†μ                    β”‚   β”‚\nβ”‚   β”‚     μ: SHA-256, bcrypt                         β”‚   β”‚\nβ”‚   β”‚                                                 β”‚   β”‚\nβ”‚   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**μ•”νΈν™”κ°€ ν•„μ”ν• μƒν™©:**\n\n| μƒν™© | μ•”νΈν™” μ ν• | μ•κ³ λ¦¬μ¦ |\n|------|-------------|----------|\n| λΉ„λ°€λ²νΈ μ €μ¥ | ν•΄μ‹ | bcrypt, Argon2 |\n| DB λ―Όκ° μ •λ³΄ | λ€μΉ­ν‚¤ | AES-256-GCM |\n| λ„¤νΈμ›ν¬ ν†µμ‹  | ν•μ΄λΈλ¦¬λ“ | RSA + AES |\n| νμΌ μ•”νΈν™” | λ€μΉ­ν‚¤ | AES-256 |\n| μ „μμ„λ… | λΉ„λ€μΉ­ν‚¤ | RSA-PSS, ECDSA |\n| API ν† ν° | ν•΄μ‹/μ„λ… | HMAC-SHA256, RS256 |\n\n---\n\n**μ™ μ•μ•„μ•Ό ν•λ”κ°€?**\n\n1. **λ²•μ  μλ¬΄** - κ°μΈμ •λ³΄λ³΄νΈλ²•, μ „μκΈμµκ±°λλ²•\n2. **λ°μ΄ν„° λ³΄νΈ** - ν•΄ν‚Ή μ‹μ—λ„ ν‰λ¬Έ λ…Έμ¶ λ°©μ§€\n3. **μ‹ λΆ° κµ¬μ¶•** - κ³ κ° λ°μ΄ν„° μ•μ „ λ³΄μ¥\n4. **λ©΄μ ‘ ν•„μ** - λ³΄μ• κ΄€λ ¨ μ§λ¬Έ λ‹¨κ³¨"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π”„ μ•”νΈν™” μ ν•λ³„ λ™μ‘ μ›λ¦¬",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// μ•”νΈν™” μ ν• λΉ„κµ λ‹¤μ΄μ–΄κ·Έλ¨\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n//\n// 1. λ€μΉ­ν‚¤ μ•”νΈν™” (Symmetric)\n// β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€\n//    ν‰λ¬Έ β”€β”€[Key]β”€β”€β–Ί μ•”νΈλ¬Έ β”€β”€[Key]β”€β”€β–Ί ν‰λ¬Έ\n//    \n//    μ¥μ : λΉ λ¦„ (1000λ°°)\n//    λ‹¨μ : ν‚¤ κµν™ λ¬Έμ \n//    μ©λ„: λ€μ©λ‰ λ°μ΄ν„° μ•”νΈν™”\n//\n// 2. λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” (Asymmetric)\n// β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€\n//    ν‰λ¬Έ β”€β”€[Public Key]β”€β”€β–Ί μ•”νΈλ¬Έ β”€β”€[Private Key]β”€β”€β–Ί ν‰λ¬Έ\n//    \n//    μ¥μ : ν‚¤ κµν™ μ•μ „\n//    λ‹¨μ : λλ¦Ό\n//    μ©λ„: ν‚¤ κµν™, μ „μμ„λ…\n//\n// 3. ν•΄μ‹ (Hash)\n// β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€\n//    μ…λ ¥ β”€β”€[Hash Function]β”€β”€β–Ί κ³ μ • κΈΈμ΄ μ¶λ ¥\n//    \n//    νΉμ§•: λ‹¨λ°©ν–¥, λ³µμ› λ¶κ°€\n//    μ©λ„: λΉ„λ°€λ²νΈ, λ¬΄κ²°μ„± κ²€μ¦\n//\n// 4. ν•μ΄λΈλ¦¬λ“ (Hybrid) - μ‹¤λ¬΄ ν‘μ¤€\n// β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€\n//    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n//    β”‚ 1. μ„μ‹ λ€μΉ­ν‚¤ μƒμ„±                      β”‚\n//    β”‚ 2. λ€μΉ­ν‚¤λ΅ λ°μ΄ν„° μ•”νΈν™” (λΉ λ¦„)          β”‚\n//    β”‚ 3. λΉ„λ€μΉ­ν‚¤λ΅ λ€μΉ­ν‚¤ μ•”νΈν™” (μ•μ „)        β”‚\n//    β”‚ 4. μ•”νΈν™”λ λ°μ΄ν„° + μ•”νΈν™”λ ν‚¤ μ „μ†΅     β”‚\n//    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n//\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport javax.crypto.*;\nimport java.security.*;\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// μ•”νΈν™” μ ν•λ³„ Java μμ \n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\npublic class EncryptionOverview {\n    \n    // 1. λ€μΉ­ν‚¤ (AES) - λΉ λ¥Έ λ°μ΄ν„° μ•”νΈν™”\n    public SecretKey generateAESKey() throws Exception {\n        KeyGenerator keyGen = KeyGenerator.getInstance(\"AES\");\n        keyGen.init(256);  // 256λΉ„νΈ ν‚¤\n        return keyGen.generateKey();\n    }\n    \n    // 2. λΉ„λ€μΉ­ν‚¤ (RSA) - ν‚¤ κµν™, μ„λ…\n    public KeyPair generateRSAKeyPair() throws Exception {\n        KeyPairGenerator keyGen = KeyPairGenerator.getInstance(\"RSA\");\n        keyGen.initialize(2048);  // μµμ† 2048λΉ„νΈ\n        return keyGen.generateKeyPair();\n    }\n    \n    // 3. ν•΄μ‹ (SHA-256) - λ¬΄κ²°μ„± κ²€μ¦\n    public byte[] hash(String input) throws Exception {\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        return digest.digest(input.getBytes(\"UTF-8\"));\n    }\n    \n    // 4. λΉ„λ°€λ²νΈ ν•΄μ‹ (bcrypt) - λΉ„λ°€λ²νΈ μ €μ¥\n    public String hashPassword(String password) {\n        BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12);\n        return encoder.encode(password);\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β μλ»λ μ•”νΈν™” vs β… μ¬λ°”λ¥Έ μ•”νΈν™”\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\npublic class EncryptionComparison {\n    \n    // β μλ»λ λ°©λ²• 1: Base64λ” μ•”νΈν™”κ°€ μ•„λ‹!\n    public String fakeEncrypt(String text) {\n        return Base64.getEncoder().encodeToString(text.getBytes());\n        // λ„κµ¬λ‚ λ””μ½”λ”© κ°€λ¥!\n    }\n    \n    // β μλ»λ λ°©λ²• 2: μμ²΄ μ•”νΈν™” μ•κ³ λ¦¬μ¦\n    public String homemadeEncrypt(String text) {\n        StringBuilder result = new StringBuilder();\n        for (char c : text.toCharArray()) {\n            result.append((char) (c + 3));  // Caesar cipher\n        }\n        return result.toString();\n        // μ¦‰μ‹ ν•΄λ…λ¨!\n    }\n    \n    // β… μ¬λ°”λ¥Έ λ°©λ²•: ν‘μ¤€ μ•”νΈν™” μ•κ³ λ¦¬μ¦ μ‚¬μ©\n    public String properEncrypt(String text, SecretKey key) throws Exception {\n        Cipher cipher = Cipher.getInstance(\"AES/GCM/NoPadding\");\n        cipher.init(Cipher.ENCRYPT_MODE, key);\n        byte[] encrypted = cipher.doFinal(text.getBytes(\"UTF-8\"));\n        return Base64.getEncoder().encodeToString(encrypted);\n    }\n}"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π­ Spring Boot ν†µν•© μ•”νΈν™” μ„λΉ„μ¤",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Spring Boot 3.x ν†µν•© μ•”νΈν™” μ„λΉ„μ¤\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport org.springframework.stereotype.Service;\nimport org.springframework.beans.factory.annotation.Value;\n\n@Service\npublic class CryptoService {\n    \n    private final SecretKey aesKey;\n    private final PasswordEncoder passwordEncoder;\n    \n    public CryptoService(\n            @Value(\"${crypto.aes-key}\") String base64Key) {\n        this.aesKey = new SecretKeySpec(\n            Base64.getDecoder().decode(base64Key), \"AES\");\n        this.passwordEncoder = new BCryptPasswordEncoder(12);\n    }\n    \n    // β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n    // μ©λ„λ³„ μ•”νΈν™” λ©”μ„λ“\n    // β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n    \n    /**\n     * λΉ„λ°€λ²νΈ μ €μ¥μ© - λ‹¨λ°©ν–¥ ν•΄μ‹\n     * DBμ— μ €μ¥, λ³µνΈν™” λ¶κ°€\n     */\n    public String hashPassword(String password) {\n        return passwordEncoder.encode(password);\n    }\n    \n    public boolean verifyPassword(String raw, String hashed) {\n        return passwordEncoder.matches(raw, hashed);\n    }\n    \n    /**\n     * λ―Όκ° λ°μ΄ν„° μ €μ¥μ© - μ–‘λ°©ν–¥ μ•”νΈν™”\n     * μ£Όλ―Όλ²νΈ, μΉ΄λ“λ²νΈ λ“± λ³µνΈν™” ν•„μ”ν• λ°μ΄ν„°\n     */\n    public String encryptPII(String plainText) {\n        try {\n            byte[] iv = new byte[12];\n            SecureRandom.getInstanceStrong().nextBytes(iv);\n            \n            Cipher cipher = Cipher.getInstance(\"AES/GCM/NoPadding\");\n            GCMParameterSpec spec = new GCMParameterSpec(128, iv);\n            cipher.init(Cipher.ENCRYPT_MODE, aesKey, spec);\n            \n            byte[] encrypted = cipher.doFinal(plainText.getBytes(\"UTF-8\"));\n            byte[] combined = new byte[iv.length + encrypted.length];\n            System.arraycopy(iv, 0, combined, 0, iv.length);\n            System.arraycopy(encrypted, 0, combined, iv.length, encrypted.length);\n            \n            return Base64.getEncoder().encodeToString(combined);\n        } catch (Exception e) {\n            throw new CryptoException(\"μ•”νΈν™” μ‹¤ν¨\", e);\n        }\n    }\n    \n    public String decryptPII(String encryptedText) {\n        try {\n            byte[] combined = Base64.getDecoder().decode(encryptedText);\n            byte[] iv = Arrays.copyOfRange(combined, 0, 12);\n            byte[] encrypted = Arrays.copyOfRange(combined, 12, combined.length);\n            \n            Cipher cipher = Cipher.getInstance(\"AES/GCM/NoPadding\");\n            GCMParameterSpec spec = new GCMParameterSpec(128, iv);\n            cipher.init(Cipher.DECRYPT_MODE, aesKey, spec);\n            \n            return new String(cipher.doFinal(encrypted), \"UTF-8\");\n        } catch (Exception e) {\n            throw new CryptoException(\"λ³µνΈν™” μ‹¤ν¨\", e);\n        }\n    }\n    \n    /**\n     * νμΌ λ¬΄κ²°μ„± κ²€μ¦μ© - ν•΄μ‹\n     */\n    public String hashFile(InputStream fileStream) throws Exception {\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        byte[] buffer = new byte[8192];\n        int read;\n        while ((read = fileStream.read(buffer)) != -1) {\n            digest.update(buffer, 0, read);\n        }\n        return bytesToHex(digest.digest());\n    }\n    \n    private String bytesToHex(byte[] bytes) {\n        StringBuilder sb = new StringBuilder();\n        for (byte b : bytes) {\n            sb.append(String.format(\"%02x\", b));\n        }\n        return sb.toString();\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Entityμ—μ„ μλ™ μ•”νΈν™” μ μ©\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n@Entity\npublic class Customer {\n    \n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    private String name;\n    \n    @Convert(converter = EncryptedConverter.class)\n    private String residentNumber;  // μ£Όλ―Όλ²νΈ - μλ™ μ•”νΈν™”\n    \n    @Convert(converter = EncryptedConverter.class)\n    private String cardNumber;  // μΉ΄λ“λ²νΈ - μλ™ μ•”νΈν™”\n    \n    private String passwordHash;  // λΉ„λ°€λ²νΈ - ν•΄μ‹ μ €μ¥\n}"
            },
            {
                "type": "tip",
                "title": "π’΅ μ•”νΈν™” κ°μ” ν•µμ‹¬ μ •λ¦¬",
                "content": "**μ•”νΈν™” μ ν• μ„ νƒ κ°€μ΄λ“:**\n\n| μƒν™© | μ„ νƒ | μ•κ³ λ¦¬μ¦ |\n|------|------|----------|\n| λΉ„λ°€λ²νΈ μ €μ¥ | ν•΄μ‹ | bcrypt, Argon2 |\n| μ£Όλ―Όλ²νΈ/μΉ΄λ“λ²νΈ | λ€μΉ­ν‚¤ | AES-256-GCM |\n| API ν‚¤ κµν™ | λΉ„λ€μΉ­ν‚¤ | RSA-2048, ECDH |\n| JWT μ„λ… | ν•΄μ‹(HMAC) / λΉ„λ€μΉ­ | HS256, RS256 |\n| νμΌ μ•”νΈν™” | λ€μΉ­ν‚¤ | AES-256 |\n| HTTPS ν†µμ‹  | ν•μ΄λΈλ¦¬λ“ | TLS (ECDHE + AES) |\n\n**μ λ€ ν•λ©΄ μ• λλ” κ²ƒ:**\n\n| κΈμ§€ μ‚¬ν•­ | μ΄μ  |\n|-----------|------|\n| Base64λ¥Ό μ•”νΈν™”λ΅ μ°©κ° | μΈμ½”λ”©μΌ λΏ, λ„κµ¬λ‚ λ³µμ› κ°€λ¥ |\n| μμ²΄ μ•”νΈν™” μ•κ³ λ¦¬μ¦ | μ „λ¬Έκ°€λ„ μ‹¤ν¨, λ°λ“μ‹ ν‘μ¤€ μ‚¬μ© |\n| MD5/SHA1 λ‹¨λ… μ‚¬μ© | μ¶©λ λ°κ²¬λ¨, λ μΈλ³΄μ° ν…μ΄λΈ” μ·¨μ•½ |\n| ν•λ“μ½”λ”©λ ν‚¤ | μ†μ¤ μ½”λ“ λ…Έμ¶ μ‹ λ¨λ“  λ°μ΄ν„° λ…Έμ¶ |\n| κ³ μ • IV μ‚¬μ© | ν¨ν„΄ λ¶„μ„ κ°€λ¥ |\n\n---\n\n**μ‹¤λ¬΄ μ²΄ν¬λ¦¬μ¤νΈ:**\n\n- [ ] λΉ„λ°€λ²νΈλ” bcrypt/Argon2λ΅ ν•΄μ‹\n- [ ] λ―Όκ° μ •λ³΄λ” AES-256-GCMμΌλ΅ μ•”νΈν™”\n- [ ] ν‚¤λ” ν™κ²½λ³€μ λλ” Vaultμ—μ„ κ΄€λ¦¬\n- [ ] TLS 1.2 μ΄μƒμΌλ΅ ν†µμ‹  μ•”νΈν™”\n- [ ] μ •κΈ°μ μΈ ν‚¤ λ΅ν…μ΄μ… μ •μ±… μλ¦½\n\n---\n\n**λ©΄μ ‘ μ§λ¬Έ:**\n\n1. **Q: μ•”νΈν™”μ™€ ν•΄μ‹μ μ°¨μ΄μ μ€?**\n   A: μ•”νΈν™”λ” μ–‘λ°©ν–¥(λ³µνΈν™” κ°€λ¥), ν•΄μ‹λ” λ‹¨λ°©ν–¥(λ³µνΈν™” λ¶κ°€)\n\n2. **Q: μ–΄λ–¤ μƒν™©μ—μ„ μ–΄λ–¤ μ•”νΈν™”λ¥Ό μ‚¬μ©ν•λ‚μ”?**\n   A: λΉ„λ°€λ²νΈβ†’ν•΄μ‹, λ―Όκ°μ •λ³΄β†’λ€μΉ­ν‚¤, ν‚¤κµν™β†’λΉ„λ€μΉ­ν‚¤\n\n3. **Q: AES-GCMμ GCMμ΄ λ­”κ°€μ”?**\n   A: Galois/Counter Mode. μ•”νΈν™” + μΈμ¦(λ¬΄κ²°μ„± κ²€μ¦) λ™μ‹ μ κ³µ\n\n---\n\n**λ” κ³µλ¶€ν•  μλ£:**\n\n- Cryptography I (Coursera - Stanford)\n- Applied Cryptography (Bruce Schneier)\n- OWASP Cryptographic Failures"
            }
        ]
    }


def get_digital_signature_content():
    """μ „μ μ„λ… content"""
    return {
        "id": "04_μ•”νΈν™”/digital-signature",
        "title": "μ „μ μ„λ… (Digital Signature)",
        "category": "security",
        "subCategory": "04_μ•”νΈν™”",
        "language": "Java",
        "description": "μ „μ μ„λ…μ μ›λ¦¬μ™€ RSA, ECDSA κΈ°λ° μ„λ…/κ²€μ¦ λ°©λ²•μ„ ν•™μµν•κ³  JWT, λ¬Έμ„ μ„λ…μ— ν™μ©ν•λ” λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.",
        "isPlaceholder": False,
        "sections": [
            {
                "type": "concept",
                "title": "βοΈ μ „μ μ„λ… - λ””μ§€ν„Έ μ„Έκ³„μ μΈκ° λ„μ¥",
                "content": "**ν• μ¤„ μ”μ•½:** κ°μΈν‚¤λ΅ μ„λ…ν•κ³  κ³µκ°ν‚¤λ΅ κ²€μ¦ν•μ—¬ μ‘μ„±μμ™€ λ‚΄μ©μ λ¬΄κ²°μ„±μ„ μ¦λ…ν•λ” κΈ°μ \n\n---\n\n**λΉ„μ : λ°€λ λ΄‰μΈκ³Ό μΈκ° λ„μ¥**\n\n```\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\nβ”‚                    βοΈ μ „μ μ„λ…                          β”‚\nβ”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤\nβ”‚                                                         β”‚\nβ”‚   [μ‘μ„±μ Alice]                                        β”‚\nβ”‚      β”‚                                                  β”‚\nβ”‚      β”‚  π“„ λ¬Έμ„ + π” κ°μΈν‚¤ μ„λ…                         β”‚\nβ”‚      β”‚   \"κ³„μ•½μ„ λ‚΄μ©...\"                               β”‚\nβ”‚      β”‚        β†“                                         β”‚\nβ”‚      β”‚   ν•΄μ‹ β†’ κ°μΈν‚¤ μ•”νΈν™” β†’ μ„λ…κ°’                   β”‚\nβ”‚      β”‚                                                  β”‚\nβ”‚      β–Ό                                                  β”‚\nβ”‚   [κ²€μ¦μ Bob]                                          β”‚\nβ”‚      β”‚                                                  β”‚\nβ”‚      β”‚  π“„ λ¬Έμ„ + β… κ³µκ°ν‚¤ κ²€μ¦                         β”‚\nβ”‚      β”‚   μ„λ…κ°’ β†’ κ³µκ°ν‚¤ λ³µνΈν™” β†’ ν•΄μ‹κ°’ λΉ„κµ            β”‚\nβ”‚      β”‚                                                  β”‚\nβ”‚   κ²€μ¦ κ²°κ³Ό:                                            β”‚\nβ”‚   β… ν•΄μ‹ μΌμΉ β†’ Aliceκ°€ μ‘μ„±, λ‚΄μ© λ³€μ΅° μ—†μ           β”‚\nβ”‚   β ν•΄μ‹ λ¶μΌμΉ β†’ μ„μ΅° λλ” λ³€μ΅°λ¨                      β”‚\nβ”‚                                                         β”‚\nβ””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n```\n\n---\n\n**μ „μ μ„λ…μ΄ λ³΄μ¥ν•λ” 3κ°€μ§€:**\n\n| λ³΄μ¥ ν•­λ© | μ„¤λ… | μμ‹ |\n|-----------|------|------|\n| μΈμ¦ (Authentication) | μ„λ…μ μ‹ μ› ν™•μΈ | \"μ΄ λ¬Έμ„λ” Aliceκ°€ μ‘μ„±\" |\n| λ¬΄κ²°μ„± (Integrity) | λ‚΄μ© λ³€μ΅° κ°μ§€ | \"μ„λ… ν›„ μμ •λμ§€ μ•μ\" |\n| λ¶€μΈ λ°©μ§€ (Non-repudiation) | μ„λ… μ‚¬μ‹¤ λ¶€μ • λ¶κ°€ | \"Aliceλ” μ„λ…μ„ λ¶€μΈν•  μ μ—†μ\" |\n\n---\n\n**μ‹¤μ  μ‚¬μ© μ‚¬λ΅€:**\n\n| μ‚¬μ©μ² | μ•κ³ λ¦¬μ¦ | μ©λ„ |\n|--------|----------|------|\n| JWT ν† ν° | RS256, ES256 | API μΈμ¦ |\n| SSL μΈμ¦μ„ | RSA-SHA256 | μ„λ²„ μ‹ μ› μ¦λ… |\n| μ „μκ³„μ•½ | RSA-PSS | λ²•μ  ν¨λ ¥ κ³„μ•½μ„ |\n| μ½”λ“ μ„λ… | RSA, ECDSA | μ†ν”„νΈμ›¨μ–΄ λ°°ν¬ |\n| λΈ”λ΅μ²΄μΈ | ECDSA (secp256k1) | νΈλμ­μ… μΉμΈ |\n| Git μ»¤λ°‹ | GPG (RSA) | μ»¤λ°‹ μ‘μ„±μ μ¦λ… |\n\n---\n\n**μ™ μ•μ•„μ•Ό ν•λ”κ°€?**\n\n1. **JWT ν† ν° κ²€μ¦** - RS256 μ„λ… ν† ν° λ°κΈ‰/κ²€μ¦\n2. **API λ³΄μ•** - μ”μ²­ μ„λ³€μ΅° λ°©μ§€\n3. **μ „μμƒκ±°λλ²•** - μ „μμ„λ… λ²•μ  ν¨λ ¥\n4. **μ½”λ“ λ³΄μ•** - λ°°ν¬ μ†ν”„νΈμ›¨μ–΄ λ¬΄κ²°μ„±"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π”„ μ „μ μ„λ… μ›λ¦¬μ™€ Java μ½”λ“",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// μ „μ μ„λ… λ™μ‘ μ›λ¦¬ λ‹¤μ΄μ–΄κ·Έλ¨\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n//\n// μ„λ… κ³Όμ • (Signing):\n// β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β”‚                                                         β”‚\n// β”‚   π“„ μ›λ³Έ λ¬Έμ„                                          β”‚\n// β”‚        β”‚                                                β”‚\n// β”‚        β–Ό                                                β”‚\n// β”‚   [SHA-256 ν•΄μ‹]                                        β”‚\n// β”‚        β”‚                                                β”‚\n// β”‚        β–Ό                                                β”‚\n// β”‚   ν•΄μ‹κ°’ (32 bytes)                                     β”‚\n// β”‚        β”‚                                                β”‚\n// β”‚        β–Ό                                                β”‚\n// β”‚   [κ°μΈν‚¤λ΅ μ•”νΈν™”] β—„β”€β”€β”€ π”‘ Private Key                 β”‚\n// β”‚        β”‚                                                β”‚\n// β”‚        β–Ό                                                β”‚\n// β”‚   βοΈ μ„λ…κ°’ (Signature)                                 β”‚\n// β”‚                                                         β”‚\n// β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n//\n// κ²€μ¦ κ³Όμ • (Verification):\n// β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β”‚                                                         β”‚\n// β”‚   π“„ μ›λ³Έ λ¬Έμ„        βοΈ μ„λ…κ°’                          β”‚\n// β”‚        β”‚                   β”‚                            β”‚\n// β”‚        β–Ό                   β–Ό                            β”‚\n// β”‚   [SHA-256 ν•΄μ‹]    [κ³µκ°ν‚¤λ΅ λ³µνΈν™”] β—„β”€ π—οΈ Public Key  β”‚\n// β”‚        β”‚                   β”‚                            β”‚\n// β”‚        β–Ό                   β–Ό                            β”‚\n// β”‚   ν•΄μ‹κ°’ A            ν•΄μ‹κ°’ B                           β”‚\n// β”‚        β”‚                   β”‚                            β”‚\n// β”‚        β””β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                            β”‚\n// β”‚                β–Ό                                        β”‚\n// β”‚         [A == B ?]                                      β”‚\n// β”‚         β… μ ν¨ / β λ¬΄ν¨                                β”‚\n// β”‚                                                         β”‚\n// β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport java.security.*;\nimport java.util.Base64;\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… RSA μ „μ μ„λ… κµ¬ν„\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class DigitalSignatureService {\n    \n    private static final String SIGNATURE_ALGORITHM = \"SHA256withRSA\";\n    \n    // ν‚¤ μ μƒμ„±\n    public KeyPair generateKeyPair() throws Exception {\n        KeyPairGenerator keyGen = KeyPairGenerator.getInstance(\"RSA\");\n        keyGen.initialize(2048, new SecureRandom());\n        return keyGen.generateKeyPair();\n    }\n    \n    // μ„λ… μƒμ„± (κ°μΈν‚¤ μ‚¬μ©)\n    public String sign(String data, PrivateKey privateKey) throws Exception {\n        Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM);\n        signature.initSign(privateKey);\n        signature.update(data.getBytes(\"UTF-8\"));\n        byte[] signatureBytes = signature.sign();\n        return Base64.getEncoder().encodeToString(signatureBytes);\n    }\n    \n    // μ„λ… κ²€μ¦ (κ³µκ°ν‚¤ μ‚¬μ©)\n    public boolean verify(String data, String signatureStr, PublicKey publicKey) throws Exception {\n        Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM);\n        signature.initVerify(publicKey);\n        signature.update(data.getBytes(\"UTF-8\"));\n        byte[] signatureBytes = Base64.getDecoder().decode(signatureStr);\n        return signature.verify(signatureBytes);\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// β… ECDSA μ „μ μ„λ… (λ” μ§§μ€ ν‚¤, λ” λΉ λ¥Έ μ„±λ¥)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\npublic class ECDSASignatureService {\n    \n    private static final String SIGNATURE_ALGORITHM = \"SHA256withECDSA\";\n    \n    // 256λΉ„νΈ ECC ν‚¤ β‰ 3072λΉ„νΈ RSA λ³΄μ• μμ¤€\n    public KeyPair generateKeyPair() throws Exception {\n        KeyPairGenerator keyGen = KeyPairGenerator.getInstance(\"EC\");\n        ECGenParameterSpec ecSpec = new ECGenParameterSpec(\"secp256r1\");\n        keyGen.initialize(ecSpec, new SecureRandom());\n        return keyGen.generateKeyPair();\n    }\n    \n    public String sign(String data, PrivateKey privateKey) throws Exception {\n        Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM);\n        signature.initSign(privateKey);\n        signature.update(data.getBytes(\"UTF-8\"));\n        return Base64.getEncoder().encodeToString(signature.sign());\n    }\n    \n    public boolean verify(String data, String signatureStr, PublicKey publicKey) throws Exception {\n        Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM);\n        signature.initVerify(publicKey);\n        signature.update(data.getBytes(\"UTF-8\"));\n        return signature.verify(Base64.getDecoder().decode(signatureStr));\n    }\n}"
            },
            {
                "type": "code",
                "language": "java",
                "title": "π­ Spring Boot JWT λ° API μ„λ…",
                "code": "// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// Spring Boot 3.x - RSA κΈ°λ° JWT μ„λ…\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\nimport io.jsonwebtoken.*;\nimport io.jsonwebtoken.security.Keys;\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class JwtSignatureService {\n    \n    private final PrivateKey privateKey;\n    private final PublicKey publicKey;\n    \n    public JwtSignatureService(\n            @Value(\"${jwt.private-key-path}\") String privateKeyPath,\n            @Value(\"${jwt.public-key-path}\") String publicKeyPath) throws Exception {\n        this.privateKey = loadPrivateKey(privateKeyPath);\n        this.publicKey = loadPublicKey(publicKeyPath);\n    }\n    \n    // JWT ν† ν° μƒμ„± (RS256 μ„λ…)\n    public String createToken(String userId, List<String> roles) {\n        return Jwts.builder()\n                .setSubject(userId)\n                .claim(\"roles\", roles)\n                .setIssuedAt(new Date())\n                .setExpiration(new Date(System.currentTimeMillis() + 3600000))\n                .signWith(privateKey, SignatureAlgorithm.RS256)  // κ°μΈν‚¤λ΅ μ„λ…\n                .compact();\n    }\n    \n    // JWT ν† ν° κ²€μ¦\n    public Claims verifyToken(String token) {\n        try {\n            return Jwts.parserBuilder()\n                    .setSigningKey(publicKey)  // κ³µκ°ν‚¤λ΅ κ²€μ¦\n                    .build()\n                    .parseClaimsJws(token)\n                    .getBody();\n        } catch (JwtException e) {\n            throw new InvalidTokenException(\"ν† ν° κ²€μ¦ μ‹¤ν¨: \" + e.getMessage());\n        }\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// API μ”μ²­ μ„λ… (Webhook, μ™Έλ¶€ μ—°λ™)\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n@Service\npublic class ApiSignatureService {\n    \n    private final DigitalSignatureService signatureService;\n    private final PrivateKey privateKey;\n    \n    // API μ”μ²­μ— μ„λ… μ¶”κ°€\n    public HttpHeaders createSignedHeaders(String requestBody) throws Exception {\n        String timestamp = String.valueOf(System.currentTimeMillis());\n        String dataToSign = timestamp + \"|\" + requestBody;\n        String signature = signatureService.sign(dataToSign, privateKey);\n        \n        HttpHeaders headers = new HttpHeaders();\n        headers.set(\"X-Timestamp\", timestamp);\n        headers.set(\"X-Signature\", signature);\n        return headers;\n    }\n}\n\n// API μ”μ²­ μ„λ… κ²€μ¦ ν•„ν„°\n@Component\npublic class SignatureVerificationFilter extends OncePerRequestFilter {\n    \n    private final DigitalSignatureService signatureService;\n    private final PublicKey partnerPublicKey;\n    \n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n            HttpServletResponse response, FilterChain chain) throws Exception {\n        \n        String timestamp = request.getHeader(\"X-Timestamp\");\n        String signature = request.getHeader(\"X-Signature\");\n        String body = readBody(request);\n        \n        // νƒ€μ„μ¤νƒ¬ν”„ κ²€μ¦ (5λ¶„ μ΄λ‚΄)\n        long requestTime = Long.parseLong(timestamp);\n        if (System.currentTimeMillis() - requestTime > 300000) {\n            response.sendError(401, \"μ”μ²­ λ§λ£\");\n            return;\n        }\n        \n        // μ„λ… κ²€μ¦\n        String dataToVerify = timestamp + \"|\" + body;\n        if (!signatureService.verify(dataToVerify, signature, partnerPublicKey)) {\n            response.sendError(401, \"μ„λ… κ²€μ¦ μ‹¤ν¨\");\n            return;\n        }\n        \n        chain.doFilter(request, response);\n    }\n}\n\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n// λ¬Έμ„ μ„λ… μ„λΉ„μ¤\n// β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n@Service\npublic class DocumentSigningService {\n    \n    private final DigitalSignatureService signatureService;\n    \n    public SignedDocument signDocument(byte[] documentBytes, PrivateKey signerKey, \n                                        String signerInfo) throws Exception {\n        // λ¬Έμ„ ν•΄μ‹\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        String documentHash = Base64.getEncoder().encodeToString(\n            digest.digest(documentBytes));\n        \n        // μ„λ… λ©”νƒ€λ°μ΄ν„°\n        String signatureData = String.format(\n            \"{\\\"hash\\\":\\\"%s\\\",\\\"signer\\\":\\\"%s\\\",\\\"timestamp\\\":\\\"%s\\\"}\",\n            documentHash, signerInfo, Instant.now().toString());\n        \n        // μ„λ…\n        String signature = signatureService.sign(signatureData, signerKey);\n        \n        return new SignedDocument(documentBytes, signatureData, signature);\n    }\n}"
            },
            {
                "type": "tip",
                "title": "π’΅ μ „μ μ„λ… ν•µμ‹¬ μ •λ¦¬",
                "content": "**μ„λ… μ•κ³ λ¦¬μ¦ λΉ„κµ:**\n\n| μ•κ³ λ¦¬μ¦ | ν‚¤ ν¬κΈ° | μ„λ… ν¬κΈ° | μ†λ„ | μ©λ„ |\n|----------|---------|-----------|------|------|\n| RSA-2048 | 2048λΉ„νΈ | 256λ°”μ΄νΈ | λ³΄ν†µ | JWT, μΈμ¦μ„ |\n| RSA-4096 | 4096λΉ„νΈ | 512λ°”μ΄νΈ | λλ¦Ό | λ†’μ€ λ³΄μ• |\n| ECDSA P-256 | 256λΉ„νΈ | 64λ°”μ΄νΈ | λΉ λ¦„ | λ¨λ°”μΌ, λΈ”λ΅μ²΄μΈ |\n| Ed25519 | 256λΉ„νΈ | 64λ°”μ΄νΈ | λ§¤μ° λΉ λ¦„ | SSH, μµμ‹  μ‹μ¤ν… |\n\n**JWT μ„λ… μ•κ³ λ¦¬μ¦:**\n\n| μ•κ³ λ¦¬μ¦ | ν‚¤ νƒ€μ… | κ¶μ¥ μƒν™© |\n|----------|---------|-----------||\n| HS256 | λ€μΉ­ν‚¤ | λ‚΄λ¶€ λ§μ΄ν¬λ΅μ„λΉ„μ¤ |\n| RS256 | RSA λΉ„λ€μΉ­ | κ³µκ° API, λ‹¤μ κ²€μ¦μ |\n| ES256 | ECDSA λΉ„λ€μΉ­ | λ¨λ°”μΌ, μ„±λ¥ μ¤‘μ” |\n\n---\n\n**μ‹¤λ¬΄ μ²΄ν¬λ¦¬μ¤νΈ:**\n\n- [ ] RSA μµμ† 2048λΉ„νΈ, ECDSA P-256 μ΄μƒ\n- [ ] μ„λ… μ‹ νƒ€μ„μ¤νƒ¬ν”„ ν¬ν•¨ (μ¬μ‚¬μ© κ³µκ²© λ°©μ§€)\n- [ ] κ°μΈν‚¤ μ•μ „ν• μ €μ¥ (HSM, Vault)\n- [ ] κ³µκ°ν‚¤ μ•μ „ν• λ°°ν¬ (μΈμ¦μ„ μ²΄μΈ)\n- [ ] ν‚¤ λ§λ£ λ° λ΅ν…μ΄μ… μ •μ±…\n\n---\n\n**λ©΄μ ‘ μ§λ¬Έ:**\n\n1. **Q: μ „μ μ„λ…κ³Ό μ•”νΈν™”μ μ°¨μ΄μ μ€?**\n   A: μ•”νΈν™”λ” κΈ°λ°€μ„±(λ‚΄μ© μ¨κΉ€), μ„λ…μ€ μΈμ¦κ³Ό λ¬΄κ²°μ„±(μ‘μ„±μμ™€ λ‚΄μ© κ²€μ¦)\n\n2. **Q: κ°μΈν‚¤λ΅ μ•”νΈν™”ν•λ©΄ λ„κµ¬λ‚ λ³µνΈν™”ν•  μ μλ”λ° μ™ μ„λ…μ— μ‚¬μ©ν•λ‚μ”?**\n   A: μ„λ…μ λ©μ μ€ κΈ°λ°€μ„±μ΄ μ•„λ‹ \"μ΄ κ°μΈν‚¤ μ†μ μκ°€ μ‘μ„±ν–μ\" μ¦λ…\n\n3. **Q: JWTμ—μ„ HS256κ³Ό RS256μ μ°¨μ΄μ μ€?**\n   A: HS256μ€ λ€μΉ­ν‚¤(λ°κΈ‰μ=κ²€μ¦μ), RS256μ€ λΉ„λ€μΉ­ν‚¤(λ°κΈ‰μ κ°μΈν‚¤, κ²€μ¦μ κ³µκ°ν‚¤)\n\n4. **Q: λ¶€μΈ λ°©μ§€(Non-repudiation)λ€?**\n   A: μ„λ…μκ°€ \"λ‚λ” μ„λ… μ• ν–λ‹¤\"κ³  λ¶€μ •ν•  μ μ—†μ. κ°μΈν‚¤λ” λ³ΈμΈλ§ μ†μ \n\n---\n\n**λ” κ³µλ¶€ν•  μλ£:**\n\n- RFC 7515 (JSON Web Signature)\n- μ „μμ„λ…λ²• (λ€ν•λ―Όκµ­)\n- FIDO2/WebAuthn ν‘μ¤€"
            }
        ]
    }


def main():
    json_path = r"c:\tools\codemaster-next-main\codemaster-next-main\codemaster-next-main\src\data\contents\security.json"

    # Read existing JSON
    with open(json_path, "r", encoding="utf-8") as f:
        data = json.load(f)

    # Update 03_μ•”νΈν™” section
    data["03_μ•”νΈν™”/symmetric"] = get_symmetric_content()
    data["03_μ•”νΈν™”/asymmetric"] = get_asymmetric_content()
    data["03_μ•”νΈν™”/hash"] = get_hash_content()
    data["03_μ•”νΈν™”/https-tls"] = get_https_tls_content()

    # Update 04_μ•”νΈν™” section
    data["04_μ•”νΈν™”/encryption-intro"] = get_encryption_intro_content()
    data["04_μ•”νΈν™”/digital-signature"] = get_digital_signature_content()

    # Write updated JSON
    with open(json_path, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print("Successfully updated security.json with encryption content!")
    print("\nUpdated topics:")
    print("- 03_μ•”νΈν™”/symmetric: λ€μΉ­ν‚¤ μ•”νΈν™” (AES, DES)")
    print("- 03_μ•”νΈν™”/asymmetric: λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” (RSA, ECC)")
    print("- 03_μ•”νΈν™”/hash: ν•΄μ‹ ν•¨μ (SHA, bcrypt, λΉ„λ°€λ²νΈ μ €μ¥)")
    print("- 03_μ•”νΈν™”/https-tls: HTTPS/TLS λ™μ‘ μ›λ¦¬")
    print("- 04_μ•”νΈν™”/encryption-intro: μ•”νΈν™” κ°μ”")
    print("- 04_μ•”νΈν™”/digital-signature: μ „μ μ„λ…")


if __name__ == "__main__":
    main()
